---
id: 793
title: WinHttp Proxy configuration on Windows 2003 x64
date: 2009-07-21T13:42:00-05:00
author: jsanders
layout: post
guid: http://jsandersblog.azurewebsites.net/2009/07/21/winhttp-proxy-configuration-on-windows-2003-x64/
permalink: /2009/07/21/winhttp-proxy-configuration-on-windows-2003-x64/
orig_url:
  - http://blogs.msdn.microsoft.com/b/jpsanders/archive/2009/07/21/winhttp-proxy-configuration-on-windows-2003-x64.aspx
  - http://blogs.msdn.microsoft.com/b/jpsanders/archive/2009/07/21/winhttp-proxy-configuration-on-windows-2003-x64.aspx
  - http://blogs.msdn.microsoft.com/b/jpsanders/archive/2009/07/21/winhttp-proxy-configuration-on-windows-2003-x64.aspx
  - http://blogs.msdn.microsoft.com/b/jpsanders/archive/2009/07/21/winhttp-proxy-configuration-on-windows-2003-x64.aspx
  - http://blogs.msdn.microsoft.com/b/jpsanders/archive/2009/07/21/winhttp-proxy-configuration-on-windows-2003-x64.aspx
  - http://blogs.msdn.microsoft.com/b/jpsanders/archive/2009/07/21/winhttp-proxy-configuration-on-windows-2003-x64.aspx
  - http://blogs.msdn.microsoft.com/b/jpsanders/archive/2009/07/21/winhttp-proxy-configuration-on-windows-2003-x64.aspx
  - http://blogs.msdn.microsoft.com/b/jpsanders/archive/2009/07/21/winhttp-proxy-configuration-on-windows-2003-x64.aspx
  - http://blogs.msdn.microsoft.com/b/jpsanders/archive/2009/07/21/winhttp-proxy-configuration-on-windows-2003-x64.aspx
  - http://blogs.msdn.microsoft.com/b/jpsanders/archive/2009/07/21/winhttp-proxy-configuration-on-windows-2003-x64.aspx
orig_site_id:
  - "8394"
  - "8394"
  - "8394"
  - "8394"
  - "8394"
  - "8394"
  - "8394"
  - "8394"
  - "8394"
  - "8394"
orig_post_id:
  - "9843601"
  - "9843601"
  - "9843601"
  - "9843601"
  - "9843601"
  - "9843601"
  - "9843601"
  - "9843601"
  - "9843601"
  - "9843601"
orig_parent_id:
  - "9843601"
  - "9843601"
  - "9843601"
  - "9843601"
  - "9843601"
  - "9843601"
  - "9843601"
  - "9843601"
  - "9843601"
  - "9843601"
orig_thread_id:
  - "667678"
  - "667678"
  - "667678"
  - "667678"
  - "667678"
  - "667678"
  - "667678"
  - "667678"
  - "667678"
  - "667678"
orig_application_key:
  - jpsanders
  - jpsanders
  - jpsanders
  - jpsanders
  - jpsanders
  - jpsanders
  - jpsanders
  - jpsanders
  - jpsanders
  - jpsanders
orig_post_author_id:
  - "65385"
  - "65385"
  - "65385"
  - "65385"
  - "65385"
  - "65385"
  - "65385"
  - "65385"
  - "65385"
  - "65385"
orig_post_author_username:
  - jpsanders
  - jpsanders
  - jpsanders
  - jpsanders
  - jpsanders
  - jpsanders
  - jpsanders
  - jpsanders
  - jpsanders
  - jpsanders
orig_post_author_created:
  - Jan 18 2007 01:34:53:000PM
  - Jan 18 2007 01:34:53:000PM
  - Jan 18 2007 01:34:53:000PM
  - Jan 18 2007 01:34:53:000PM
  - Jan 18 2007 01:34:53:000PM
  - Jan 18 2007 01:34:53:000PM
  - Jan 18 2007 01:34:53:000PM
  - Jan 18 2007 01:34:53:000PM
  - Jan 18 2007 01:34:53:000PM
  - Jan 18 2007 01:34:53:000PM
orig_is_approved:
  - "1"
  - "1"
  - "1"
  - "1"
  - "1"
  - "1"
  - "1"
  - "1"
  - "1"
  - "1"
orig_attachment_count:
  - "0"
  - "0"
  - "0"
  - "0"
  - "0"
  - "0"
  - "0"
  - "0"
  - "0"
  - "0"
orig_url_title:
  - http://blogs.msdn.com/b/jpsanders/archive/2009/07/21/winhttp-proxy-configuration-on-windows-2003-x64.aspx
  - http://blogs.msdn.com/b/jpsanders/archive/2009/07/21/winhttp-proxy-configuration-on-windows-2003-x64.aspx
  - http://blogs.msdn.com/b/jpsanders/archive/2009/07/21/winhttp-proxy-configuration-on-windows-2003-x64.aspx
  - http://blogs.msdn.com/b/jpsanders/archive/2009/07/21/winhttp-proxy-configuration-on-windows-2003-x64.aspx
  - http://blogs.msdn.com/b/jpsanders/archive/2009/07/21/winhttp-proxy-configuration-on-windows-2003-x64.aspx
  - http://blogs.msdn.com/b/jpsanders/archive/2009/07/21/winhttp-proxy-configuration-on-windows-2003-x64.aspx
  - http://blogs.msdn.com/b/jpsanders/archive/2009/07/21/winhttp-proxy-configuration-on-windows-2003-x64.aspx
  - http://blogs.msdn.com/b/jpsanders/archive/2009/07/21/winhttp-proxy-configuration-on-windows-2003-x64.aspx
  - http://blogs.msdn.com/b/jpsanders/archive/2009/07/21/winhttp-proxy-configuration-on-windows-2003-x64.aspx
  - http://blogs.msdn.com/b/jpsanders/archive/2009/07/21/winhttp-proxy-configuration-on-windows-2003-x64.aspx
opengraph_tags:
  - |
    <meta property="og:type" content="article" />
    <meta property="og:title" content="WinHttp Proxy configuration on Windows 2003 x64" />
    <meta property="og:url" content="https://blogs.msdn.microsoft.com/jpsanders/2009/07/21/winhttp-proxy-configuration-on-windows-2003-x64/" />
    <meta property="og:site_name" content="Http Client Protocol Issues (and other fun stuff I support)" />
    <meta property="og:description" content="You may get an error similar to this when running your WinHttp application: Error:&nbsp;The server name or address could not be resolvedCode:&nbsp;80072EE7Source: &nbsp;WinHttp.WinHttpRequest The familiar ProxyCfg application allows you to set the proxy settings for WinHttp.&nbsp; However in this case, your&nbsp; application is not picking up the proxy settings.&nbsp; You verify this by setting the..." />
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="WinHttp Proxy configuration on Windows 2003 x64" />
    <meta name="twitter:url" content="https://blogs.msdn.microsoft.com/jpsanders/2009/07/21/winhttp-proxy-configuration-on-windows-2003-x64/" />
    <meta name="twitter:description" content="You may get an error similar to this when running your WinHttp application: Error:&nbsp;The server name or address could not be resolvedCode:&nbsp;80072EE7Source: &nbsp;WinHttp.WinHttpRequest The familiar ProxyCfg application allows you to set the proxy settings for WinHttp.&nbsp; However in this case, your&nbsp; application is not picking up the proxy settings.&nbsp; You verify this by setting the..." />
    
  - |
    <meta property="og:type" content="article" />
    <meta property="og:title" content="WinHttp Proxy configuration on Windows 2003 x64" />
    <meta property="og:url" content="https://blogs.msdn.microsoft.com/jpsanders/2009/07/21/winhttp-proxy-configuration-on-windows-2003-x64/" />
    <meta property="og:site_name" content="Http Client Protocol Issues (and other fun stuff I support)" />
    <meta property="og:description" content="You may get an error similar to this when running your WinHttp application: Error:&nbsp;The server name or address could not be resolvedCode:&nbsp;80072EE7Source: &nbsp;WinHttp.WinHttpRequest The familiar ProxyCfg application allows you to set the proxy settings for WinHttp.&nbsp; However in this case, your&nbsp; application is not picking up the proxy settings.&nbsp; You verify this by setting the..." />
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="WinHttp Proxy configuration on Windows 2003 x64" />
    <meta name="twitter:url" content="https://blogs.msdn.microsoft.com/jpsanders/2009/07/21/winhttp-proxy-configuration-on-windows-2003-x64/" />
    <meta name="twitter:description" content="You may get an error similar to this when running your WinHttp application: Error:&nbsp;The server name or address could not be resolvedCode:&nbsp;80072EE7Source: &nbsp;WinHttp.WinHttpRequest The familiar ProxyCfg application allows you to set the proxy settings for WinHttp.&nbsp; However in this case, your&nbsp; application is not picking up the proxy settings.&nbsp; You verify this by setting the..." />
    
  - |
    <meta property="og:type" content="article" />
    <meta property="og:title" content="WinHttp Proxy configuration on Windows 2003 x64" />
    <meta property="og:url" content="https://blogs.msdn.microsoft.com/jpsanders/2009/07/21/winhttp-proxy-configuration-on-windows-2003-x64/" />
    <meta property="og:site_name" content="Http Client Protocol Issues (and other fun stuff I support)" />
    <meta property="og:description" content="You may get an error similar to this when running your WinHttp application: Error:&nbsp;The server name or address could not be resolvedCode:&nbsp;80072EE7Source: &nbsp;WinHttp.WinHttpRequest The familiar ProxyCfg application allows you to set the proxy settings for WinHttp.&nbsp; However in this case, your&nbsp; application is not picking up the proxy settings.&nbsp; You verify this by setting the..." />
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="WinHttp Proxy configuration on Windows 2003 x64" />
    <meta name="twitter:url" content="https://blogs.msdn.microsoft.com/jpsanders/2009/07/21/winhttp-proxy-configuration-on-windows-2003-x64/" />
    <meta name="twitter:description" content="You may get an error similar to this when running your WinHttp application: Error:&nbsp;The server name or address could not be resolvedCode:&nbsp;80072EE7Source: &nbsp;WinHttp.WinHttpRequest The familiar ProxyCfg application allows you to set the proxy settings for WinHttp.&nbsp; However in this case, your&nbsp; application is not picking up the proxy settings.&nbsp; You verify this by setting the..." />
    
  - |
    <meta property="og:type" content="article" />
    <meta property="og:title" content="WinHttp Proxy configuration on Windows 2003 x64" />
    <meta property="og:url" content="https://blogs.msdn.microsoft.com/jpsanders/2009/07/21/winhttp-proxy-configuration-on-windows-2003-x64/" />
    <meta property="og:site_name" content="Http Client Protocol Issues (and other fun stuff I support)" />
    <meta property="og:description" content="You may get an error similar to this when running your WinHttp application: Error:&nbsp;The server name or address could not be resolvedCode:&nbsp;80072EE7Source: &nbsp;WinHttp.WinHttpRequest The familiar ProxyCfg application allows you to set the proxy settings for WinHttp.&nbsp; However in this case, your&nbsp; application is not picking up the proxy settings.&nbsp; You verify this by setting the..." />
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="WinHttp Proxy configuration on Windows 2003 x64" />
    <meta name="twitter:url" content="https://blogs.msdn.microsoft.com/jpsanders/2009/07/21/winhttp-proxy-configuration-on-windows-2003-x64/" />
    <meta name="twitter:description" content="You may get an error similar to this when running your WinHttp application: Error:&nbsp;The server name or address could not be resolvedCode:&nbsp;80072EE7Source: &nbsp;WinHttp.WinHttpRequest The familiar ProxyCfg application allows you to set the proxy settings for WinHttp.&nbsp; However in this case, your&nbsp; application is not picking up the proxy settings.&nbsp; You verify this by setting the..." />
    
  - |
    <meta property="og:type" content="article" />
    <meta property="og:title" content="WinHttp Proxy configuration on Windows 2003 x64" />
    <meta property="og:url" content="https://blogs.msdn.microsoft.com/jpsanders/2009/07/21/winhttp-proxy-configuration-on-windows-2003-x64/" />
    <meta property="og:site_name" content="Http Client Protocol Issues (and other fun stuff I support)" />
    <meta property="og:description" content="You may get an error similar to this when running your WinHttp application: Error:&nbsp;The server name or address could not be resolvedCode:&nbsp;80072EE7Source: &nbsp;WinHttp.WinHttpRequest The familiar ProxyCfg application allows you to set the proxy settings for WinHttp.&nbsp; However in this case, your&nbsp; application is not picking up the proxy settings.&nbsp; You verify this by setting the..." />
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="WinHttp Proxy configuration on Windows 2003 x64" />
    <meta name="twitter:url" content="https://blogs.msdn.microsoft.com/jpsanders/2009/07/21/winhttp-proxy-configuration-on-windows-2003-x64/" />
    <meta name="twitter:description" content="You may get an error similar to this when running your WinHttp application: Error:&nbsp;The server name or address could not be resolvedCode:&nbsp;80072EE7Source: &nbsp;WinHttp.WinHttpRequest The familiar ProxyCfg application allows you to set the proxy settings for WinHttp.&nbsp; However in this case, your&nbsp; application is not picking up the proxy settings.&nbsp; You verify this by setting the..." />
    
  - |
    <meta property="og:type" content="article" />
    <meta property="og:title" content="WinHttp Proxy configuration on Windows 2003 x64" />
    <meta property="og:url" content="https://blogs.msdn.microsoft.com/jpsanders/2009/07/21/winhttp-proxy-configuration-on-windows-2003-x64/" />
    <meta property="og:site_name" content="Http Client Protocol Issues (and other fun stuff I support)" />
    <meta property="og:description" content="You may get an error similar to this when running your WinHttp application: Error:&nbsp;The server name or address could not be resolvedCode:&nbsp;80072EE7Source: &nbsp;WinHttp.WinHttpRequest The familiar ProxyCfg application allows you to set the proxy settings for WinHttp.&nbsp; However in this case, your&nbsp; application is not picking up the proxy settings.&nbsp; You verify this by setting the..." />
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="WinHttp Proxy configuration on Windows 2003 x64" />
    <meta name="twitter:url" content="https://blogs.msdn.microsoft.com/jpsanders/2009/07/21/winhttp-proxy-configuration-on-windows-2003-x64/" />
    <meta name="twitter:description" content="You may get an error similar to this when running your WinHttp application: Error:&nbsp;The server name or address could not be resolvedCode:&nbsp;80072EE7Source: &nbsp;WinHttp.WinHttpRequest The familiar ProxyCfg application allows you to set the proxy settings for WinHttp.&nbsp; However in this case, your&nbsp; application is not picking up the proxy settings.&nbsp; You verify this by setting the..." />
    
  - |
    <meta property="og:type" content="article" />
    <meta property="og:title" content="WinHttp Proxy configuration on Windows 2003 x64" />
    <meta property="og:url" content="https://blogs.msdn.microsoft.com/jpsanders/2009/07/21/winhttp-proxy-configuration-on-windows-2003-x64/" />
    <meta property="og:site_name" content="Http Client Protocol Issues (and other fun stuff I support)" />
    <meta property="og:description" content="You may get an error similar to this when running your WinHttp application: Error:&nbsp;The server name or address could not be resolvedCode:&nbsp;80072EE7Source: &nbsp;WinHttp.WinHttpRequest The familiar ProxyCfg application allows you to set the proxy settings for WinHttp.&nbsp; However in this case, your&nbsp; application is not picking up the proxy settings.&nbsp; You verify this by setting the..." />
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="WinHttp Proxy configuration on Windows 2003 x64" />
    <meta name="twitter:url" content="https://blogs.msdn.microsoft.com/jpsanders/2009/07/21/winhttp-proxy-configuration-on-windows-2003-x64/" />
    <meta name="twitter:description" content="You may get an error similar to this when running your WinHttp application: Error:&nbsp;The server name or address could not be resolvedCode:&nbsp;80072EE7Source: &nbsp;WinHttp.WinHttpRequest The familiar ProxyCfg application allows you to set the proxy settings for WinHttp.&nbsp; However in this case, your&nbsp; application is not picking up the proxy settings.&nbsp; You verify this by setting the..." />
    
  - |
    <meta property="og:type" content="article" />
    <meta property="og:title" content="WinHttp Proxy configuration on Windows 2003 x64" />
    <meta property="og:url" content="https://blogs.msdn.microsoft.com/jpsanders/2009/07/21/winhttp-proxy-configuration-on-windows-2003-x64/" />
    <meta property="og:site_name" content="Http Client Protocol Issues (and other fun stuff I support)" />
    <meta property="og:description" content="You may get an error similar to this when running your WinHttp application: Error:&nbsp;The server name or address could not be resolvedCode:&nbsp;80072EE7Source: &nbsp;WinHttp.WinHttpRequest The familiar ProxyCfg application allows you to set the proxy settings for WinHttp.&nbsp; However in this case, your&nbsp; application is not picking up the proxy settings.&nbsp; You verify this by setting the..." />
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="WinHttp Proxy configuration on Windows 2003 x64" />
    <meta name="twitter:url" content="https://blogs.msdn.microsoft.com/jpsanders/2009/07/21/winhttp-proxy-configuration-on-windows-2003-x64/" />
    <meta name="twitter:description" content="You may get an error similar to this when running your WinHttp application: Error:&nbsp;The server name or address could not be resolvedCode:&nbsp;80072EE7Source: &nbsp;WinHttp.WinHttpRequest The familiar ProxyCfg application allows you to set the proxy settings for WinHttp.&nbsp; However in this case, your&nbsp; application is not picking up the proxy settings.&nbsp; You verify this by setting the..." />
    
  - |
    <meta property="og:type" content="article" />
    <meta property="og:title" content="WinHttp Proxy configuration on Windows 2003 x64" />
    <meta property="og:url" content="https://blogs.msdn.microsoft.com/jpsanders/2009/07/21/winhttp-proxy-configuration-on-windows-2003-x64/" />
    <meta property="og:site_name" content="Http Client Protocol Issues (and other fun stuff I support)" />
    <meta property="og:description" content="You may get an error similar to this when running your WinHttp application: Error:&nbsp;The server name or address could not be resolvedCode:&nbsp;80072EE7Source: &nbsp;WinHttp.WinHttpRequest The familiar ProxyCfg application allows you to set the proxy settings for WinHttp.&nbsp; However in this case, your&nbsp; application is not picking up the proxy settings.&nbsp; You verify this by setting the..." />
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="WinHttp Proxy configuration on Windows 2003 x64" />
    <meta name="twitter:url" content="https://blogs.msdn.microsoft.com/jpsanders/2009/07/21/winhttp-proxy-configuration-on-windows-2003-x64/" />
    <meta name="twitter:description" content="You may get an error similar to this when running your WinHttp application: Error:&nbsp;The server name or address could not be resolvedCode:&nbsp;80072EE7Source: &nbsp;WinHttp.WinHttpRequest The familiar ProxyCfg application allows you to set the proxy settings for WinHttp.&nbsp; However in this case, your&nbsp; application is not picking up the proxy settings.&nbsp; You verify this by setting the..." />
    
  - |
    <meta property="og:type" content="article" />
    <meta property="og:title" content="WinHttp Proxy configuration on Windows 2003 x64" />
    <meta property="og:url" content="https://blogs.msdn.microsoft.com/jpsanders/2009/07/21/winhttp-proxy-configuration-on-windows-2003-x64/" />
    <meta property="og:site_name" content="Http Client Protocol Issues (and other fun stuff I support)" />
    <meta property="og:description" content="You may get an error similar to this when running your WinHttp application: Error:&nbsp;The server name or address could not be resolvedCode:&nbsp;80072EE7Source: &nbsp;WinHttp.WinHttpRequest The familiar ProxyCfg application allows you to set the proxy settings for WinHttp.&nbsp; However in this case, your&nbsp; application is not picking up the proxy settings.&nbsp; You verify this by setting the..." />
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="WinHttp Proxy configuration on Windows 2003 x64" />
    <meta name="twitter:url" content="https://blogs.msdn.microsoft.com/jpsanders/2009/07/21/winhttp-proxy-configuration-on-windows-2003-x64/" />
    <meta name="twitter:description" content="You may get an error similar to this when running your WinHttp application: Error:&nbsp;The server name or address could not be resolvedCode:&nbsp;80072EE7Source: &nbsp;WinHttp.WinHttpRequest The familiar ProxyCfg application allows you to set the proxy settings for WinHttp.&nbsp; However in this case, your&nbsp; application is not picking up the proxy settings.&nbsp; You verify this by setting the..." />
    
categories:
  - Uncategorized
tags:
  - WinHttp
---
You may get an error similar to this when running your WinHttp application:

Error:&nbsp;The server name or address could not be resolved  
Code:&nbsp;80072EE7  
Source: &nbsp;WinHttp.WinHttpRequest

The familiar <a href="http://msdn.microsoft.com/en-us/library/aa384069(VS.85).aspx" mce_href="http://msdn.microsoft.com/en-us/library/aa384069(VS.85).aspx">ProxyCfg</a> application allows you to set the proxy settings for WinHttp.&nbsp; However in this case, your&nbsp; application is not picking up the proxy settings.&nbsp; You verify this by setting the Proxy settings to the current user by typing &#8220;proxycfg -p myproxyhere&#8221; at the command line and you see from a Netmon trace that the proxy is not being utilized.&nbsp; 

Further research shows your application is loading the 32 bit version of WinHttp.&nbsp; In Windows 2003 x64, there is a directory for the 32 versions of the system components.&nbsp; You need to run this version for your 32 bit application: c:\windows\sysWow64\proxycfg -p myproxyhere.&nbsp; This fixes the issue.&nbsp; In general, on this platform when using proxycfg.exe, you should run the version in system32 and the version in sysWow64 to ensure you set the proxy setting for both versions of WinHttp on the system.

**Side note&nbsp;on WinHttp COM registration on Windows 2003 x64**

One thing interesting in the default installation of the 64 bit OS is that you will notice WinHttp.dll does not live in either the system32 or the sysWow64 directories.&nbsp; Also, if you look in the registry under HKCR\CLSID you will see no entry for WinHttp.WinHttpRequest.5.1.&nbsp; So how does a script succeed that calls CreateObject() on your progId?&nbsp; The magic here is the SideBySide (SxS) registration of WinHttp.&nbsp; You will notice there are WinHttp Dlls in the C:\WINDOWS\WinSxS\ subdirectories.&nbsp; You will also see in C:\WINDOWS\WinSxS\Manifests there are manifest files and the file names contain WINHTTP in them.&nbsp; Without going into a ton of detail, what happens is CLSIDFromProgID will take the name of the object you are creating and based on the Bitness of the application (64 or 32) there are internal system calls to find the latest version of winhttp and use that for the creation of the object.

That is why you cannot find the ProgID in the registry!

Let me know if this blog helped you out by dropping me a comment please!