---
id: 613
title: WinHttp Proxy Settings in 64 Bit (x64) Environments
date: 2010-09-16T07:38:55-05:00
author: jsanders
layout: post
guid: http://jsandersblog.azurewebsites.net/2010/09/16/winhttp-proxy-settings-in-64-bit-x64-environments/
permalink: /2010/09/16/winhttp-proxy-settings-in-64-bit-x64-environments/
orig_url:
  - http://blogs.msdn.microsoft.com/b/jpsanders/archive/2010/09/16/winhttp-proxy-settings-in-64-bit-x64-environments.aspx
  - http://blogs.msdn.microsoft.com/b/jpsanders/archive/2010/09/16/winhttp-proxy-settings-in-64-bit-x64-environments.aspx
  - http://blogs.msdn.microsoft.com/b/jpsanders/archive/2010/09/16/winhttp-proxy-settings-in-64-bit-x64-environments.aspx
  - http://blogs.msdn.microsoft.com/b/jpsanders/archive/2010/09/16/winhttp-proxy-settings-in-64-bit-x64-environments.aspx
  - http://blogs.msdn.microsoft.com/b/jpsanders/archive/2010/09/16/winhttp-proxy-settings-in-64-bit-x64-environments.aspx
  - http://blogs.msdn.microsoft.com/b/jpsanders/archive/2010/09/16/winhttp-proxy-settings-in-64-bit-x64-environments.aspx
  - http://blogs.msdn.microsoft.com/b/jpsanders/archive/2010/09/16/winhttp-proxy-settings-in-64-bit-x64-environments.aspx
  - http://blogs.msdn.microsoft.com/b/jpsanders/archive/2010/09/16/winhttp-proxy-settings-in-64-bit-x64-environments.aspx
  - http://blogs.msdn.microsoft.com/b/jpsanders/archive/2010/09/16/winhttp-proxy-settings-in-64-bit-x64-environments.aspx
orig_site_id:
  - "8394"
  - "8394"
  - "8394"
  - "8394"
  - "8394"
  - "8394"
  - "8394"
  - "8394"
  - "8394"
orig_post_id:
  - "10063253"
  - "10063253"
  - "10063253"
  - "10063253"
  - "10063253"
  - "10063253"
  - "10063253"
  - "10063253"
  - "10063253"
orig_parent_id:
  - "10063253"
  - "10063253"
  - "10063253"
  - "10063253"
  - "10063253"
  - "10063253"
  - "10063253"
  - "10063253"
  - "10063253"
orig_thread_id:
  - "732808"
  - "732808"
  - "732808"
  - "732808"
  - "732808"
  - "732808"
  - "732808"
  - "732808"
  - "732808"
orig_application_key:
  - jpsanders
  - jpsanders
  - jpsanders
  - jpsanders
  - jpsanders
  - jpsanders
  - jpsanders
  - jpsanders
  - jpsanders
orig_post_author_id:
  - "65385"
  - "65385"
  - "65385"
  - "65385"
  - "65385"
  - "65385"
  - "65385"
  - "65385"
  - "65385"
orig_post_author_username:
  - jpsanders
  - jpsanders
  - jpsanders
  - jpsanders
  - jpsanders
  - jpsanders
  - jpsanders
  - jpsanders
  - jpsanders
orig_post_author_created:
  - Jan 18 2007 01:34:53:000PM
  - Jan 18 2007 01:34:53:000PM
  - Jan 18 2007 01:34:53:000PM
  - Jan 18 2007 01:34:53:000PM
  - Jan 18 2007 01:34:53:000PM
  - Jan 18 2007 01:34:53:000PM
  - Jan 18 2007 01:34:53:000PM
  - Jan 18 2007 01:34:53:000PM
  - Jan 18 2007 01:34:53:000PM
orig_is_approved:
  - "1"
  - "1"
  - "1"
  - "1"
  - "1"
  - "1"
  - "1"
  - "1"
  - "1"
orig_attachment_count:
  - "0"
  - "0"
  - "0"
  - "0"
  - "0"
  - "0"
  - "0"
  - "0"
  - "0"
orig_url_title:
  - http://blogs.msdn.com/b/jpsanders/archive/2010/09/16/winhttp-proxy-settings-in-64-bit-x64-environments.aspx
  - http://blogs.msdn.com/b/jpsanders/archive/2010/09/16/winhttp-proxy-settings-in-64-bit-x64-environments.aspx
  - http://blogs.msdn.com/b/jpsanders/archive/2010/09/16/winhttp-proxy-settings-in-64-bit-x64-environments.aspx
  - http://blogs.msdn.com/b/jpsanders/archive/2010/09/16/winhttp-proxy-settings-in-64-bit-x64-environments.aspx
  - http://blogs.msdn.com/b/jpsanders/archive/2010/09/16/winhttp-proxy-settings-in-64-bit-x64-environments.aspx
  - http://blogs.msdn.com/b/jpsanders/archive/2010/09/16/winhttp-proxy-settings-in-64-bit-x64-environments.aspx
  - http://blogs.msdn.com/b/jpsanders/archive/2010/09/16/winhttp-proxy-settings-in-64-bit-x64-environments.aspx
  - http://blogs.msdn.com/b/jpsanders/archive/2010/09/16/winhttp-proxy-settings-in-64-bit-x64-environments.aspx
  - http://blogs.msdn.com/b/jpsanders/archive/2010/09/16/winhttp-proxy-settings-in-64-bit-x64-environments.aspx
opengraph_tags:
  - |
    <meta property="og:type" content="article" />
    <meta property="og:title" content="WinHttp Proxy Settings in 64 Bit (x64) Environments" />
    <meta property="og:url" content="https://blogs.msdn.microsoft.com/jpsanders/2010/09/16/winhttp-proxy-settings-in-64-bit-x64-environments/" />
    <meta property="og:site_name" content="Http Client Protocol Issues (and other fun stuff I support)" />
    <meta property="og:description" content="There are two settings for WinHttp Proxy settings for a 64 Bit OS.&nbsp; One applies to the 64 bit environment and one for the 32 bit environment.&nbsp; You can use netsh for Windows 2008, Windows 7 and later OSes and proxycfg.exe for earlier OSes.&nbsp; If you are confused and not sure where your WinHttp application..." />
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="WinHttp Proxy Settings in 64 Bit (x64) Environments" />
    <meta name="twitter:url" content="https://blogs.msdn.microsoft.com/jpsanders/2010/09/16/winhttp-proxy-settings-in-64-bit-x64-environments/" />
    <meta name="twitter:description" content="There are two settings for WinHttp Proxy settings for a 64 Bit OS.&nbsp; One applies to the 64 bit environment and one for the 32 bit environment.&nbsp; You can use netsh for Windows 2008, Windows 7 and later OSes and proxycfg.exe for earlier OSes.&nbsp; If you are confused and not sure where your WinHttp application..." />
    
  - |
    <meta property="og:type" content="article" />
    <meta property="og:title" content="WinHttp Proxy Settings in 64 Bit (x64) Environments" />
    <meta property="og:url" content="https://blogs.msdn.microsoft.com/jpsanders/2010/09/16/winhttp-proxy-settings-in-64-bit-x64-environments/" />
    <meta property="og:site_name" content="Http Client Protocol Issues (and other fun stuff I support)" />
    <meta property="og:description" content="There are two settings for WinHttp Proxy settings for a 64 Bit OS.&nbsp; One applies to the 64 bit environment and one for the 32 bit environment.&nbsp; You can use netsh for Windows 2008, Windows 7 and later OSes and proxycfg.exe for earlier OSes.&nbsp; If you are confused and not sure where your WinHttp application..." />
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="WinHttp Proxy Settings in 64 Bit (x64) Environments" />
    <meta name="twitter:url" content="https://blogs.msdn.microsoft.com/jpsanders/2010/09/16/winhttp-proxy-settings-in-64-bit-x64-environments/" />
    <meta name="twitter:description" content="There are two settings for WinHttp Proxy settings for a 64 Bit OS.&nbsp; One applies to the 64 bit environment and one for the 32 bit environment.&nbsp; You can use netsh for Windows 2008, Windows 7 and later OSes and proxycfg.exe for earlier OSes.&nbsp; If you are confused and not sure where your WinHttp application..." />
    
  - |
    <meta property="og:type" content="article" />
    <meta property="og:title" content="WinHttp Proxy Settings in 64 Bit (x64) Environments" />
    <meta property="og:url" content="https://blogs.msdn.microsoft.com/jpsanders/2010/09/16/winhttp-proxy-settings-in-64-bit-x64-environments/" />
    <meta property="og:site_name" content="Http Client Protocol Issues (and other fun stuff I support)" />
    <meta property="og:description" content="There are two settings for WinHttp Proxy settings for a 64 Bit OS.&nbsp; One applies to the 64 bit environment and one for the 32 bit environment.&nbsp; You can use netsh for Windows 2008, Windows 7 and later OSes and proxycfg.exe for earlier OSes.&nbsp; If you are confused and not sure where your WinHttp application..." />
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="WinHttp Proxy Settings in 64 Bit (x64) Environments" />
    <meta name="twitter:url" content="https://blogs.msdn.microsoft.com/jpsanders/2010/09/16/winhttp-proxy-settings-in-64-bit-x64-environments/" />
    <meta name="twitter:description" content="There are two settings for WinHttp Proxy settings for a 64 Bit OS.&nbsp; One applies to the 64 bit environment and one for the 32 bit environment.&nbsp; You can use netsh for Windows 2008, Windows 7 and later OSes and proxycfg.exe for earlier OSes.&nbsp; If you are confused and not sure where your WinHttp application..." />
    
  - |
    <meta property="og:type" content="article" />
    <meta property="og:title" content="WinHttp Proxy Settings in 64 Bit (x64) Environments" />
    <meta property="og:url" content="https://blogs.msdn.microsoft.com/jpsanders/2010/09/16/winhttp-proxy-settings-in-64-bit-x64-environments/" />
    <meta property="og:site_name" content="Http Client Protocol Issues (and other fun stuff I support)" />
    <meta property="og:description" content="There are two settings for WinHttp Proxy settings for a 64 Bit OS.&nbsp; One applies to the 64 bit environment and one for the 32 bit environment.&nbsp; You can use netsh for Windows 2008, Windows 7 and later OSes and proxycfg.exe for earlier OSes.&nbsp; If you are confused and not sure where your WinHttp application..." />
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="WinHttp Proxy Settings in 64 Bit (x64) Environments" />
    <meta name="twitter:url" content="https://blogs.msdn.microsoft.com/jpsanders/2010/09/16/winhttp-proxy-settings-in-64-bit-x64-environments/" />
    <meta name="twitter:description" content="There are two settings for WinHttp Proxy settings for a 64 Bit OS.&nbsp; One applies to the 64 bit environment and one for the 32 bit environment.&nbsp; You can use netsh for Windows 2008, Windows 7 and later OSes and proxycfg.exe for earlier OSes.&nbsp; If you are confused and not sure where your WinHttp application..." />
    
  - |
    <meta property="og:type" content="article" />
    <meta property="og:title" content="WinHttp Proxy Settings in 64 Bit (x64) Environments" />
    <meta property="og:url" content="https://blogs.msdn.microsoft.com/jpsanders/2010/09/16/winhttp-proxy-settings-in-64-bit-x64-environments/" />
    <meta property="og:site_name" content="Http Client Protocol Issues (and other fun stuff I support)" />
    <meta property="og:description" content="There are two settings for WinHttp Proxy settings for a 64 Bit OS.&nbsp; One applies to the 64 bit environment and one for the 32 bit environment.&nbsp; You can use netsh for Windows 2008, Windows 7 and later OSes and proxycfg.exe for earlier OSes.&nbsp; If you are confused and not sure where your WinHttp application..." />
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="WinHttp Proxy Settings in 64 Bit (x64) Environments" />
    <meta name="twitter:url" content="https://blogs.msdn.microsoft.com/jpsanders/2010/09/16/winhttp-proxy-settings-in-64-bit-x64-environments/" />
    <meta name="twitter:description" content="There are two settings for WinHttp Proxy settings for a 64 Bit OS.&nbsp; One applies to the 64 bit environment and one for the 32 bit environment.&nbsp; You can use netsh for Windows 2008, Windows 7 and later OSes and proxycfg.exe for earlier OSes.&nbsp; If you are confused and not sure where your WinHttp application..." />
    
  - |
    <meta property="og:type" content="article" />
    <meta property="og:title" content="WinHttp Proxy Settings in 64 Bit (x64) Environments" />
    <meta property="og:url" content="https://blogs.msdn.microsoft.com/jpsanders/2010/09/16/winhttp-proxy-settings-in-64-bit-x64-environments/" />
    <meta property="og:site_name" content="Http Client Protocol Issues (and other fun stuff I support)" />
    <meta property="og:description" content="There are two settings for WinHttp Proxy settings for a 64 Bit OS.&nbsp; One applies to the 64 bit environment and one for the 32 bit environment.&nbsp; You can use netsh for Windows 2008, Windows 7 and later OSes and proxycfg.exe for earlier OSes.&nbsp; If you are confused and not sure where your WinHttp application..." />
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="WinHttp Proxy Settings in 64 Bit (x64) Environments" />
    <meta name="twitter:url" content="https://blogs.msdn.microsoft.com/jpsanders/2010/09/16/winhttp-proxy-settings-in-64-bit-x64-environments/" />
    <meta name="twitter:description" content="There are two settings for WinHttp Proxy settings for a 64 Bit OS.&nbsp; One applies to the 64 bit environment and one for the 32 bit environment.&nbsp; You can use netsh for Windows 2008, Windows 7 and later OSes and proxycfg.exe for earlier OSes.&nbsp; If you are confused and not sure where your WinHttp application..." />
    
  - |
    <meta property="og:type" content="article" />
    <meta property="og:title" content="WinHttp Proxy Settings in 64 Bit (x64) Environments" />
    <meta property="og:url" content="https://blogs.msdn.microsoft.com/jpsanders/2010/09/16/winhttp-proxy-settings-in-64-bit-x64-environments/" />
    <meta property="og:site_name" content="Http Client Protocol Issues (and other fun stuff I support)" />
    <meta property="og:description" content="There are two settings for WinHttp Proxy settings for a 64 Bit OS.&nbsp; One applies to the 64 bit environment and one for the 32 bit environment.&nbsp; You can use netsh for Windows 2008, Windows 7 and later OSes and proxycfg.exe for earlier OSes.&nbsp; If you are confused and not sure where your WinHttp application..." />
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="WinHttp Proxy Settings in 64 Bit (x64) Environments" />
    <meta name="twitter:url" content="https://blogs.msdn.microsoft.com/jpsanders/2010/09/16/winhttp-proxy-settings-in-64-bit-x64-environments/" />
    <meta name="twitter:description" content="There are two settings for WinHttp Proxy settings for a 64 Bit OS.&nbsp; One applies to the 64 bit environment and one for the 32 bit environment.&nbsp; You can use netsh for Windows 2008, Windows 7 and later OSes and proxycfg.exe for earlier OSes.&nbsp; If you are confused and not sure where your WinHttp application..." />
    
  - |
    <meta property="og:type" content="article" />
    <meta property="og:title" content="WinHttp Proxy Settings in 64 Bit (x64) Environments" />
    <meta property="og:url" content="https://blogs.msdn.microsoft.com/jpsanders/2010/09/16/winhttp-proxy-settings-in-64-bit-x64-environments/" />
    <meta property="og:site_name" content="Http Client Protocol Issues (and other fun stuff I support)" />
    <meta property="og:description" content="There are two settings for WinHttp Proxy settings for a 64 Bit OS.&nbsp; One applies to the 64 bit environment and one for the 32 bit environment.&nbsp; You can use netsh for Windows 2008, Windows 7 and later OSes and proxycfg.exe for earlier OSes.&nbsp; If you are confused and not sure where your WinHttp application..." />
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="WinHttp Proxy Settings in 64 Bit (x64) Environments" />
    <meta name="twitter:url" content="https://blogs.msdn.microsoft.com/jpsanders/2010/09/16/winhttp-proxy-settings-in-64-bit-x64-environments/" />
    <meta name="twitter:description" content="There are two settings for WinHttp Proxy settings for a 64 Bit OS.&nbsp; One applies to the 64 bit environment and one for the 32 bit environment.&nbsp; You can use netsh for Windows 2008, Windows 7 and later OSes and proxycfg.exe for earlier OSes.&nbsp; If you are confused and not sure where your WinHttp application..." />
    
  - |
    <meta property="og:type" content="article" />
    <meta property="og:title" content="WinHttp Proxy Settings in 64 Bit (x64) Environments" />
    <meta property="og:url" content="https://blogs.msdn.microsoft.com/jpsanders/2010/09/16/winhttp-proxy-settings-in-64-bit-x64-environments/" />
    <meta property="og:site_name" content="Http Client Protocol Issues (and other fun stuff I support)" />
    <meta property="og:description" content="There are two settings for WinHttp Proxy settings for a 64 Bit OS.&nbsp; One applies to the 64 bit environment and one for the 32 bit environment.&nbsp; You can use netsh for Windows 2008, Windows 7 and later OSes and proxycfg.exe for earlier OSes.&nbsp; If you are confused and not sure where your WinHttp application..." />
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="WinHttp Proxy Settings in 64 Bit (x64) Environments" />
    <meta name="twitter:url" content="https://blogs.msdn.microsoft.com/jpsanders/2010/09/16/winhttp-proxy-settings-in-64-bit-x64-environments/" />
    <meta name="twitter:description" content="There are two settings for WinHttp Proxy settings for a 64 Bit OS.&nbsp; One applies to the 64 bit environment and one for the 32 bit environment.&nbsp; You can use netsh for Windows 2008, Windows 7 and later OSes and proxycfg.exe for earlier OSes.&nbsp; If you are confused and not sure where your WinHttp application..." />
    
categories:
  - Uncategorized
---
There are two settings for WinHttp Proxy settings for a 64 Bit OS.&nbsp; One applies to the 64 bit environment and one for the 32 bit environment.&nbsp; You can use netsh for Windows 2008, Windows 7 and later OSes and proxycfg.exe for earlier OSes.&nbsp; If you are confused and not sure where your WinHttp application is reading proxy settings from, the easiest way to determine where WinHttp is reading proxy settings from is to use procmon (process monitor).

To set the x64 WinHttp settings using netsh.exe, simply open a command prompt and type ‘netsh winhttp set proxy’ and set your proxy there (if you do not supply arguments it gives you some examples).&nbsp; This will run the 64 bit version of netsh from the System32 directory.

To set the 32 bit (x86) WinHttp settings, open a command prompt and navigate to the Windows\SysWOW64 directory and run netsh there. 

For proxycfg.exe you need to run proxycfg from the command line (system32 dir by default so x64 code) or the proxycfg from the c:\windows\sysWow64\ directory (x86 – 32bit).

&nbsp;

For another issue with the WinHttp COM object you can refer to my earlier post here: [http://blogs.msdn.com/b/jpsanders/archive/2009/07/21/winhttp-proxy-configuration-on-windows-2003-x64.aspx](http://blogs.msdn.com/b/jpsanders/archive/2009/07/21/winhttp-proxy-configuration-on-windows-2003-x64.aspx "http://blogs.msdn.com/b/jpsanders/archive/2009/07/21/winhttp-proxy-configuration-on-windows-2003-x64.aspx")

Let me know if this helps you!