---
id: 863
title: 'Understanding the new WinInet option: INTERNET_OPTION_MAX_CONNS_PER_PROXY'
date: 2009-06-08T11:52:00-05:00
author: jsanders
layout: post
guid: http://jsandersblog.azurewebsites.net/2009/06/08/understanding-the-new-wininet-option-internet_option_max_conns_per_proxy/
permalink: /2009/06/08/understanding-the-new-wininet-option-internet_option_max_conns_per_proxy/
orig_url:
  - http://blogs.msdn.microsoft.com/b/jpsanders/archive/2009/06/08/understanding-the-new-wininet-option-internet-option-max-conns-per-proxy.aspx
  - http://blogs.msdn.microsoft.com/b/jpsanders/archive/2009/06/08/understanding-the-new-wininet-option-internet-option-max-conns-per-proxy.aspx
  - http://blogs.msdn.microsoft.com/b/jpsanders/archive/2009/06/08/understanding-the-new-wininet-option-internet-option-max-conns-per-proxy.aspx
  - http://blogs.msdn.microsoft.com/b/jpsanders/archive/2009/06/08/understanding-the-new-wininet-option-internet-option-max-conns-per-proxy.aspx
  - http://blogs.msdn.microsoft.com/b/jpsanders/archive/2009/06/08/understanding-the-new-wininet-option-internet-option-max-conns-per-proxy.aspx
  - http://blogs.msdn.microsoft.com/b/jpsanders/archive/2009/06/08/understanding-the-new-wininet-option-internet-option-max-conns-per-proxy.aspx
  - http://blogs.msdn.microsoft.com/b/jpsanders/archive/2009/06/08/understanding-the-new-wininet-option-internet-option-max-conns-per-proxy.aspx
  - http://blogs.msdn.microsoft.com/b/jpsanders/archive/2009/06/08/understanding-the-new-wininet-option-internet-option-max-conns-per-proxy.aspx
  - http://blogs.msdn.microsoft.com/b/jpsanders/archive/2009/06/08/understanding-the-new-wininet-option-internet-option-max-conns-per-proxy.aspx
  - http://blogs.msdn.microsoft.com/b/jpsanders/archive/2009/06/08/understanding-the-new-wininet-option-internet-option-max-conns-per-proxy.aspx
orig_site_id:
  - "8394"
  - "8394"
  - "8394"
  - "8394"
  - "8394"
  - "8394"
  - "8394"
  - "8394"
  - "8394"
  - "8394"
orig_post_id:
  - "9708408"
  - "9708408"
  - "9708408"
  - "9708408"
  - "9708408"
  - "9708408"
  - "9708408"
  - "9708408"
  - "9708408"
  - "9708408"
orig_parent_id:
  - "9708408"
  - "9708408"
  - "9708408"
  - "9708408"
  - "9708408"
  - "9708408"
  - "9708408"
  - "9708408"
  - "9708408"
  - "9708408"
orig_thread_id:
  - "659888"
  - "659888"
  - "659888"
  - "659888"
  - "659888"
  - "659888"
  - "659888"
  - "659888"
  - "659888"
  - "659888"
orig_application_key:
  - jpsanders
  - jpsanders
  - jpsanders
  - jpsanders
  - jpsanders
  - jpsanders
  - jpsanders
  - jpsanders
  - jpsanders
  - jpsanders
orig_post_author_id:
  - "65385"
  - "65385"
  - "65385"
  - "65385"
  - "65385"
  - "65385"
  - "65385"
  - "65385"
  - "65385"
  - "65385"
orig_post_author_username:
  - jpsanders
  - jpsanders
  - jpsanders
  - jpsanders
  - jpsanders
  - jpsanders
  - jpsanders
  - jpsanders
  - jpsanders
  - jpsanders
orig_post_author_created:
  - Jan 18 2007 01:34:53:000PM
  - Jan 18 2007 01:34:53:000PM
  - Jan 18 2007 01:34:53:000PM
  - Jan 18 2007 01:34:53:000PM
  - Jan 18 2007 01:34:53:000PM
  - Jan 18 2007 01:34:53:000PM
  - Jan 18 2007 01:34:53:000PM
  - Jan 18 2007 01:34:53:000PM
  - Jan 18 2007 01:34:53:000PM
  - Jan 18 2007 01:34:53:000PM
orig_is_approved:
  - "1"
  - "1"
  - "1"
  - "1"
  - "1"
  - "1"
  - "1"
  - "1"
  - "1"
  - "1"
orig_attachment_count:
  - "0"
  - "0"
  - "0"
  - "0"
  - "0"
  - "0"
  - "0"
  - "0"
  - "0"
  - "0"
orig_url_title:
  - http://blogs.msdn.com/b/jpsanders/archive/2009/06/08/understanding-the-new-wininet-option-internet_option_max_conns_per_proxy.aspx
  - http://blogs.msdn.com/b/jpsanders/archive/2009/06/08/understanding-the-new-wininet-option-internet_option_max_conns_per_proxy.aspx
  - http://blogs.msdn.com/b/jpsanders/archive/2009/06/08/understanding-the-new-wininet-option-internet_option_max_conns_per_proxy.aspx
  - http://blogs.msdn.com/b/jpsanders/archive/2009/06/08/understanding-the-new-wininet-option-internet_option_max_conns_per_proxy.aspx
  - http://blogs.msdn.com/b/jpsanders/archive/2009/06/08/understanding-the-new-wininet-option-internet_option_max_conns_per_proxy.aspx
  - http://blogs.msdn.com/b/jpsanders/archive/2009/06/08/understanding-the-new-wininet-option-internet_option_max_conns_per_proxy.aspx
  - http://blogs.msdn.com/b/jpsanders/archive/2009/06/08/understanding-the-new-wininet-option-internet_option_max_conns_per_proxy.aspx
  - http://blogs.msdn.com/b/jpsanders/archive/2009/06/08/understanding-the-new-wininet-option-internet_option_max_conns_per_proxy.aspx
  - http://blogs.msdn.com/b/jpsanders/archive/2009/06/08/understanding-the-new-wininet-option-internet_option_max_conns_per_proxy.aspx
  - http://blogs.msdn.com/b/jpsanders/archive/2009/06/08/understanding-the-new-wininet-option-internet_option_max_conns_per_proxy.aspx
opengraph_tags:
  - |
    <meta property="og:type" content="article" />
    <meta property="og:title" content="Understanding the new WinInet option: INTERNET_OPTION_MAX_CONNS_PER_PROXY" />
    <meta property="og:url" content="https://blogs.msdn.microsoft.com/jpsanders/2009/06/08/understanding-the-new-wininet-option-internet_option_max_conns_per_proxy/" />
    <meta property="og:site_name" content="Http Client Protocol Issues (and other fun stuff I support)" />
    <meta property="og:description" content="The documentation on this is very straight forward (http://msdn.microsoft.com/en-us/library/aa385328(VS.85).aspx).&nbsp; At the time of publishing however the documentation has a slight error.&nbsp; You cannot pass a handle in for the first argument.&nbsp; It must be NULL or the call will return false and GetLastError() will show the error is: ERROR_INTERNET_INVALID_OPERATION. &nbsp;The default value for this option..." />
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="Understanding the new WinInet option: INTERNET_OPTION_MAX_CONNS_PER_PROXY" />
    <meta name="twitter:url" content="https://blogs.msdn.microsoft.com/jpsanders/2009/06/08/understanding-the-new-wininet-option-internet_option_max_conns_per_proxy/" />
    <meta name="twitter:description" content="The documentation on this is very straight forward (http://msdn.microsoft.com/en-us/library/aa385328(VS.85).aspx).&nbsp; At the time of publishing however the documentation has a slight error.&nbsp; You cannot pass a handle in for the first argument.&nbsp; It must be NULL or the call will return false and GetLastError() will show the error is: ERROR_INTERNET_INVALID_OPERATION. &nbsp;The default value for this option..." />
    
  - |
    <meta property="og:type" content="article" />
    <meta property="og:title" content="Understanding the new WinInet option: INTERNET_OPTION_MAX_CONNS_PER_PROXY" />
    <meta property="og:url" content="https://blogs.msdn.microsoft.com/jpsanders/2009/06/08/understanding-the-new-wininet-option-internet_option_max_conns_per_proxy/" />
    <meta property="og:site_name" content="Http Client Protocol Issues (and other fun stuff I support)" />
    <meta property="og:description" content="The documentation on this is very straight forward (http://msdn.microsoft.com/en-us/library/aa385328(VS.85).aspx).&nbsp; At the time of publishing however the documentation has a slight error.&nbsp; You cannot pass a handle in for the first argument.&nbsp; It must be NULL or the call will return false and GetLastError() will show the error is: ERROR_INTERNET_INVALID_OPERATION. &nbsp;The default value for this option..." />
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="Understanding the new WinInet option: INTERNET_OPTION_MAX_CONNS_PER_PROXY" />
    <meta name="twitter:url" content="https://blogs.msdn.microsoft.com/jpsanders/2009/06/08/understanding-the-new-wininet-option-internet_option_max_conns_per_proxy/" />
    <meta name="twitter:description" content="The documentation on this is very straight forward (http://msdn.microsoft.com/en-us/library/aa385328(VS.85).aspx).&nbsp; At the time of publishing however the documentation has a slight error.&nbsp; You cannot pass a handle in for the first argument.&nbsp; It must be NULL or the call will return false and GetLastError() will show the error is: ERROR_INTERNET_INVALID_OPERATION. &nbsp;The default value for this option..." />
    
  - |
    <meta property="og:type" content="article" />
    <meta property="og:title" content="Understanding the new WinInet option: INTERNET_OPTION_MAX_CONNS_PER_PROXY" />
    <meta property="og:url" content="https://blogs.msdn.microsoft.com/jpsanders/2009/06/08/understanding-the-new-wininet-option-internet_option_max_conns_per_proxy/" />
    <meta property="og:site_name" content="Http Client Protocol Issues (and other fun stuff I support)" />
    <meta property="og:description" content="The documentation on this is very straight forward (http://msdn.microsoft.com/en-us/library/aa385328(VS.85).aspx).&nbsp; At the time of publishing however the documentation has a slight error.&nbsp; You cannot pass a handle in for the first argument.&nbsp; It must be NULL or the call will return false and GetLastError() will show the error is: ERROR_INTERNET_INVALID_OPERATION. &nbsp;The default value for this option..." />
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="Understanding the new WinInet option: INTERNET_OPTION_MAX_CONNS_PER_PROXY" />
    <meta name="twitter:url" content="https://blogs.msdn.microsoft.com/jpsanders/2009/06/08/understanding-the-new-wininet-option-internet_option_max_conns_per_proxy/" />
    <meta name="twitter:description" content="The documentation on this is very straight forward (http://msdn.microsoft.com/en-us/library/aa385328(VS.85).aspx).&nbsp; At the time of publishing however the documentation has a slight error.&nbsp; You cannot pass a handle in for the first argument.&nbsp; It must be NULL or the call will return false and GetLastError() will show the error is: ERROR_INTERNET_INVALID_OPERATION. &nbsp;The default value for this option..." />
    
  - |
    <meta property="og:type" content="article" />
    <meta property="og:title" content="Understanding the new WinInet option: INTERNET_OPTION_MAX_CONNS_PER_PROXY" />
    <meta property="og:url" content="https://blogs.msdn.microsoft.com/jpsanders/2009/06/08/understanding-the-new-wininet-option-internet_option_max_conns_per_proxy/" />
    <meta property="og:site_name" content="Http Client Protocol Issues (and other fun stuff I support)" />
    <meta property="og:description" content="The documentation on this is very straight forward (http://msdn.microsoft.com/en-us/library/aa385328(VS.85).aspx).&nbsp; At the time of publishing however the documentation has a slight error.&nbsp; You cannot pass a handle in for the first argument.&nbsp; It must be NULL or the call will return false and GetLastError() will show the error is: ERROR_INTERNET_INVALID_OPERATION. &nbsp;The default value for this option..." />
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="Understanding the new WinInet option: INTERNET_OPTION_MAX_CONNS_PER_PROXY" />
    <meta name="twitter:url" content="https://blogs.msdn.microsoft.com/jpsanders/2009/06/08/understanding-the-new-wininet-option-internet_option_max_conns_per_proxy/" />
    <meta name="twitter:description" content="The documentation on this is very straight forward (http://msdn.microsoft.com/en-us/library/aa385328(VS.85).aspx).&nbsp; At the time of publishing however the documentation has a slight error.&nbsp; You cannot pass a handle in for the first argument.&nbsp; It must be NULL or the call will return false and GetLastError() will show the error is: ERROR_INTERNET_INVALID_OPERATION. &nbsp;The default value for this option..." />
    
  - |
    <meta property="og:type" content="article" />
    <meta property="og:title" content="Understanding the new WinInet option: INTERNET_OPTION_MAX_CONNS_PER_PROXY" />
    <meta property="og:url" content="https://blogs.msdn.microsoft.com/jpsanders/2009/06/08/understanding-the-new-wininet-option-internet_option_max_conns_per_proxy/" />
    <meta property="og:site_name" content="Http Client Protocol Issues (and other fun stuff I support)" />
    <meta property="og:description" content="The documentation on this is very straight forward (http://msdn.microsoft.com/en-us/library/aa385328(VS.85).aspx).&nbsp; At the time of publishing however the documentation has a slight error.&nbsp; You cannot pass a handle in for the first argument.&nbsp; It must be NULL or the call will return false and GetLastError() will show the error is: ERROR_INTERNET_INVALID_OPERATION. &nbsp;The default value for this option..." />
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="Understanding the new WinInet option: INTERNET_OPTION_MAX_CONNS_PER_PROXY" />
    <meta name="twitter:url" content="https://blogs.msdn.microsoft.com/jpsanders/2009/06/08/understanding-the-new-wininet-option-internet_option_max_conns_per_proxy/" />
    <meta name="twitter:description" content="The documentation on this is very straight forward (http://msdn.microsoft.com/en-us/library/aa385328(VS.85).aspx).&nbsp; At the time of publishing however the documentation has a slight error.&nbsp; You cannot pass a handle in for the first argument.&nbsp; It must be NULL or the call will return false and GetLastError() will show the error is: ERROR_INTERNET_INVALID_OPERATION. &nbsp;The default value for this option..." />
    
  - |
    <meta property="og:type" content="article" />
    <meta property="og:title" content="Understanding the new WinInet option: INTERNET_OPTION_MAX_CONNS_PER_PROXY" />
    <meta property="og:url" content="https://blogs.msdn.microsoft.com/jpsanders/2009/06/08/understanding-the-new-wininet-option-internet_option_max_conns_per_proxy/" />
    <meta property="og:site_name" content="Http Client Protocol Issues (and other fun stuff I support)" />
    <meta property="og:description" content="The documentation on this is very straight forward (http://msdn.microsoft.com/en-us/library/aa385328(VS.85).aspx).&nbsp; At the time of publishing however the documentation has a slight error.&nbsp; You cannot pass a handle in for the first argument.&nbsp; It must be NULL or the call will return false and GetLastError() will show the error is: ERROR_INTERNET_INVALID_OPERATION. &nbsp;The default value for this option..." />
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="Understanding the new WinInet option: INTERNET_OPTION_MAX_CONNS_PER_PROXY" />
    <meta name="twitter:url" content="https://blogs.msdn.microsoft.com/jpsanders/2009/06/08/understanding-the-new-wininet-option-internet_option_max_conns_per_proxy/" />
    <meta name="twitter:description" content="The documentation on this is very straight forward (http://msdn.microsoft.com/en-us/library/aa385328(VS.85).aspx).&nbsp; At the time of publishing however the documentation has a slight error.&nbsp; You cannot pass a handle in for the first argument.&nbsp; It must be NULL or the call will return false and GetLastError() will show the error is: ERROR_INTERNET_INVALID_OPERATION. &nbsp;The default value for this option..." />
    
  - |
    <meta property="og:type" content="article" />
    <meta property="og:title" content="Understanding the new WinInet option: INTERNET_OPTION_MAX_CONNS_PER_PROXY" />
    <meta property="og:url" content="https://blogs.msdn.microsoft.com/jpsanders/2009/06/08/understanding-the-new-wininet-option-internet_option_max_conns_per_proxy/" />
    <meta property="og:site_name" content="Http Client Protocol Issues (and other fun stuff I support)" />
    <meta property="og:description" content="The documentation on this is very straight forward (http://msdn.microsoft.com/en-us/library/aa385328(VS.85).aspx).&nbsp; At the time of publishing however the documentation has a slight error.&nbsp; You cannot pass a handle in for the first argument.&nbsp; It must be NULL or the call will return false and GetLastError() will show the error is: ERROR_INTERNET_INVALID_OPERATION. &nbsp;The default value for this option..." />
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="Understanding the new WinInet option: INTERNET_OPTION_MAX_CONNS_PER_PROXY" />
    <meta name="twitter:url" content="https://blogs.msdn.microsoft.com/jpsanders/2009/06/08/understanding-the-new-wininet-option-internet_option_max_conns_per_proxy/" />
    <meta name="twitter:description" content="The documentation on this is very straight forward (http://msdn.microsoft.com/en-us/library/aa385328(VS.85).aspx).&nbsp; At the time of publishing however the documentation has a slight error.&nbsp; You cannot pass a handle in for the first argument.&nbsp; It must be NULL or the call will return false and GetLastError() will show the error is: ERROR_INTERNET_INVALID_OPERATION. &nbsp;The default value for this option..." />
    
  - |
    <meta property="og:type" content="article" />
    <meta property="og:title" content="Understanding the new WinInet option: INTERNET_OPTION_MAX_CONNS_PER_PROXY" />
    <meta property="og:url" content="https://blogs.msdn.microsoft.com/jpsanders/2009/06/08/understanding-the-new-wininet-option-internet_option_max_conns_per_proxy/" />
    <meta property="og:site_name" content="Http Client Protocol Issues (and other fun stuff I support)" />
    <meta property="og:description" content="The documentation on this is very straight forward (http://msdn.microsoft.com/en-us/library/aa385328(VS.85).aspx).&nbsp; At the time of publishing however the documentation has a slight error.&nbsp; You cannot pass a handle in for the first argument.&nbsp; It must be NULL or the call will return false and GetLastError() will show the error is: ERROR_INTERNET_INVALID_OPERATION. &nbsp;The default value for this option..." />
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="Understanding the new WinInet option: INTERNET_OPTION_MAX_CONNS_PER_PROXY" />
    <meta name="twitter:url" content="https://blogs.msdn.microsoft.com/jpsanders/2009/06/08/understanding-the-new-wininet-option-internet_option_max_conns_per_proxy/" />
    <meta name="twitter:description" content="The documentation on this is very straight forward (http://msdn.microsoft.com/en-us/library/aa385328(VS.85).aspx).&nbsp; At the time of publishing however the documentation has a slight error.&nbsp; You cannot pass a handle in for the first argument.&nbsp; It must be NULL or the call will return false and GetLastError() will show the error is: ERROR_INTERNET_INVALID_OPERATION. &nbsp;The default value for this option..." />
    
  - |
    <meta property="og:type" content="article" />
    <meta property="og:title" content="Understanding the new WinInet option: INTERNET_OPTION_MAX_CONNS_PER_PROXY" />
    <meta property="og:url" content="https://blogs.msdn.microsoft.com/jpsanders/2009/06/08/understanding-the-new-wininet-option-internet_option_max_conns_per_proxy/" />
    <meta property="og:site_name" content="Http Client Protocol Issues (and other fun stuff I support)" />
    <meta property="og:description" content="The documentation on this is very straight forward (http://msdn.microsoft.com/en-us/library/aa385328(VS.85).aspx).&nbsp; At the time of publishing however the documentation has a slight error.&nbsp; You cannot pass a handle in for the first argument.&nbsp; It must be NULL or the call will return false and GetLastError() will show the error is: ERROR_INTERNET_INVALID_OPERATION. &nbsp;The default value for this option..." />
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="Understanding the new WinInet option: INTERNET_OPTION_MAX_CONNS_PER_PROXY" />
    <meta name="twitter:url" content="https://blogs.msdn.microsoft.com/jpsanders/2009/06/08/understanding-the-new-wininet-option-internet_option_max_conns_per_proxy/" />
    <meta name="twitter:description" content="The documentation on this is very straight forward (http://msdn.microsoft.com/en-us/library/aa385328(VS.85).aspx).&nbsp; At the time of publishing however the documentation has a slight error.&nbsp; You cannot pass a handle in for the first argument.&nbsp; It must be NULL or the call will return false and GetLastError() will show the error is: ERROR_INTERNET_INVALID_OPERATION. &nbsp;The default value for this option..." />
    
  - |
    <meta property="og:type" content="article" />
    <meta property="og:title" content="Understanding the new WinInet option: INTERNET_OPTION_MAX_CONNS_PER_PROXY" />
    <meta property="og:url" content="https://blogs.msdn.microsoft.com/jpsanders/2009/06/08/understanding-the-new-wininet-option-internet_option_max_conns_per_proxy/" />
    <meta property="og:site_name" content="Http Client Protocol Issues (and other fun stuff I support)" />
    <meta property="og:description" content="The documentation on this is very straight forward (http://msdn.microsoft.com/en-us/library/aa385328(VS.85).aspx).&nbsp; At the time of publishing however the documentation has a slight error.&nbsp; You cannot pass a handle in for the first argument.&nbsp; It must be NULL or the call will return false and GetLastError() will show the error is: ERROR_INTERNET_INVALID_OPERATION. &nbsp;The default value for this option..." />
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="Understanding the new WinInet option: INTERNET_OPTION_MAX_CONNS_PER_PROXY" />
    <meta name="twitter:url" content="https://blogs.msdn.microsoft.com/jpsanders/2009/06/08/understanding-the-new-wininet-option-internet_option_max_conns_per_proxy/" />
    <meta name="twitter:description" content="The documentation on this is very straight forward (http://msdn.microsoft.com/en-us/library/aa385328(VS.85).aspx).&nbsp; At the time of publishing however the documentation has a slight error.&nbsp; You cannot pass a handle in for the first argument.&nbsp; It must be NULL or the call will return false and GetLastError() will show the error is: ERROR_INTERNET_INVALID_OPERATION. &nbsp;The default value for this option..." />
    
categories:
  - Uncategorized
tags:
  - IE 8
  - WinInet
---
The documentation on this is very straight forward (<a href="http://msdn.microsoft.com/en-us/library/aa385328(VS.85).aspx" mce_href="http://msdn.microsoft.com/en-us/library/aa385328(VS.85).aspx">http://msdn.microsoft.com/en-us/library/aa385328(VS.85).aspx</a>).&nbsp; At the time of publishing however the documentation has a slight error.&nbsp; You cannot pass a handle in for the first argument.&nbsp; It must be NULL or the call will return false and GetLastError() will show the error is: <font size=2>ERROR\_INTERNET\_INVALID_OPERATION.</font>

&nbsp;The default value for this option is 4 connections.

&nbsp;Also see this post: <http://blogs.msdn.com/jpsanders/archive/2009/06/29/understanding-connection-limits-and-new-proxy-connection-limits-in-wininet-and-internet-explorer.aspx>

Let me know if this article was useful to you!