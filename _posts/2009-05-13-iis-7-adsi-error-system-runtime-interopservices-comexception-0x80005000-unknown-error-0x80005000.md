---
id: 943
title: 'IIS 7 ADSI Error: System.Runtime.InteropServices.COMException (0x80005000): Unknown error (0x80005000)'
date: 2009-05-13T10:12:00-05:00
author: jsanders
layout: post
guid: http://jsandersblog.azurewebsites.net/2009/05/13/iis-7-adsi-error-system-runtime-interopservices-comexception-0x80005000-unknown-error-0x80005000/
permalink: /2009/05/13/iis-7-adsi-error-system-runtime-interopservices-comexception-0x80005000-unknown-error-0x80005000/
orig_url:
  - 'http://blogs.msdn.microsoft.com/b/jpsanders/archive/2009/05/13/iis-7-adsi-error-system-runtime-interopservices-comexception-0x80005000-unknown-error-0x80005000%20.aspx'
  - 'http://blogs.msdn.microsoft.com/b/jpsanders/archive/2009/05/13/iis-7-adsi-error-system-runtime-interopservices-comexception-0x80005000-unknown-error-0x80005000%20.aspx'
  - 'http://blogs.msdn.microsoft.com/b/jpsanders/archive/2009/05/13/iis-7-adsi-error-system-runtime-interopservices-comexception-0x80005000-unknown-error-0x80005000%20.aspx'
  - 'http://blogs.msdn.microsoft.com/b/jpsanders/archive/2009/05/13/iis-7-adsi-error-system-runtime-interopservices-comexception-0x80005000-unknown-error-0x80005000%20.aspx'
  - 'http://blogs.msdn.microsoft.com/b/jpsanders/archive/2009/05/13/iis-7-adsi-error-system-runtime-interopservices-comexception-0x80005000-unknown-error-0x80005000%20.aspx'
  - 'http://blogs.msdn.microsoft.com/b/jpsanders/archive/2009/05/13/iis-7-adsi-error-system-runtime-interopservices-comexception-0x80005000-unknown-error-0x80005000%20.aspx'
  - 'http://blogs.msdn.microsoft.com/b/jpsanders/archive/2009/05/13/iis-7-adsi-error-system-runtime-interopservices-comexception-0x80005000-unknown-error-0x80005000%20.aspx'
  - 'http://blogs.msdn.microsoft.com/b/jpsanders/archive/2009/05/13/iis-7-adsi-error-system-runtime-interopservices-comexception-0x80005000-unknown-error-0x80005000%20.aspx'
  - 'http://blogs.msdn.microsoft.com/b/jpsanders/archive/2009/05/13/iis-7-adsi-error-system-runtime-interopservices-comexception-0x80005000-unknown-error-0x80005000%20.aspx'
  - 'http://blogs.msdn.microsoft.com/b/jpsanders/archive/2009/05/13/iis-7-adsi-error-system-runtime-interopservices-comexception-0x80005000-unknown-error-0x80005000%20.aspx'
orig_site_id:
  - "8394"
  - "8394"
  - "8394"
  - "8394"
  - "8394"
  - "8394"
  - "8394"
  - "8394"
  - "8394"
  - "8394"
orig_post_id:
  - "9609322"
  - "9609322"
  - "9609322"
  - "9609322"
  - "9609322"
  - "9609322"
  - "9609322"
  - "9609322"
  - "9609322"
  - "9609322"
orig_parent_id:
  - "9609322"
  - "9609322"
  - "9609322"
  - "9609322"
  - "9609322"
  - "9609322"
  - "9609322"
  - "9609322"
  - "9609322"
  - "9609322"
orig_thread_id:
  - "654448"
  - "654448"
  - "654448"
  - "654448"
  - "654448"
  - "654448"
  - "654448"
  - "654448"
  - "654448"
  - "654448"
orig_application_key:
  - jpsanders
  - jpsanders
  - jpsanders
  - jpsanders
  - jpsanders
  - jpsanders
  - jpsanders
  - jpsanders
  - jpsanders
  - jpsanders
orig_post_author_id:
  - "65385"
  - "65385"
  - "65385"
  - "65385"
  - "65385"
  - "65385"
  - "65385"
  - "65385"
  - "65385"
  - "65385"
orig_post_author_username:
  - jpsanders
  - jpsanders
  - jpsanders
  - jpsanders
  - jpsanders
  - jpsanders
  - jpsanders
  - jpsanders
  - jpsanders
  - jpsanders
orig_post_author_created:
  - Jan 18 2007 01:34:53:000PM
  - Jan 18 2007 01:34:53:000PM
  - Jan 18 2007 01:34:53:000PM
  - Jan 18 2007 01:34:53:000PM
  - Jan 18 2007 01:34:53:000PM
  - Jan 18 2007 01:34:53:000PM
  - Jan 18 2007 01:34:53:000PM
  - Jan 18 2007 01:34:53:000PM
  - Jan 18 2007 01:34:53:000PM
  - Jan 18 2007 01:34:53:000PM
orig_is_approved:
  - "1"
  - "1"
  - "1"
  - "1"
  - "1"
  - "1"
  - "1"
  - "1"
  - "1"
  - "1"
orig_attachment_count:
  - "0"
  - "0"
  - "0"
  - "0"
  - "0"
  - "0"
  - "0"
  - "0"
  - "0"
  - "0"
orig_url_title:
  - http://blogs.msdn.com/b/jpsanders/archive/2009/05/13/iis-7-adsi-error-system-runtime-interopservices-comexception-0x80005000-unknown-error-0x80005000.aspx
  - http://blogs.msdn.com/b/jpsanders/archive/2009/05/13/iis-7-adsi-error-system-runtime-interopservices-comexception-0x80005000-unknown-error-0x80005000.aspx
  - http://blogs.msdn.com/b/jpsanders/archive/2009/05/13/iis-7-adsi-error-system-runtime-interopservices-comexception-0x80005000-unknown-error-0x80005000.aspx
  - http://blogs.msdn.com/b/jpsanders/archive/2009/05/13/iis-7-adsi-error-system-runtime-interopservices-comexception-0x80005000-unknown-error-0x80005000.aspx
  - http://blogs.msdn.com/b/jpsanders/archive/2009/05/13/iis-7-adsi-error-system-runtime-interopservices-comexception-0x80005000-unknown-error-0x80005000.aspx
  - http://blogs.msdn.com/b/jpsanders/archive/2009/05/13/iis-7-adsi-error-system-runtime-interopservices-comexception-0x80005000-unknown-error-0x80005000.aspx
  - http://blogs.msdn.com/b/jpsanders/archive/2009/05/13/iis-7-adsi-error-system-runtime-interopservices-comexception-0x80005000-unknown-error-0x80005000.aspx
  - http://blogs.msdn.com/b/jpsanders/archive/2009/05/13/iis-7-adsi-error-system-runtime-interopservices-comexception-0x80005000-unknown-error-0x80005000.aspx
  - http://blogs.msdn.com/b/jpsanders/archive/2009/05/13/iis-7-adsi-error-system-runtime-interopservices-comexception-0x80005000-unknown-error-0x80005000.aspx
  - http://blogs.msdn.com/b/jpsanders/archive/2009/05/13/iis-7-adsi-error-system-runtime-interopservices-comexception-0x80005000-unknown-error-0x80005000.aspx
opengraph_tags:
  - |
    <meta property="og:type" content="article" />
    <meta property="og:title" content="IIS 7 ADSI Error: System.Runtime.InteropServices.COMException (0x80005000): Unknown error (0x80005000)" />
    <meta property="og:url" content="https://blogs.msdn.microsoft.com/jpsanders/2009/05/13/iis-7-adsi-error-system-runtime-interopservices-comexception-0x80005000-unknown-error-0x80005000/" />
    <meta property="og:site_name" content="Http Client Protocol Issues (and other fun stuff I support)" />
    <meta property="og:description" content="The following code worked fine on IIS 6 but when used on IIS it failed: System.DirectoryServices.DirectoryEntry iisServer;iisServer = new System.DirectoryServices.DirectoryEntry(&#8220;IIS://jsanders4/W3SVC/1&#8243;);System.DirectoryServices.DirectoryEntry rootFolder = iisServer.Children.Find(&#8220;Root&#8221;, &#8220;IIsWebVirtualDir&#8221;); //exception here The exception was as follows:&nbsp; [System.Runtime.InteropServices.COMException]&nbsp;{&#8220;Unknown error (0x80005000)&#8221;}&nbsp;System.Runtime.InteropServices.COMException Unknown error (0x80005000)&nbsp;&nbsp; at System.DirectoryServices.DirectoryEntry.Bind(Boolean throwIfFail)&nbsp;&nbsp; at System.DirectoryServices.DirectoryEntry.Bind()&nbsp;&nbsp; at System.DirectoryServices.DirectoryEntry.get_IsContainer()&nbsp;&nbsp; at System.DirectoryServices.DirectoryEntries.CheckIsContainer()&nbsp;&nbsp; at System.DirectoryServices.DirectoryEntries.Find(String name, String schemaClassName)&nbsp; &nbsp; The error code..." />
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="IIS 7 ADSI Error: System.Runtime.InteropServices.COMException (0x80005000): Unknown error (0x80005000)" />
    <meta name="twitter:url" content="https://blogs.msdn.microsoft.com/jpsanders/2009/05/13/iis-7-adsi-error-system-runtime-interopservices-comexception-0x80005000-unknown-error-0x80005000/" />
    <meta name="twitter:description" content="The following code worked fine on IIS 6 but when used on IIS it failed: System.DirectoryServices.DirectoryEntry iisServer;iisServer = new System.DirectoryServices.DirectoryEntry(&#8220;IIS://jsanders4/W3SVC/1&#8243;);System.DirectoryServices.DirectoryEntry rootFolder = iisServer.Children.Find(&#8220;Root&#8221;, &#8220;IIsWebVirtualDir&#8221;); //exception here The exception was as follows:&nbsp; [System.Runtime.InteropServices.COMException]&nbsp;{&#8220;Unknown error (0x80005000)&#8221;}&nbsp;System.Runtime.InteropServices.COMException Unknown error (0x80005000)&nbsp;&nbsp; at System.DirectoryServices.DirectoryEntry.Bind(Boolean throwIfFail)&nbsp;&nbsp; at System.DirectoryServices.DirectoryEntry.Bind()&nbsp;&nbsp; at System.DirectoryServices.DirectoryEntry.get_IsContainer()&nbsp;&nbsp; at System.DirectoryServices.DirectoryEntries.CheckIsContainer()&nbsp;&nbsp; at System.DirectoryServices.DirectoryEntries.Find(String name, String schemaClassName)&nbsp; &nbsp; The error code..." />
    
  - |
    <meta property="og:type" content="article" />
    <meta property="og:title" content="IIS 7 ADSI Error: System.Runtime.InteropServices.COMException (0x80005000): Unknown error (0x80005000)" />
    <meta property="og:url" content="https://blogs.msdn.microsoft.com/jpsanders/2009/05/13/iis-7-adsi-error-system-runtime-interopservices-comexception-0x80005000-unknown-error-0x80005000/" />
    <meta property="og:site_name" content="Http Client Protocol Issues (and other fun stuff I support)" />
    <meta property="og:description" content="The following code worked fine on IIS 6 but when used on IIS it failed: System.DirectoryServices.DirectoryEntry iisServer;iisServer = new System.DirectoryServices.DirectoryEntry(&#8220;IIS://jsanders4/W3SVC/1&#8243;);System.DirectoryServices.DirectoryEntry rootFolder = iisServer.Children.Find(&#8220;Root&#8221;, &#8220;IIsWebVirtualDir&#8221;); //exception here The exception was as follows:&nbsp; [System.Runtime.InteropServices.COMException]&nbsp;{&#8220;Unknown error (0x80005000)&#8221;}&nbsp;System.Runtime.InteropServices.COMException Unknown error (0x80005000)&nbsp;&nbsp; at System.DirectoryServices.DirectoryEntry.Bind(Boolean throwIfFail)&nbsp;&nbsp; at System.DirectoryServices.DirectoryEntry.Bind()&nbsp;&nbsp; at System.DirectoryServices.DirectoryEntry.get_IsContainer()&nbsp;&nbsp; at System.DirectoryServices.DirectoryEntries.CheckIsContainer()&nbsp;&nbsp; at System.DirectoryServices.DirectoryEntries.Find(String name, String schemaClassName)&nbsp; &nbsp; The error code..." />
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="IIS 7 ADSI Error: System.Runtime.InteropServices.COMException (0x80005000): Unknown error (0x80005000)" />
    <meta name="twitter:url" content="https://blogs.msdn.microsoft.com/jpsanders/2009/05/13/iis-7-adsi-error-system-runtime-interopservices-comexception-0x80005000-unknown-error-0x80005000/" />
    <meta name="twitter:description" content="The following code worked fine on IIS 6 but when used on IIS it failed: System.DirectoryServices.DirectoryEntry iisServer;iisServer = new System.DirectoryServices.DirectoryEntry(&#8220;IIS://jsanders4/W3SVC/1&#8243;);System.DirectoryServices.DirectoryEntry rootFolder = iisServer.Children.Find(&#8220;Root&#8221;, &#8220;IIsWebVirtualDir&#8221;); //exception here The exception was as follows:&nbsp; [System.Runtime.InteropServices.COMException]&nbsp;{&#8220;Unknown error (0x80005000)&#8221;}&nbsp;System.Runtime.InteropServices.COMException Unknown error (0x80005000)&nbsp;&nbsp; at System.DirectoryServices.DirectoryEntry.Bind(Boolean throwIfFail)&nbsp;&nbsp; at System.DirectoryServices.DirectoryEntry.Bind()&nbsp;&nbsp; at System.DirectoryServices.DirectoryEntry.get_IsContainer()&nbsp;&nbsp; at System.DirectoryServices.DirectoryEntries.CheckIsContainer()&nbsp;&nbsp; at System.DirectoryServices.DirectoryEntries.Find(String name, String schemaClassName)&nbsp; &nbsp; The error code..." />
    
  - |
    <meta property="og:type" content="article" />
    <meta property="og:title" content="IIS 7 ADSI Error: System.Runtime.InteropServices.COMException (0x80005000): Unknown error (0x80005000)" />
    <meta property="og:url" content="https://blogs.msdn.microsoft.com/jpsanders/2009/05/13/iis-7-adsi-error-system-runtime-interopservices-comexception-0x80005000-unknown-error-0x80005000/" />
    <meta property="og:site_name" content="Http Client Protocol Issues (and other fun stuff I support)" />
    <meta property="og:description" content="The following code worked fine on IIS 6 but when used on IIS it failed: System.DirectoryServices.DirectoryEntry iisServer;iisServer = new System.DirectoryServices.DirectoryEntry(&#8220;IIS://jsanders4/W3SVC/1&#8243;);System.DirectoryServices.DirectoryEntry rootFolder = iisServer.Children.Find(&#8220;Root&#8221;, &#8220;IIsWebVirtualDir&#8221;); //exception here The exception was as follows:&nbsp; [System.Runtime.InteropServices.COMException]&nbsp;{&#8220;Unknown error (0x80005000)&#8221;}&nbsp;System.Runtime.InteropServices.COMException Unknown error (0x80005000)&nbsp;&nbsp; at System.DirectoryServices.DirectoryEntry.Bind(Boolean throwIfFail)&nbsp;&nbsp; at System.DirectoryServices.DirectoryEntry.Bind()&nbsp;&nbsp; at System.DirectoryServices.DirectoryEntry.get_IsContainer()&nbsp;&nbsp; at System.DirectoryServices.DirectoryEntries.CheckIsContainer()&nbsp;&nbsp; at System.DirectoryServices.DirectoryEntries.Find(String name, String schemaClassName)&nbsp; &nbsp; The error code..." />
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="IIS 7 ADSI Error: System.Runtime.InteropServices.COMException (0x80005000): Unknown error (0x80005000)" />
    <meta name="twitter:url" content="https://blogs.msdn.microsoft.com/jpsanders/2009/05/13/iis-7-adsi-error-system-runtime-interopservices-comexception-0x80005000-unknown-error-0x80005000/" />
    <meta name="twitter:description" content="The following code worked fine on IIS 6 but when used on IIS it failed: System.DirectoryServices.DirectoryEntry iisServer;iisServer = new System.DirectoryServices.DirectoryEntry(&#8220;IIS://jsanders4/W3SVC/1&#8243;);System.DirectoryServices.DirectoryEntry rootFolder = iisServer.Children.Find(&#8220;Root&#8221;, &#8220;IIsWebVirtualDir&#8221;); //exception here The exception was as follows:&nbsp; [System.Runtime.InteropServices.COMException]&nbsp;{&#8220;Unknown error (0x80005000)&#8221;}&nbsp;System.Runtime.InteropServices.COMException Unknown error (0x80005000)&nbsp;&nbsp; at System.DirectoryServices.DirectoryEntry.Bind(Boolean throwIfFail)&nbsp;&nbsp; at System.DirectoryServices.DirectoryEntry.Bind()&nbsp;&nbsp; at System.DirectoryServices.DirectoryEntry.get_IsContainer()&nbsp;&nbsp; at System.DirectoryServices.DirectoryEntries.CheckIsContainer()&nbsp;&nbsp; at System.DirectoryServices.DirectoryEntries.Find(String name, String schemaClassName)&nbsp; &nbsp; The error code..." />
    
  - |
    <meta property="og:type" content="article" />
    <meta property="og:title" content="IIS 7 ADSI Error: System.Runtime.InteropServices.COMException (0x80005000): Unknown error (0x80005000)" />
    <meta property="og:url" content="https://blogs.msdn.microsoft.com/jpsanders/2009/05/13/iis-7-adsi-error-system-runtime-interopservices-comexception-0x80005000-unknown-error-0x80005000/" />
    <meta property="og:site_name" content="Http Client Protocol Issues (and other fun stuff I support)" />
    <meta property="og:description" content="The following code worked fine on IIS 6 but when used on IIS it failed: System.DirectoryServices.DirectoryEntry iisServer;iisServer = new System.DirectoryServices.DirectoryEntry(&#8220;IIS://jsanders4/W3SVC/1&#8243;);System.DirectoryServices.DirectoryEntry rootFolder = iisServer.Children.Find(&#8220;Root&#8221;, &#8220;IIsWebVirtualDir&#8221;); //exception here The exception was as follows:&nbsp; [System.Runtime.InteropServices.COMException]&nbsp;{&#8220;Unknown error (0x80005000)&#8221;}&nbsp;System.Runtime.InteropServices.COMException Unknown error (0x80005000)&nbsp;&nbsp; at System.DirectoryServices.DirectoryEntry.Bind(Boolean throwIfFail)&nbsp;&nbsp; at System.DirectoryServices.DirectoryEntry.Bind()&nbsp;&nbsp; at System.DirectoryServices.DirectoryEntry.get_IsContainer()&nbsp;&nbsp; at System.DirectoryServices.DirectoryEntries.CheckIsContainer()&nbsp;&nbsp; at System.DirectoryServices.DirectoryEntries.Find(String name, String schemaClassName)&nbsp; &nbsp; The error code..." />
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="IIS 7 ADSI Error: System.Runtime.InteropServices.COMException (0x80005000): Unknown error (0x80005000)" />
    <meta name="twitter:url" content="https://blogs.msdn.microsoft.com/jpsanders/2009/05/13/iis-7-adsi-error-system-runtime-interopservices-comexception-0x80005000-unknown-error-0x80005000/" />
    <meta name="twitter:description" content="The following code worked fine on IIS 6 but when used on IIS it failed: System.DirectoryServices.DirectoryEntry iisServer;iisServer = new System.DirectoryServices.DirectoryEntry(&#8220;IIS://jsanders4/W3SVC/1&#8243;);System.DirectoryServices.DirectoryEntry rootFolder = iisServer.Children.Find(&#8220;Root&#8221;, &#8220;IIsWebVirtualDir&#8221;); //exception here The exception was as follows:&nbsp; [System.Runtime.InteropServices.COMException]&nbsp;{&#8220;Unknown error (0x80005000)&#8221;}&nbsp;System.Runtime.InteropServices.COMException Unknown error (0x80005000)&nbsp;&nbsp; at System.DirectoryServices.DirectoryEntry.Bind(Boolean throwIfFail)&nbsp;&nbsp; at System.DirectoryServices.DirectoryEntry.Bind()&nbsp;&nbsp; at System.DirectoryServices.DirectoryEntry.get_IsContainer()&nbsp;&nbsp; at System.DirectoryServices.DirectoryEntries.CheckIsContainer()&nbsp;&nbsp; at System.DirectoryServices.DirectoryEntries.Find(String name, String schemaClassName)&nbsp; &nbsp; The error code..." />
    
  - |
    <meta property="og:type" content="article" />
    <meta property="og:title" content="IIS 7 ADSI Error: System.Runtime.InteropServices.COMException (0x80005000): Unknown error (0x80005000)" />
    <meta property="og:url" content="https://blogs.msdn.microsoft.com/jpsanders/2009/05/13/iis-7-adsi-error-system-runtime-interopservices-comexception-0x80005000-unknown-error-0x80005000/" />
    <meta property="og:site_name" content="Http Client Protocol Issues (and other fun stuff I support)" />
    <meta property="og:description" content="The following code worked fine on IIS 6 but when used on IIS it failed: System.DirectoryServices.DirectoryEntry iisServer;iisServer = new System.DirectoryServices.DirectoryEntry(&#8220;IIS://jsanders4/W3SVC/1&#8243;);System.DirectoryServices.DirectoryEntry rootFolder = iisServer.Children.Find(&#8220;Root&#8221;, &#8220;IIsWebVirtualDir&#8221;); //exception here The exception was as follows:&nbsp; [System.Runtime.InteropServices.COMException]&nbsp;{&#8220;Unknown error (0x80005000)&#8221;}&nbsp;System.Runtime.InteropServices.COMException Unknown error (0x80005000)&nbsp;&nbsp; at System.DirectoryServices.DirectoryEntry.Bind(Boolean throwIfFail)&nbsp;&nbsp; at System.DirectoryServices.DirectoryEntry.Bind()&nbsp;&nbsp; at System.DirectoryServices.DirectoryEntry.get_IsContainer()&nbsp;&nbsp; at System.DirectoryServices.DirectoryEntries.CheckIsContainer()&nbsp;&nbsp; at System.DirectoryServices.DirectoryEntries.Find(String name, String schemaClassName)&nbsp; &nbsp; The error code..." />
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="IIS 7 ADSI Error: System.Runtime.InteropServices.COMException (0x80005000): Unknown error (0x80005000)" />
    <meta name="twitter:url" content="https://blogs.msdn.microsoft.com/jpsanders/2009/05/13/iis-7-adsi-error-system-runtime-interopservices-comexception-0x80005000-unknown-error-0x80005000/" />
    <meta name="twitter:description" content="The following code worked fine on IIS 6 but when used on IIS it failed: System.DirectoryServices.DirectoryEntry iisServer;iisServer = new System.DirectoryServices.DirectoryEntry(&#8220;IIS://jsanders4/W3SVC/1&#8243;);System.DirectoryServices.DirectoryEntry rootFolder = iisServer.Children.Find(&#8220;Root&#8221;, &#8220;IIsWebVirtualDir&#8221;); //exception here The exception was as follows:&nbsp; [System.Runtime.InteropServices.COMException]&nbsp;{&#8220;Unknown error (0x80005000)&#8221;}&nbsp;System.Runtime.InteropServices.COMException Unknown error (0x80005000)&nbsp;&nbsp; at System.DirectoryServices.DirectoryEntry.Bind(Boolean throwIfFail)&nbsp;&nbsp; at System.DirectoryServices.DirectoryEntry.Bind()&nbsp;&nbsp; at System.DirectoryServices.DirectoryEntry.get_IsContainer()&nbsp;&nbsp; at System.DirectoryServices.DirectoryEntries.CheckIsContainer()&nbsp;&nbsp; at System.DirectoryServices.DirectoryEntries.Find(String name, String schemaClassName)&nbsp; &nbsp; The error code..." />
    
  - |
    <meta property="og:type" content="article" />
    <meta property="og:title" content="IIS 7 ADSI Error: System.Runtime.InteropServices.COMException (0x80005000): Unknown error (0x80005000)" />
    <meta property="og:url" content="https://blogs.msdn.microsoft.com/jpsanders/2009/05/13/iis-7-adsi-error-system-runtime-interopservices-comexception-0x80005000-unknown-error-0x80005000/" />
    <meta property="og:site_name" content="Http Client Protocol Issues (and other fun stuff I support)" />
    <meta property="og:description" content="The following code worked fine on IIS 6 but when used on IIS it failed: System.DirectoryServices.DirectoryEntry iisServer;iisServer = new System.DirectoryServices.DirectoryEntry(&#8220;IIS://jsanders4/W3SVC/1&#8243;);System.DirectoryServices.DirectoryEntry rootFolder = iisServer.Children.Find(&#8220;Root&#8221;, &#8220;IIsWebVirtualDir&#8221;); //exception here The exception was as follows:&nbsp; [System.Runtime.InteropServices.COMException]&nbsp;{&#8220;Unknown error (0x80005000)&#8221;}&nbsp;System.Runtime.InteropServices.COMException Unknown error (0x80005000)&nbsp;&nbsp; at System.DirectoryServices.DirectoryEntry.Bind(Boolean throwIfFail)&nbsp;&nbsp; at System.DirectoryServices.DirectoryEntry.Bind()&nbsp;&nbsp; at System.DirectoryServices.DirectoryEntry.get_IsContainer()&nbsp;&nbsp; at System.DirectoryServices.DirectoryEntries.CheckIsContainer()&nbsp;&nbsp; at System.DirectoryServices.DirectoryEntries.Find(String name, String schemaClassName)&nbsp; &nbsp; The error code..." />
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="IIS 7 ADSI Error: System.Runtime.InteropServices.COMException (0x80005000): Unknown error (0x80005000)" />
    <meta name="twitter:url" content="https://blogs.msdn.microsoft.com/jpsanders/2009/05/13/iis-7-adsi-error-system-runtime-interopservices-comexception-0x80005000-unknown-error-0x80005000/" />
    <meta name="twitter:description" content="The following code worked fine on IIS 6 but when used on IIS it failed: System.DirectoryServices.DirectoryEntry iisServer;iisServer = new System.DirectoryServices.DirectoryEntry(&#8220;IIS://jsanders4/W3SVC/1&#8243;);System.DirectoryServices.DirectoryEntry rootFolder = iisServer.Children.Find(&#8220;Root&#8221;, &#8220;IIsWebVirtualDir&#8221;); //exception here The exception was as follows:&nbsp; [System.Runtime.InteropServices.COMException]&nbsp;{&#8220;Unknown error (0x80005000)&#8221;}&nbsp;System.Runtime.InteropServices.COMException Unknown error (0x80005000)&nbsp;&nbsp; at System.DirectoryServices.DirectoryEntry.Bind(Boolean throwIfFail)&nbsp;&nbsp; at System.DirectoryServices.DirectoryEntry.Bind()&nbsp;&nbsp; at System.DirectoryServices.DirectoryEntry.get_IsContainer()&nbsp;&nbsp; at System.DirectoryServices.DirectoryEntries.CheckIsContainer()&nbsp;&nbsp; at System.DirectoryServices.DirectoryEntries.Find(String name, String schemaClassName)&nbsp; &nbsp; The error code..." />
    
  - |
    <meta property="og:type" content="article" />
    <meta property="og:title" content="IIS 7 ADSI Error: System.Runtime.InteropServices.COMException (0x80005000): Unknown error (0x80005000)" />
    <meta property="og:url" content="https://blogs.msdn.microsoft.com/jpsanders/2009/05/13/iis-7-adsi-error-system-runtime-interopservices-comexception-0x80005000-unknown-error-0x80005000/" />
    <meta property="og:site_name" content="Http Client Protocol Issues (and other fun stuff I support)" />
    <meta property="og:description" content="The following code worked fine on IIS 6 but when used on IIS it failed: System.DirectoryServices.DirectoryEntry iisServer;iisServer = new System.DirectoryServices.DirectoryEntry(&#8220;IIS://jsanders4/W3SVC/1&#8243;);System.DirectoryServices.DirectoryEntry rootFolder = iisServer.Children.Find(&#8220;Root&#8221;, &#8220;IIsWebVirtualDir&#8221;); //exception here The exception was as follows:&nbsp; [System.Runtime.InteropServices.COMException]&nbsp;{&#8220;Unknown error (0x80005000)&#8221;}&nbsp;System.Runtime.InteropServices.COMException Unknown error (0x80005000)&nbsp;&nbsp; at System.DirectoryServices.DirectoryEntry.Bind(Boolean throwIfFail)&nbsp;&nbsp; at System.DirectoryServices.DirectoryEntry.Bind()&nbsp;&nbsp; at System.DirectoryServices.DirectoryEntry.get_IsContainer()&nbsp;&nbsp; at System.DirectoryServices.DirectoryEntries.CheckIsContainer()&nbsp;&nbsp; at System.DirectoryServices.DirectoryEntries.Find(String name, String schemaClassName)&nbsp; &nbsp; The error code..." />
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="IIS 7 ADSI Error: System.Runtime.InteropServices.COMException (0x80005000): Unknown error (0x80005000)" />
    <meta name="twitter:url" content="https://blogs.msdn.microsoft.com/jpsanders/2009/05/13/iis-7-adsi-error-system-runtime-interopservices-comexception-0x80005000-unknown-error-0x80005000/" />
    <meta name="twitter:description" content="The following code worked fine on IIS 6 but when used on IIS it failed: System.DirectoryServices.DirectoryEntry iisServer;iisServer = new System.DirectoryServices.DirectoryEntry(&#8220;IIS://jsanders4/W3SVC/1&#8243;);System.DirectoryServices.DirectoryEntry rootFolder = iisServer.Children.Find(&#8220;Root&#8221;, &#8220;IIsWebVirtualDir&#8221;); //exception here The exception was as follows:&nbsp; [System.Runtime.InteropServices.COMException]&nbsp;{&#8220;Unknown error (0x80005000)&#8221;}&nbsp;System.Runtime.InteropServices.COMException Unknown error (0x80005000)&nbsp;&nbsp; at System.DirectoryServices.DirectoryEntry.Bind(Boolean throwIfFail)&nbsp;&nbsp; at System.DirectoryServices.DirectoryEntry.Bind()&nbsp;&nbsp; at System.DirectoryServices.DirectoryEntry.get_IsContainer()&nbsp;&nbsp; at System.DirectoryServices.DirectoryEntries.CheckIsContainer()&nbsp;&nbsp; at System.DirectoryServices.DirectoryEntries.Find(String name, String schemaClassName)&nbsp; &nbsp; The error code..." />
    
  - |
    <meta property="og:type" content="article" />
    <meta property="og:title" content="IIS 7 ADSI Error: System.Runtime.InteropServices.COMException (0x80005000): Unknown error (0x80005000)" />
    <meta property="og:url" content="https://blogs.msdn.microsoft.com/jpsanders/2009/05/13/iis-7-adsi-error-system-runtime-interopservices-comexception-0x80005000-unknown-error-0x80005000/" />
    <meta property="og:site_name" content="Http Client Protocol Issues (and other fun stuff I support)" />
    <meta property="og:description" content="The following code worked fine on IIS 6 but when used on IIS it failed: System.DirectoryServices.DirectoryEntry iisServer;iisServer = new System.DirectoryServices.DirectoryEntry(&#8220;IIS://jsanders4/W3SVC/1&#8243;);System.DirectoryServices.DirectoryEntry rootFolder = iisServer.Children.Find(&#8220;Root&#8221;, &#8220;IIsWebVirtualDir&#8221;); //exception here The exception was as follows:&nbsp; [System.Runtime.InteropServices.COMException]&nbsp;{&#8220;Unknown error (0x80005000)&#8221;}&nbsp;System.Runtime.InteropServices.COMException Unknown error (0x80005000)&nbsp;&nbsp; at System.DirectoryServices.DirectoryEntry.Bind(Boolean throwIfFail)&nbsp;&nbsp; at System.DirectoryServices.DirectoryEntry.Bind()&nbsp;&nbsp; at System.DirectoryServices.DirectoryEntry.get_IsContainer()&nbsp;&nbsp; at System.DirectoryServices.DirectoryEntries.CheckIsContainer()&nbsp;&nbsp; at System.DirectoryServices.DirectoryEntries.Find(String name, String schemaClassName)&nbsp; &nbsp; The error code..." />
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="IIS 7 ADSI Error: System.Runtime.InteropServices.COMException (0x80005000): Unknown error (0x80005000)" />
    <meta name="twitter:url" content="https://blogs.msdn.microsoft.com/jpsanders/2009/05/13/iis-7-adsi-error-system-runtime-interopservices-comexception-0x80005000-unknown-error-0x80005000/" />
    <meta name="twitter:description" content="The following code worked fine on IIS 6 but when used on IIS it failed: System.DirectoryServices.DirectoryEntry iisServer;iisServer = new System.DirectoryServices.DirectoryEntry(&#8220;IIS://jsanders4/W3SVC/1&#8243;);System.DirectoryServices.DirectoryEntry rootFolder = iisServer.Children.Find(&#8220;Root&#8221;, &#8220;IIsWebVirtualDir&#8221;); //exception here The exception was as follows:&nbsp; [System.Runtime.InteropServices.COMException]&nbsp;{&#8220;Unknown error (0x80005000)&#8221;}&nbsp;System.Runtime.InteropServices.COMException Unknown error (0x80005000)&nbsp;&nbsp; at System.DirectoryServices.DirectoryEntry.Bind(Boolean throwIfFail)&nbsp;&nbsp; at System.DirectoryServices.DirectoryEntry.Bind()&nbsp;&nbsp; at System.DirectoryServices.DirectoryEntry.get_IsContainer()&nbsp;&nbsp; at System.DirectoryServices.DirectoryEntries.CheckIsContainer()&nbsp;&nbsp; at System.DirectoryServices.DirectoryEntries.Find(String name, String schemaClassName)&nbsp; &nbsp; The error code..." />
    
  - |
    <meta property="og:type" content="article" />
    <meta property="og:title" content="IIS 7 ADSI Error: System.Runtime.InteropServices.COMException (0x80005000): Unknown error (0x80005000)" />
    <meta property="og:url" content="https://blogs.msdn.microsoft.com/jpsanders/2009/05/13/iis-7-adsi-error-system-runtime-interopservices-comexception-0x80005000-unknown-error-0x80005000/" />
    <meta property="og:site_name" content="Http Client Protocol Issues (and other fun stuff I support)" />
    <meta property="og:description" content="The following code worked fine on IIS 6 but when used on IIS it failed: System.DirectoryServices.DirectoryEntry iisServer;iisServer = new System.DirectoryServices.DirectoryEntry(&#8220;IIS://jsanders4/W3SVC/1&#8243;);System.DirectoryServices.DirectoryEntry rootFolder = iisServer.Children.Find(&#8220;Root&#8221;, &#8220;IIsWebVirtualDir&#8221;); //exception here The exception was as follows:&nbsp; [System.Runtime.InteropServices.COMException]&nbsp;{&#8220;Unknown error (0x80005000)&#8221;}&nbsp;System.Runtime.InteropServices.COMException Unknown error (0x80005000)&nbsp;&nbsp; at System.DirectoryServices.DirectoryEntry.Bind(Boolean throwIfFail)&nbsp;&nbsp; at System.DirectoryServices.DirectoryEntry.Bind()&nbsp;&nbsp; at System.DirectoryServices.DirectoryEntry.get_IsContainer()&nbsp;&nbsp; at System.DirectoryServices.DirectoryEntries.CheckIsContainer()&nbsp;&nbsp; at System.DirectoryServices.DirectoryEntries.Find(String name, String schemaClassName)&nbsp; &nbsp; The error code..." />
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="IIS 7 ADSI Error: System.Runtime.InteropServices.COMException (0x80005000): Unknown error (0x80005000)" />
    <meta name="twitter:url" content="https://blogs.msdn.microsoft.com/jpsanders/2009/05/13/iis-7-adsi-error-system-runtime-interopservices-comexception-0x80005000-unknown-error-0x80005000/" />
    <meta name="twitter:description" content="The following code worked fine on IIS 6 but when used on IIS it failed: System.DirectoryServices.DirectoryEntry iisServer;iisServer = new System.DirectoryServices.DirectoryEntry(&#8220;IIS://jsanders4/W3SVC/1&#8243;);System.DirectoryServices.DirectoryEntry rootFolder = iisServer.Children.Find(&#8220;Root&#8221;, &#8220;IIsWebVirtualDir&#8221;); //exception here The exception was as follows:&nbsp; [System.Runtime.InteropServices.COMException]&nbsp;{&#8220;Unknown error (0x80005000)&#8221;}&nbsp;System.Runtime.InteropServices.COMException Unknown error (0x80005000)&nbsp;&nbsp; at System.DirectoryServices.DirectoryEntry.Bind(Boolean throwIfFail)&nbsp;&nbsp; at System.DirectoryServices.DirectoryEntry.Bind()&nbsp;&nbsp; at System.DirectoryServices.DirectoryEntry.get_IsContainer()&nbsp;&nbsp; at System.DirectoryServices.DirectoryEntries.CheckIsContainer()&nbsp;&nbsp; at System.DirectoryServices.DirectoryEntries.Find(String name, String schemaClassName)&nbsp; &nbsp; The error code..." />
    
  - |
    <meta property="og:type" content="article" />
    <meta property="og:title" content="IIS 7 ADSI Error: System.Runtime.InteropServices.COMException (0x80005000): Unknown error (0x80005000)" />
    <meta property="og:url" content="https://blogs.msdn.microsoft.com/jpsanders/2009/05/13/iis-7-adsi-error-system-runtime-interopservices-comexception-0x80005000-unknown-error-0x80005000/" />
    <meta property="og:site_name" content="Http Client Protocol Issues (and other fun stuff I support)" />
    <meta property="og:description" content="The following code worked fine on IIS 6 but when used on IIS it failed: System.DirectoryServices.DirectoryEntry iisServer;iisServer = new System.DirectoryServices.DirectoryEntry(&#8220;IIS://jsanders4/W3SVC/1&#8243;);System.DirectoryServices.DirectoryEntry rootFolder = iisServer.Children.Find(&#8220;Root&#8221;, &#8220;IIsWebVirtualDir&#8221;); //exception here The exception was as follows:&nbsp; [System.Runtime.InteropServices.COMException]&nbsp;{&#8220;Unknown error (0x80005000)&#8221;}&nbsp;System.Runtime.InteropServices.COMException Unknown error (0x80005000)&nbsp;&nbsp; at System.DirectoryServices.DirectoryEntry.Bind(Boolean throwIfFail)&nbsp;&nbsp; at System.DirectoryServices.DirectoryEntry.Bind()&nbsp;&nbsp; at System.DirectoryServices.DirectoryEntry.get_IsContainer()&nbsp;&nbsp; at System.DirectoryServices.DirectoryEntries.CheckIsContainer()&nbsp;&nbsp; at System.DirectoryServices.DirectoryEntries.Find(String name, String schemaClassName)&nbsp; &nbsp; The error code..." />
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="IIS 7 ADSI Error: System.Runtime.InteropServices.COMException (0x80005000): Unknown error (0x80005000)" />
    <meta name="twitter:url" content="https://blogs.msdn.microsoft.com/jpsanders/2009/05/13/iis-7-adsi-error-system-runtime-interopservices-comexception-0x80005000-unknown-error-0x80005000/" />
    <meta name="twitter:description" content="The following code worked fine on IIS 6 but when used on IIS it failed: System.DirectoryServices.DirectoryEntry iisServer;iisServer = new System.DirectoryServices.DirectoryEntry(&#8220;IIS://jsanders4/W3SVC/1&#8243;);System.DirectoryServices.DirectoryEntry rootFolder = iisServer.Children.Find(&#8220;Root&#8221;, &#8220;IIsWebVirtualDir&#8221;); //exception here The exception was as follows:&nbsp; [System.Runtime.InteropServices.COMException]&nbsp;{&#8220;Unknown error (0x80005000)&#8221;}&nbsp;System.Runtime.InteropServices.COMException Unknown error (0x80005000)&nbsp;&nbsp; at System.DirectoryServices.DirectoryEntry.Bind(Boolean throwIfFail)&nbsp;&nbsp; at System.DirectoryServices.DirectoryEntry.Bind()&nbsp;&nbsp; at System.DirectoryServices.DirectoryEntry.get_IsContainer()&nbsp;&nbsp; at System.DirectoryServices.DirectoryEntries.CheckIsContainer()&nbsp;&nbsp; at System.DirectoryServices.DirectoryEntries.Find(String name, String schemaClassName)&nbsp; &nbsp; The error code..." />
    
categories:
  - Uncategorized
tags:
  - ADSI
  - IIS 7
---
The following code worked fine on IIS 6 but when used on IIS it failed:

<font size=2>

System.DirectoryServices.</font><font color=#2b91af size=2><font color=#2b91af size=2>DirectoryEntry</font></font><font size=2> iisServer;  
iisServer = </font><font color=#0000ff size=2><font color=#0000ff size=2>new</font></font><font size=2> System.DirectoryServices.</font><font color=#2b91af size=2><font color=#2b91af size=2>DirectoryEntry</font></font><font size=2>(</font><font color=#a31515 size=2><font color=#a31515 size=2>&#8220;IIS://jsanders4/W3SVC/1&#8221;</font></font><font size=2>);  
System.DirectoryServices.</font><font color=#2b91af size=2><font color=#2b91af size=2>DirectoryEntry</font></font><font size=2> rootFolder = iisServer.Children.Find(</font><font color=#a31515 size=2><font color=#a31515 size=2>&#8220;Root&#8221;</font></font><font size=2>, </font><font color=#a31515 size=2><font color=#a31515 size=2>&#8220;IIsWebVirtualDir&#8221;</font></font><font size=2>); </font><font color=#008000 size=2><font color=#008000 size=2>//exception here</font></font>

The exception was as follows:&nbsp;

[System.Runtime.InteropServices.COMException]&nbsp;{&#8220;Unknown error (0x80005000)&#8221;}&nbsp;  
System.Runtime.InteropServices.COMException

Unknown error (0x80005000)  
&nbsp;&nbsp; at System.DirectoryServices.DirectoryEntry.Bind(Boolean throwIfFail)  
&nbsp;&nbsp; at System.DirectoryServices.DirectoryEntry.Bind()  
&nbsp;&nbsp; at System.DirectoryServices.DirectoryEntry.get_IsContainer()  
&nbsp;&nbsp; at System.DirectoryServices.DirectoryEntries.CheckIsContainer()  
&nbsp;&nbsp; at System.DirectoryServices.DirectoryEntries.Find(String name, String schemaC  
lassName)&nbsp;<p mce_keep="true">&nbsp;</p> 

The error code is not translated to&nbsp;anything.&nbsp; This indicates that the ADSI provider for&nbsp;<font color=#a31515>IIS://jsanders4/W3SVC/1 </font><font color=#000000>does not exist or it is inaccessible.</font>

Opening up IIS manager you can see that the webserver &#8216;jsanders4&#8217; is up and running and the primary website ID is indeed 1.&nbsp; The logical conclusion then is that the ADSI provider for IIS://jsanders4 must be the problem.

IIS 7 does not install an ADSI provider by default.&nbsp; You can enable it however as a Role Service for the IIS Web Server.&nbsp; You need to enable the _IIS 6 Metabase Compatiblity_ role service.&nbsp; Probably a better way to proceed is to change your code to use the WMI provider for IIS 7 <a href="http://msdn.microsoft.com/en-us/library/aa347459.aspx" mce_href="http://msdn.microsoft.com/en-us/library/aa347459.aspx">http://msdn.microsoft.com/en-us/library/aa347459.aspx</a><p mce_keep="true">After&nbsp;installing the 

_IIS 6 Metabase Compatiblity_ role service&nbsp;the error changed:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</p> <p mce_keep="true">[System.Runtime.InteropServices.COMException]&nbsp;{&#8220;Access is denied.\r\n&#8221;}&nbsp;System.Runtime.InteropServices.COMException  
ErrorCode&nbsp;0x80070005</p> <p mce_keep="true">Access is denied.</p> <p mce_keep="true">&nbsp;&nbsp; at System.DirectoryServices.DirectoryEntry.Bind(Boolean throwIfFail)  
&nbsp;&nbsp; at System.DirectoryServices.DirectoryEntry.Bind()  
&nbsp;&nbsp; at System.DirectoryServices.DirectoryEntry.get_IsContainer()  
&nbsp;&nbsp; at System.DirectoryServices.DirectoryEntries.CheckIsContainer()  
&nbsp;&nbsp; at System.DirectoryServices.DirectoryEntries.Find(String name, String schemaClassName)</p> <p mce_keep="true">This is because&nbsp;Windows Server 2008 is locked down with UAC.&nbsp; You need to run the program as&nbsp;Administrator to execute this program.&nbsp;Another alternative is to set the account that is running this program with the rights: Logon as a Service&#8221;/ &#8220;Logon as a Batch Job&#8221;</p> <p mce_keep="true">I hope this helps you!&nbsp; Let me know if you used it to solve an issue.</p>