---
id: 883
title: 'Understanding the New WinInet flag: INTERNET_COOKIE_HTTPONLY'
date: 2009-06-04T11:56:00-05:00
author: jsanders
layout: post
guid: http://jsandersblog.azurewebsites.net/2009/06/04/understanding-the-new-wininet-flag-internet_cookie_httponly/
permalink: /2009/06/04/understanding-the-new-wininet-flag-internet_cookie_httponly/
orig_url:
  - http://blogs.msdn.microsoft.com/b/jpsanders/archive/2009/06/04/understanding-the-new-wininet-flag-internet-cookie-httponly.aspx
  - http://blogs.msdn.microsoft.com/b/jpsanders/archive/2009/06/04/understanding-the-new-wininet-flag-internet-cookie-httponly.aspx
  - http://blogs.msdn.microsoft.com/b/jpsanders/archive/2009/06/04/understanding-the-new-wininet-flag-internet-cookie-httponly.aspx
  - http://blogs.msdn.microsoft.com/b/jpsanders/archive/2009/06/04/understanding-the-new-wininet-flag-internet-cookie-httponly.aspx
  - http://blogs.msdn.microsoft.com/b/jpsanders/archive/2009/06/04/understanding-the-new-wininet-flag-internet-cookie-httponly.aspx
  - http://blogs.msdn.microsoft.com/b/jpsanders/archive/2009/06/04/understanding-the-new-wininet-flag-internet-cookie-httponly.aspx
  - http://blogs.msdn.microsoft.com/b/jpsanders/archive/2009/06/04/understanding-the-new-wininet-flag-internet-cookie-httponly.aspx
  - http://blogs.msdn.microsoft.com/b/jpsanders/archive/2009/06/04/understanding-the-new-wininet-flag-internet-cookie-httponly.aspx
  - http://blogs.msdn.microsoft.com/b/jpsanders/archive/2009/06/04/understanding-the-new-wininet-flag-internet-cookie-httponly.aspx
  - http://blogs.msdn.microsoft.com/b/jpsanders/archive/2009/06/04/understanding-the-new-wininet-flag-internet-cookie-httponly.aspx
orig_site_id:
  - "8394"
  - "8394"
  - "8394"
  - "8394"
  - "8394"
  - "8394"
  - "8394"
  - "8394"
  - "8394"
  - "8394"
orig_post_id:
  - "9699873"
  - "9699873"
  - "9699873"
  - "9699873"
  - "9699873"
  - "9699873"
  - "9699873"
  - "9699873"
  - "9699873"
  - "9699873"
orig_parent_id:
  - "9699873"
  - "9699873"
  - "9699873"
  - "9699873"
  - "9699873"
  - "9699873"
  - "9699873"
  - "9699873"
  - "9699873"
  - "9699873"
orig_thread_id:
  - "659261"
  - "659261"
  - "659261"
  - "659261"
  - "659261"
  - "659261"
  - "659261"
  - "659261"
  - "659261"
  - "659261"
orig_application_key:
  - jpsanders
  - jpsanders
  - jpsanders
  - jpsanders
  - jpsanders
  - jpsanders
  - jpsanders
  - jpsanders
  - jpsanders
  - jpsanders
orig_post_author_id:
  - "65385"
  - "65385"
  - "65385"
  - "65385"
  - "65385"
  - "65385"
  - "65385"
  - "65385"
  - "65385"
  - "65385"
orig_post_author_username:
  - jpsanders
  - jpsanders
  - jpsanders
  - jpsanders
  - jpsanders
  - jpsanders
  - jpsanders
  - jpsanders
  - jpsanders
  - jpsanders
orig_post_author_created:
  - Jan 18 2007 01:34:53:000PM
  - Jan 18 2007 01:34:53:000PM
  - Jan 18 2007 01:34:53:000PM
  - Jan 18 2007 01:34:53:000PM
  - Jan 18 2007 01:34:53:000PM
  - Jan 18 2007 01:34:53:000PM
  - Jan 18 2007 01:34:53:000PM
  - Jan 18 2007 01:34:53:000PM
  - Jan 18 2007 01:34:53:000PM
  - Jan 18 2007 01:34:53:000PM
orig_is_approved:
  - "1"
  - "1"
  - "1"
  - "1"
  - "1"
  - "1"
  - "1"
  - "1"
  - "1"
  - "1"
orig_attachment_count:
  - "0"
  - "0"
  - "0"
  - "0"
  - "0"
  - "0"
  - "0"
  - "0"
  - "0"
  - "0"
orig_url_title:
  - http://blogs.msdn.com/b/jpsanders/archive/2009/06/04/understanding-the-new-wininet-flag-internet_cookie_httponly.aspx
  - http://blogs.msdn.com/b/jpsanders/archive/2009/06/04/understanding-the-new-wininet-flag-internet_cookie_httponly.aspx
  - http://blogs.msdn.com/b/jpsanders/archive/2009/06/04/understanding-the-new-wininet-flag-internet_cookie_httponly.aspx
  - http://blogs.msdn.com/b/jpsanders/archive/2009/06/04/understanding-the-new-wininet-flag-internet_cookie_httponly.aspx
  - http://blogs.msdn.com/b/jpsanders/archive/2009/06/04/understanding-the-new-wininet-flag-internet_cookie_httponly.aspx
  - http://blogs.msdn.com/b/jpsanders/archive/2009/06/04/understanding-the-new-wininet-flag-internet_cookie_httponly.aspx
  - http://blogs.msdn.com/b/jpsanders/archive/2009/06/04/understanding-the-new-wininet-flag-internet_cookie_httponly.aspx
  - http://blogs.msdn.com/b/jpsanders/archive/2009/06/04/understanding-the-new-wininet-flag-internet_cookie_httponly.aspx
  - http://blogs.msdn.com/b/jpsanders/archive/2009/06/04/understanding-the-new-wininet-flag-internet_cookie_httponly.aspx
  - http://blogs.msdn.com/b/jpsanders/archive/2009/06/04/understanding-the-new-wininet-flag-internet_cookie_httponly.aspx
opengraph_tags:
  - |
    <meta property="og:type" content="article" />
    <meta property="og:title" content="Understanding the New WinInet flag: INTERNET_COOKIE_HTTPONLY" />
    <meta property="og:url" content="https://blogs.msdn.microsoft.com/jpsanders/2009/06/04/understanding-the-new-wininet-flag-internet_cookie_httponly/" />
    <meta property="og:site_name" content="Http Client Protocol Issues (and other fun stuff I support)" />
    <meta property="og:description" content="There are a couple of new Cookie flags introduced with the Internet Explorer 8 WinInet.dll.&nbsp; The INTERNET_COOKIE_HTTPONLY flag allows you to read the HttpOnly cookies in your WinInet Code.&nbsp; This flag is documented here: http://msdn.microsoft.com/en-us/library/aa384714(VS.85).aspx.&nbsp; As always, I like to see examples of how this flag works! Here is a sample ASPX page to create..." />
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="Understanding the New WinInet flag: INTERNET_COOKIE_HTTPONLY" />
    <meta name="twitter:url" content="https://blogs.msdn.microsoft.com/jpsanders/2009/06/04/understanding-the-new-wininet-flag-internet_cookie_httponly/" />
    <meta name="twitter:description" content="There are a couple of new Cookie flags introduced with the Internet Explorer 8 WinInet.dll.&nbsp; The INTERNET_COOKIE_HTTPONLY flag allows you to read the HttpOnly cookies in your WinInet Code.&nbsp; This flag is documented here: http://msdn.microsoft.com/en-us/library/aa384714(VS.85).aspx.&nbsp; As always, I like to see examples of how this flag works! Here is a sample ASPX page to create..." />
    
  - |
    <meta property="og:type" content="article" />
    <meta property="og:title" content="Understanding the New WinInet flag: INTERNET_COOKIE_HTTPONLY" />
    <meta property="og:url" content="https://blogs.msdn.microsoft.com/jpsanders/2009/06/04/understanding-the-new-wininet-flag-internet_cookie_httponly/" />
    <meta property="og:site_name" content="Http Client Protocol Issues (and other fun stuff I support)" />
    <meta property="og:description" content="There are a couple of new Cookie flags introduced with the Internet Explorer 8 WinInet.dll.&nbsp; The INTERNET_COOKIE_HTTPONLY flag allows you to read the HttpOnly cookies in your WinInet Code.&nbsp; This flag is documented here: http://msdn.microsoft.com/en-us/library/aa384714(VS.85).aspx.&nbsp; As always, I like to see examples of how this flag works! Here is a sample ASPX page to create..." />
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="Understanding the New WinInet flag: INTERNET_COOKIE_HTTPONLY" />
    <meta name="twitter:url" content="https://blogs.msdn.microsoft.com/jpsanders/2009/06/04/understanding-the-new-wininet-flag-internet_cookie_httponly/" />
    <meta name="twitter:description" content="There are a couple of new Cookie flags introduced with the Internet Explorer 8 WinInet.dll.&nbsp; The INTERNET_COOKIE_HTTPONLY flag allows you to read the HttpOnly cookies in your WinInet Code.&nbsp; This flag is documented here: http://msdn.microsoft.com/en-us/library/aa384714(VS.85).aspx.&nbsp; As always, I like to see examples of how this flag works! Here is a sample ASPX page to create..." />
    
  - |
    <meta property="og:type" content="article" />
    <meta property="og:title" content="Understanding the New WinInet flag: INTERNET_COOKIE_HTTPONLY" />
    <meta property="og:url" content="https://blogs.msdn.microsoft.com/jpsanders/2009/06/04/understanding-the-new-wininet-flag-internet_cookie_httponly/" />
    <meta property="og:site_name" content="Http Client Protocol Issues (and other fun stuff I support)" />
    <meta property="og:description" content="There are a couple of new Cookie flags introduced with the Internet Explorer 8 WinInet.dll.&nbsp; The INTERNET_COOKIE_HTTPONLY flag allows you to read the HttpOnly cookies in your WinInet Code.&nbsp; This flag is documented here: http://msdn.microsoft.com/en-us/library/aa384714(VS.85).aspx.&nbsp; As always, I like to see examples of how this flag works! Here is a sample ASPX page to create..." />
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="Understanding the New WinInet flag: INTERNET_COOKIE_HTTPONLY" />
    <meta name="twitter:url" content="https://blogs.msdn.microsoft.com/jpsanders/2009/06/04/understanding-the-new-wininet-flag-internet_cookie_httponly/" />
    <meta name="twitter:description" content="There are a couple of new Cookie flags introduced with the Internet Explorer 8 WinInet.dll.&nbsp; The INTERNET_COOKIE_HTTPONLY flag allows you to read the HttpOnly cookies in your WinInet Code.&nbsp; This flag is documented here: http://msdn.microsoft.com/en-us/library/aa384714(VS.85).aspx.&nbsp; As always, I like to see examples of how this flag works! Here is a sample ASPX page to create..." />
    
  - |
    <meta property="og:type" content="article" />
    <meta property="og:title" content="Understanding the New WinInet flag: INTERNET_COOKIE_HTTPONLY" />
    <meta property="og:url" content="https://blogs.msdn.microsoft.com/jpsanders/2009/06/04/understanding-the-new-wininet-flag-internet_cookie_httponly/" />
    <meta property="og:site_name" content="Http Client Protocol Issues (and other fun stuff I support)" />
    <meta property="og:description" content="There are a couple of new Cookie flags introduced with the Internet Explorer 8 WinInet.dll.&nbsp; The INTERNET_COOKIE_HTTPONLY flag allows you to read the HttpOnly cookies in your WinInet Code.&nbsp; This flag is documented here: http://msdn.microsoft.com/en-us/library/aa384714(VS.85).aspx.&nbsp; As always, I like to see examples of how this flag works! Here is a sample ASPX page to create..." />
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="Understanding the New WinInet flag: INTERNET_COOKIE_HTTPONLY" />
    <meta name="twitter:url" content="https://blogs.msdn.microsoft.com/jpsanders/2009/06/04/understanding-the-new-wininet-flag-internet_cookie_httponly/" />
    <meta name="twitter:description" content="There are a couple of new Cookie flags introduced with the Internet Explorer 8 WinInet.dll.&nbsp; The INTERNET_COOKIE_HTTPONLY flag allows you to read the HttpOnly cookies in your WinInet Code.&nbsp; This flag is documented here: http://msdn.microsoft.com/en-us/library/aa384714(VS.85).aspx.&nbsp; As always, I like to see examples of how this flag works! Here is a sample ASPX page to create..." />
    
  - |
    <meta property="og:type" content="article" />
    <meta property="og:title" content="Understanding the New WinInet flag: INTERNET_COOKIE_HTTPONLY" />
    <meta property="og:url" content="https://blogs.msdn.microsoft.com/jpsanders/2009/06/04/understanding-the-new-wininet-flag-internet_cookie_httponly/" />
    <meta property="og:site_name" content="Http Client Protocol Issues (and other fun stuff I support)" />
    <meta property="og:description" content="There are a couple of new Cookie flags introduced with the Internet Explorer 8 WinInet.dll.&nbsp; The INTERNET_COOKIE_HTTPONLY flag allows you to read the HttpOnly cookies in your WinInet Code.&nbsp; This flag is documented here: http://msdn.microsoft.com/en-us/library/aa384714(VS.85).aspx.&nbsp; As always, I like to see examples of how this flag works! Here is a sample ASPX page to create..." />
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="Understanding the New WinInet flag: INTERNET_COOKIE_HTTPONLY" />
    <meta name="twitter:url" content="https://blogs.msdn.microsoft.com/jpsanders/2009/06/04/understanding-the-new-wininet-flag-internet_cookie_httponly/" />
    <meta name="twitter:description" content="There are a couple of new Cookie flags introduced with the Internet Explorer 8 WinInet.dll.&nbsp; The INTERNET_COOKIE_HTTPONLY flag allows you to read the HttpOnly cookies in your WinInet Code.&nbsp; This flag is documented here: http://msdn.microsoft.com/en-us/library/aa384714(VS.85).aspx.&nbsp; As always, I like to see examples of how this flag works! Here is a sample ASPX page to create..." />
    
  - |
    <meta property="og:type" content="article" />
    <meta property="og:title" content="Understanding the New WinInet flag: INTERNET_COOKIE_HTTPONLY" />
    <meta property="og:url" content="https://blogs.msdn.microsoft.com/jpsanders/2009/06/04/understanding-the-new-wininet-flag-internet_cookie_httponly/" />
    <meta property="og:site_name" content="Http Client Protocol Issues (and other fun stuff I support)" />
    <meta property="og:description" content="There are a couple of new Cookie flags introduced with the Internet Explorer 8 WinInet.dll.&nbsp; The INTERNET_COOKIE_HTTPONLY flag allows you to read the HttpOnly cookies in your WinInet Code.&nbsp; This flag is documented here: http://msdn.microsoft.com/en-us/library/aa384714(VS.85).aspx.&nbsp; As always, I like to see examples of how this flag works! Here is a sample ASPX page to create..." />
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="Understanding the New WinInet flag: INTERNET_COOKIE_HTTPONLY" />
    <meta name="twitter:url" content="https://blogs.msdn.microsoft.com/jpsanders/2009/06/04/understanding-the-new-wininet-flag-internet_cookie_httponly/" />
    <meta name="twitter:description" content="There are a couple of new Cookie flags introduced with the Internet Explorer 8 WinInet.dll.&nbsp; The INTERNET_COOKIE_HTTPONLY flag allows you to read the HttpOnly cookies in your WinInet Code.&nbsp; This flag is documented here: http://msdn.microsoft.com/en-us/library/aa384714(VS.85).aspx.&nbsp; As always, I like to see examples of how this flag works! Here is a sample ASPX page to create..." />
    
  - |
    <meta property="og:type" content="article" />
    <meta property="og:title" content="Understanding the New WinInet flag: INTERNET_COOKIE_HTTPONLY" />
    <meta property="og:url" content="https://blogs.msdn.microsoft.com/jpsanders/2009/06/04/understanding-the-new-wininet-flag-internet_cookie_httponly/" />
    <meta property="og:site_name" content="Http Client Protocol Issues (and other fun stuff I support)" />
    <meta property="og:description" content="There are a couple of new Cookie flags introduced with the Internet Explorer 8 WinInet.dll.&nbsp; The INTERNET_COOKIE_HTTPONLY flag allows you to read the HttpOnly cookies in your WinInet Code.&nbsp; This flag is documented here: http://msdn.microsoft.com/en-us/library/aa384714(VS.85).aspx.&nbsp; As always, I like to see examples of how this flag works! Here is a sample ASPX page to create..." />
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="Understanding the New WinInet flag: INTERNET_COOKIE_HTTPONLY" />
    <meta name="twitter:url" content="https://blogs.msdn.microsoft.com/jpsanders/2009/06/04/understanding-the-new-wininet-flag-internet_cookie_httponly/" />
    <meta name="twitter:description" content="There are a couple of new Cookie flags introduced with the Internet Explorer 8 WinInet.dll.&nbsp; The INTERNET_COOKIE_HTTPONLY flag allows you to read the HttpOnly cookies in your WinInet Code.&nbsp; This flag is documented here: http://msdn.microsoft.com/en-us/library/aa384714(VS.85).aspx.&nbsp; As always, I like to see examples of how this flag works! Here is a sample ASPX page to create..." />
    
  - |
    <meta property="og:type" content="article" />
    <meta property="og:title" content="Understanding the New WinInet flag: INTERNET_COOKIE_HTTPONLY" />
    <meta property="og:url" content="https://blogs.msdn.microsoft.com/jpsanders/2009/06/04/understanding-the-new-wininet-flag-internet_cookie_httponly/" />
    <meta property="og:site_name" content="Http Client Protocol Issues (and other fun stuff I support)" />
    <meta property="og:description" content="There are a couple of new Cookie flags introduced with the Internet Explorer 8 WinInet.dll.&nbsp; The INTERNET_COOKIE_HTTPONLY flag allows you to read the HttpOnly cookies in your WinInet Code.&nbsp; This flag is documented here: http://msdn.microsoft.com/en-us/library/aa384714(VS.85).aspx.&nbsp; As always, I like to see examples of how this flag works! Here is a sample ASPX page to create..." />
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="Understanding the New WinInet flag: INTERNET_COOKIE_HTTPONLY" />
    <meta name="twitter:url" content="https://blogs.msdn.microsoft.com/jpsanders/2009/06/04/understanding-the-new-wininet-flag-internet_cookie_httponly/" />
    <meta name="twitter:description" content="There are a couple of new Cookie flags introduced with the Internet Explorer 8 WinInet.dll.&nbsp; The INTERNET_COOKIE_HTTPONLY flag allows you to read the HttpOnly cookies in your WinInet Code.&nbsp; This flag is documented here: http://msdn.microsoft.com/en-us/library/aa384714(VS.85).aspx.&nbsp; As always, I like to see examples of how this flag works! Here is a sample ASPX page to create..." />
    
  - |
    <meta property="og:type" content="article" />
    <meta property="og:title" content="Understanding the New WinInet flag: INTERNET_COOKIE_HTTPONLY" />
    <meta property="og:url" content="https://blogs.msdn.microsoft.com/jpsanders/2009/06/04/understanding-the-new-wininet-flag-internet_cookie_httponly/" />
    <meta property="og:site_name" content="Http Client Protocol Issues (and other fun stuff I support)" />
    <meta property="og:description" content="There are a couple of new Cookie flags introduced with the Internet Explorer 8 WinInet.dll.&nbsp; The INTERNET_COOKIE_HTTPONLY flag allows you to read the HttpOnly cookies in your WinInet Code.&nbsp; This flag is documented here: http://msdn.microsoft.com/en-us/library/aa384714(VS.85).aspx.&nbsp; As always, I like to see examples of how this flag works! Here is a sample ASPX page to create..." />
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="Understanding the New WinInet flag: INTERNET_COOKIE_HTTPONLY" />
    <meta name="twitter:url" content="https://blogs.msdn.microsoft.com/jpsanders/2009/06/04/understanding-the-new-wininet-flag-internet_cookie_httponly/" />
    <meta name="twitter:description" content="There are a couple of new Cookie flags introduced with the Internet Explorer 8 WinInet.dll.&nbsp; The INTERNET_COOKIE_HTTPONLY flag allows you to read the HttpOnly cookies in your WinInet Code.&nbsp; This flag is documented here: http://msdn.microsoft.com/en-us/library/aa384714(VS.85).aspx.&nbsp; As always, I like to see examples of how this flag works! Here is a sample ASPX page to create..." />
    
  - |
    <meta property="og:type" content="article" />
    <meta property="og:title" content="Understanding the New WinInet flag: INTERNET_COOKIE_HTTPONLY" />
    <meta property="og:url" content="https://blogs.msdn.microsoft.com/jpsanders/2009/06/04/understanding-the-new-wininet-flag-internet_cookie_httponly/" />
    <meta property="og:site_name" content="Http Client Protocol Issues (and other fun stuff I support)" />
    <meta property="og:description" content="There are a couple of new Cookie flags introduced with the Internet Explorer 8 WinInet.dll.&nbsp; The INTERNET_COOKIE_HTTPONLY flag allows you to read the HttpOnly cookies in your WinInet Code.&nbsp; This flag is documented here: http://msdn.microsoft.com/en-us/library/aa384714(VS.85).aspx.&nbsp; As always, I like to see examples of how this flag works! Here is a sample ASPX page to create..." />
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="Understanding the New WinInet flag: INTERNET_COOKIE_HTTPONLY" />
    <meta name="twitter:url" content="https://blogs.msdn.microsoft.com/jpsanders/2009/06/04/understanding-the-new-wininet-flag-internet_cookie_httponly/" />
    <meta name="twitter:description" content="There are a couple of new Cookie flags introduced with the Internet Explorer 8 WinInet.dll.&nbsp; The INTERNET_COOKIE_HTTPONLY flag allows you to read the HttpOnly cookies in your WinInet Code.&nbsp; This flag is documented here: http://msdn.microsoft.com/en-us/library/aa384714(VS.85).aspx.&nbsp; As always, I like to see examples of how this flag works! Here is a sample ASPX page to create..." />
    
categories:
  - Uncategorized
tags:
  - IE 8
  - WinInet
---
There are a couple of new Cookie flags introduced with the Internet Explorer 8 WinInet.dll.&nbsp; The INTERNET\_COOKIE\_HTTPONLY flag allows you to read the HttpOnly cookies in your WinInet Code.&nbsp; This flag is documented here: <a href="http://msdn.microsoft.com/en-us/library/aa384714(VS.85).aspx" mce_href="http://msdn.microsoft.com/en-us/library/aa384714(VS.85).aspx">http://msdn.microsoft.com/en-us/library/aa384714(VS.85).aspx</a>.&nbsp; As always, I like to see examples of how this flag works!

Here is a sample ASPX page to create some standard and httponly cookies:

**aspx code listing&nbsp;for sample&nbsp;([Copy Code](javascript:CopyCode('httponlycookiesection1');)):**<div style="BACKGROUND-COLOR: #e0e0e0" id=httponlycookiesection1> 

<%@ Page Language=&#8221;C#&#8221; %>

<!DOCTYPE html PUBLIC &#8220;-//W3C//DTD XHTML 1.0 Transitional//EN&#8221;  
&nbsp;&nbsp;&nbsp; &#8220;<a href="http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd" mce_href="http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd</a>&#8220;>  
<script runat=&#8221;server&#8221;>  
&nbsp;&nbsp;&nbsp; void Page_Load(object sender, EventArgs e)  
&nbsp;&nbsp;&nbsp; {  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // Create a new HttpCookie.  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; HttpCookie myHttpCookie = new HttpCookie(&#8220;LastVisit&#8221;, &#8220;sometime&#8221;);  
&nbsp;myHttpCookie.Expires = DateTime.Now.AddYears(1);

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // By default, the HttpOnly property is set to false  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // unless specified otherwise in configuration.

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; myHttpCookie.Name = &#8220;MyHttpCookie&#8221;;  
&nbsp;myHttpCookie.Path = &#8220;/&#8221;;  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Response.AppendCookie(myHttpCookie);

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // Show the name of the cookie.  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Response.Write(myHttpCookie.Name);

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // Create an HttpOnly cookie.  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; HttpCookie myHttpOnlyCookie = new HttpCookie(&#8220;LastVisit&#8221;, &#8220;sometime later&#8221;);

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // Setting the HttpOnly value to true, makes  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // this cookie accessible only to ASP.NET.

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; myHttpOnlyCookie.HttpOnly = true;  
&nbsp;myHttpCookie.Expires = DateTime.Now.AddYears(1);  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; myHttpOnlyCookie.Name = &#8220;MyHttpOnlyCookie&#8221;;  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Response.AppendCookie(myHttpOnlyCookie);

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // Show the name of the HttpOnly cookie.  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Response.Write(myHttpOnlyCookie.Name);  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Response.Write(&#8220;jeff&#8221;);  
&nbsp;&nbsp;&nbsp; }  
</script>

<html&nbsp; >  
<head runat=&#8221;server&#8221;>  
&nbsp;&nbsp;&nbsp; <title>ASP.NET Example</title>  
</head>  
<body>  
<script type=&#8221;text/javascript&#8221;>  
function getCookie(NameOfCookie)  
{  
&nbsp;&nbsp;&nbsp; if (document.cookie.length > 0)  
{  
&nbsp;&nbsp;&nbsp; begin = document.cookie.indexOf(NameOfCookie+&#8221;=&#8221;);  
&nbsp;&nbsp;&nbsp; if (begin != -1)  
&nbsp;&nbsp; {  
&nbsp;&nbsp;&nbsp; begin += NameOfCookie.length+1;  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; end = document.cookie.indexOf(&#8220;;&#8221;, begin);  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (end == -1) end = document.cookie.length;  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return unescape(document.cookie.substring(begin, end));&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }  
&nbsp; }  
return null;&nbsp;  
}  
</script>

<script type=&#8221;text/javascript&#8221;>

&nbsp;&nbsp;&nbsp; // This code returns the cookie name.  
&nbsp;&nbsp;&nbsp; alert(&#8220;Getting HTTP Cookie&#8221;);  
&nbsp;&nbsp;&nbsp; alert(getCookie(&#8220;MyHttpCookie&#8221;));

&nbsp;&nbsp;&nbsp; // Because the cookie is set to HttpOnly,  
&nbsp;&nbsp;&nbsp; // this returns null.  
&nbsp;&nbsp;&nbsp; alert(&#8220;Getting HTTP Only Cookie&#8221;);  
&nbsp;&nbsp;&nbsp; alert(getCookie(&#8220;MyHttpOnlyCookie&#8221;));

</script> 

</body>  
</html></div> 

When you run this page you will note InternetExplorer jscript will not allow you to read&nbsp;the value of&nbsp;MyHttpOnlyCookie.&nbsp; This new flag will&nbsp;allow you to read that cookie from code however!

To investigate this I decided to use my favorite sample &#8216;httpauth&#8217; from the Platform SDK.&nbsp; 

I added this code to the end of the function, just before closing the handles (note the empty error conditions that you need to fill in):

**C++ code listing&nbsp;for sample&nbsp;([Copy Code](javascript:CopyCode('httponlycookiesection2');)):**<div style="BACKGROUND-COLOR: #e0e0e0" id=httponlycookiesection2><font size=2></p> 

fprintf (stderr, </font><font color=#a31515 size=2><font color=#a31515 size=2>&#8220;\n&#8221;</font></font><font size=2>);  
</font><font color=#0000ff size=2><font color=#0000ff size=2>char</font></font><font size=2> szCookieBuf[512];  
DWORD ccCookieBufSize=512;  
DWORD dwErr=0;

</font><font color=#0000ff size=2><font color=#0000ff size=2>if</font></font><font size=2> (!InternetGetCookieEx(</font><font color=#a31515 size=2><font color=#a31515 size=2>&#8220;http://jsanders4/&#8221;</font></font><font size=2>,</font><font color=#a31515 size=2><font color=#a31515 size=2>&#8220;MyHttpCookie&#8221;</font></font><font size=2>,szCookieBuf,&ccCookieBufSize,0,NULL))  
{

&nbsp;&nbsp;&nbsp; dwErr=GetLastError();  
&nbsp;&nbsp;&nbsp; </font><font color=#0000ff size=2><font color=#0000ff size=2>switch</font></font><font size=2> (dwErr)  
&nbsp;&nbsp;&nbsp; {

</font><font color=#0000ff size=2><font color=#0000ff size=2>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; case</font></font><font size=2> ERROR\_INSUFFICIENT\_BUFFER:  
</font><font color=#0000ff size=2><font color=#0000ff size=2>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; break</font></font><font size=2>;

</font><font color=#0000ff size=2><font color=#0000ff size=2>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; case</font></font><font size=2> ERROR\_NO\_MORE_ITEMS:  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font><font color=#0000ff size=2><font color=#0000ff size=2>break</font></font><font size=2>;

</font><font color=#0000ff size=2><font color=#0000ff size=2>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; default</font></font><font size=2>:  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font><font color=#0000ff size=2><font color=#0000ff size=2>break</font></font><font size=2>;

&nbsp;&nbsp;&nbsp; };

}  
</font><font color=#0000ff size=2><font color=#0000ff size=2>else  
</font></font><font size=2>{  
&nbsp;&nbsp;&nbsp; fprintf (stderr, </font><font color=#a31515 size=2><font color=#a31515 size=2>&#8220;Cookie found: %s\n&#8221;</font></font><font size=2>, szCookieBuf);  
}

ccCookieBufSize=512;

</font><font color=#0000ff size=2><font color=#0000ff size=2>if</font></font><font size=2> (!InternetGetCookieEx(</font><font color=#a31515 size=2><font color=#a31515 size=2>&#8220;http://jsanders4/&#8221;</font></font><font size=2>,</font><font color=#a31515 size=2><font color=#a31515 size=2>&#8220;MyHttpOnlyCookie&#8221;</font></font><font size=2>,szCookieBuf,&ccCookieBufSize,INTERNET\_COOKIE\_HTTPONLY,NULL))  
{

&nbsp;&nbsp;&nbsp; dwErr=GetLastError();  
&nbsp;&nbsp;&nbsp; <font color=#0000ff size=2><font color=#0000ff size=2>switch</font></font><font size=2> (dwErr)  
&nbsp;&nbsp;&nbsp; {

</font><font color=#0000ff size=2><font color=#0000ff size=2>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; case</font></font><font size=2> ERROR\_INSUFFICIENT\_BUFFER:  
</font><font color=#0000ff size=2><font color=#0000ff size=2>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; break</font></font><font size=2>;

</font><font color=#0000ff size=2><font color=#0000ff size=2>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; case</font></font><font size=2> ERROR\_NO\_MORE_ITEMS:  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font><font color=#0000ff size=2><font color=#0000ff size=2>break</font></font><font size=2>;

</font><font color=#0000ff size=2><font color=#0000ff size=2>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; default</font></font><font size=2>:  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font><font color=#0000ff size=2><font color=#0000ff size=2>break</font></font><font size=2>;

&nbsp;&nbsp;&nbsp; };

</font></font><font size=2>

}  
</font><font color=#0000ff size=2><font color=#0000ff size=2>else  
</font></font><font size=2>{  
&nbsp;&nbsp;&nbsp; fprintf (stderr, </font><font color=#a31515 size=2><font color=#a31515 size=2>&#8220;Cookie found: %s\n&#8221;</font></font><font size=2>, szCookieBuf);  
}

</font></div> <p mce_keep="true">I put the page to write the cookies on one of my servers and pointed the httpauth.exe to that page.&nbsp; This code works fine and does read the HttpOnly cookie.&nbsp; Try and remove the flag and you will see the call fail!<p mce_keep="true">Let me know if this was&nbsp;a help to you!</p>