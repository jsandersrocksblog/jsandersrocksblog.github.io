---
id: 1083
title: Create a script for DebugDiag to analyze Managed WebExceptions
date: 2008-12-19T16:14:00-05:00
author: jsanders
layout: post
guid: http://jsandersblog.azurewebsites.net/2008/12/19/create-a-script-for-debugdiag-to-analyze-managed-webexceptions/
permalink: /2008/12/19/create-a-script-for-debugdiag-to-analyze-managed-webexceptions/
orig_url:
  - http://blogs.msdn.microsoft.com/b/jpsanders/archive/2008/12/19/create-a-script-for-debugdiag-to-analyze-managed-webexceptions.aspx
  - http://blogs.msdn.microsoft.com/b/jpsanders/archive/2008/12/19/create-a-script-for-debugdiag-to-analyze-managed-webexceptions.aspx
  - http://blogs.msdn.microsoft.com/b/jpsanders/archive/2008/12/19/create-a-script-for-debugdiag-to-analyze-managed-webexceptions.aspx
  - http://blogs.msdn.microsoft.com/b/jpsanders/archive/2008/12/19/create-a-script-for-debugdiag-to-analyze-managed-webexceptions.aspx
  - http://blogs.msdn.microsoft.com/b/jpsanders/archive/2008/12/19/create-a-script-for-debugdiag-to-analyze-managed-webexceptions.aspx
  - http://blogs.msdn.microsoft.com/b/jpsanders/archive/2008/12/19/create-a-script-for-debugdiag-to-analyze-managed-webexceptions.aspx
  - http://blogs.msdn.microsoft.com/b/jpsanders/archive/2008/12/19/create-a-script-for-debugdiag-to-analyze-managed-webexceptions.aspx
  - http://blogs.msdn.microsoft.com/b/jpsanders/archive/2008/12/19/create-a-script-for-debugdiag-to-analyze-managed-webexceptions.aspx
  - http://blogs.msdn.microsoft.com/b/jpsanders/archive/2008/12/19/create-a-script-for-debugdiag-to-analyze-managed-webexceptions.aspx
  - http://blogs.msdn.microsoft.com/b/jpsanders/archive/2008/12/19/create-a-script-for-debugdiag-to-analyze-managed-webexceptions.aspx
orig_site_id:
  - "8394"
  - "8394"
  - "8394"
  - "8394"
  - "8394"
  - "8394"
  - "8394"
  - "8394"
  - "8394"
  - "8394"
orig_post_id:
  - "9242878"
  - "9242878"
  - "9242878"
  - "9242878"
  - "9242878"
  - "9242878"
  - "9242878"
  - "9242878"
  - "9242878"
  - "9242878"
orig_parent_id:
  - "9242878"
  - "9242878"
  - "9242878"
  - "9242878"
  - "9242878"
  - "9242878"
  - "9242878"
  - "9242878"
  - "9242878"
  - "9242878"
orig_thread_id:
  - "625756"
  - "625756"
  - "625756"
  - "625756"
  - "625756"
  - "625756"
  - "625756"
  - "625756"
  - "625756"
  - "625756"
orig_application_key:
  - jpsanders
  - jpsanders
  - jpsanders
  - jpsanders
  - jpsanders
  - jpsanders
  - jpsanders
  - jpsanders
  - jpsanders
  - jpsanders
orig_post_author_id:
  - "65385"
  - "65385"
  - "65385"
  - "65385"
  - "65385"
  - "65385"
  - "65385"
  - "65385"
  - "65385"
  - "65385"
orig_post_author_username:
  - jpsanders
  - jpsanders
  - jpsanders
  - jpsanders
  - jpsanders
  - jpsanders
  - jpsanders
  - jpsanders
  - jpsanders
  - jpsanders
orig_post_author_created:
  - Jan 18 2007 01:34:53:000PM
  - Jan 18 2007 01:34:53:000PM
  - Jan 18 2007 01:34:53:000PM
  - Jan 18 2007 01:34:53:000PM
  - Jan 18 2007 01:34:53:000PM
  - Jan 18 2007 01:34:53:000PM
  - Jan 18 2007 01:34:53:000PM
  - Jan 18 2007 01:34:53:000PM
  - Jan 18 2007 01:34:53:000PM
  - Jan 18 2007 01:34:53:000PM
orig_is_approved:
  - "1"
  - "1"
  - "1"
  - "1"
  - "1"
  - "1"
  - "1"
  - "1"
  - "1"
  - "1"
orig_attachment_count:
  - "0"
  - "0"
  - "0"
  - "0"
  - "0"
  - "0"
  - "0"
  - "0"
  - "0"
  - "0"
orig_url_title:
  - http://blogs.msdn.com/b/jpsanders/archive/2008/12/19/create-a-script-for-debugdiag-to-analyze-managed-webexceptions.aspx
  - http://blogs.msdn.com/b/jpsanders/archive/2008/12/19/create-a-script-for-debugdiag-to-analyze-managed-webexceptions.aspx
  - http://blogs.msdn.com/b/jpsanders/archive/2008/12/19/create-a-script-for-debugdiag-to-analyze-managed-webexceptions.aspx
  - http://blogs.msdn.com/b/jpsanders/archive/2008/12/19/create-a-script-for-debugdiag-to-analyze-managed-webexceptions.aspx
  - http://blogs.msdn.com/b/jpsanders/archive/2008/12/19/create-a-script-for-debugdiag-to-analyze-managed-webexceptions.aspx
  - http://blogs.msdn.com/b/jpsanders/archive/2008/12/19/create-a-script-for-debugdiag-to-analyze-managed-webexceptions.aspx
  - http://blogs.msdn.com/b/jpsanders/archive/2008/12/19/create-a-script-for-debugdiag-to-analyze-managed-webexceptions.aspx
  - http://blogs.msdn.com/b/jpsanders/archive/2008/12/19/create-a-script-for-debugdiag-to-analyze-managed-webexceptions.aspx
  - http://blogs.msdn.com/b/jpsanders/archive/2008/12/19/create-a-script-for-debugdiag-to-analyze-managed-webexceptions.aspx
  - http://blogs.msdn.com/b/jpsanders/archive/2008/12/19/create-a-script-for-debugdiag-to-analyze-managed-webexceptions.aspx
opengraph_tags:
  - |
    <meta property="og:type" content="article" />
    <meta property="og:title" content="Create a script for DebugDiag to analyze Managed WebExceptions" />
    <meta property="og:url" content="https://blogs.msdn.microsoft.com/jpsanders/2008/12/19/create-a-script-for-debugdiag-to-analyze-managed-webexceptions/" />
    <meta property="og:site_name" content="Http Client Protocol Issues (and other fun stuff I support)" />
    <meta property="og:description" content="DebugDiag was originally designed to help IIS engineers find issues in IIS.&nbsp; It does not have a very rich experience however when analyzing Managed Exceptions.&nbsp; I will show you how to modify some existing scripts and use then to analyze issues with the HttpWebRequest class. First copy the existing script CrashHangAnalysis.asp to a file in..." />
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="Create a script for DebugDiag to analyze Managed WebExceptions" />
    <meta name="twitter:url" content="https://blogs.msdn.microsoft.com/jpsanders/2008/12/19/create-a-script-for-debugdiag-to-analyze-managed-webexceptions/" />
    <meta name="twitter:description" content="DebugDiag was originally designed to help IIS engineers find issues in IIS.&nbsp; It does not have a very rich experience however when analyzing Managed Exceptions.&nbsp; I will show you how to modify some existing scripts and use then to analyze issues with the HttpWebRequest class. First copy the existing script CrashHangAnalysis.asp to a file in..." />
    
  - |
    <meta property="og:type" content="article" />
    <meta property="og:title" content="Create a script for DebugDiag to analyze Managed WebExceptions" />
    <meta property="og:url" content="https://blogs.msdn.microsoft.com/jpsanders/2008/12/19/create-a-script-for-debugdiag-to-analyze-managed-webexceptions/" />
    <meta property="og:site_name" content="Http Client Protocol Issues (and other fun stuff I support)" />
    <meta property="og:description" content="DebugDiag was originally designed to help IIS engineers find issues in IIS.&nbsp; It does not have a very rich experience however when analyzing Managed Exceptions.&nbsp; I will show you how to modify some existing scripts and use then to analyze issues with the HttpWebRequest class. First copy the existing script CrashHangAnalysis.asp to a file in..." />
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="Create a script for DebugDiag to analyze Managed WebExceptions" />
    <meta name="twitter:url" content="https://blogs.msdn.microsoft.com/jpsanders/2008/12/19/create-a-script-for-debugdiag-to-analyze-managed-webexceptions/" />
    <meta name="twitter:description" content="DebugDiag was originally designed to help IIS engineers find issues in IIS.&nbsp; It does not have a very rich experience however when analyzing Managed Exceptions.&nbsp; I will show you how to modify some existing scripts and use then to analyze issues with the HttpWebRequest class. First copy the existing script CrashHangAnalysis.asp to a file in..." />
    
  - |
    <meta property="og:type" content="article" />
    <meta property="og:title" content="Create a script for DebugDiag to analyze Managed WebExceptions" />
    <meta property="og:url" content="https://blogs.msdn.microsoft.com/jpsanders/2008/12/19/create-a-script-for-debugdiag-to-analyze-managed-webexceptions/" />
    <meta property="og:site_name" content="Http Client Protocol Issues (and other fun stuff I support)" />
    <meta property="og:description" content="DebugDiag was originally designed to help IIS engineers find issues in IIS.&nbsp; It does not have a very rich experience however when analyzing Managed Exceptions.&nbsp; I will show you how to modify some existing scripts and use then to analyze issues with the HttpWebRequest class. First copy the existing script CrashHangAnalysis.asp to a file in..." />
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="Create a script for DebugDiag to analyze Managed WebExceptions" />
    <meta name="twitter:url" content="https://blogs.msdn.microsoft.com/jpsanders/2008/12/19/create-a-script-for-debugdiag-to-analyze-managed-webexceptions/" />
    <meta name="twitter:description" content="DebugDiag was originally designed to help IIS engineers find issues in IIS.&nbsp; It does not have a very rich experience however when analyzing Managed Exceptions.&nbsp; I will show you how to modify some existing scripts and use then to analyze issues with the HttpWebRequest class. First copy the existing script CrashHangAnalysis.asp to a file in..." />
    
  - |
    <meta property="og:type" content="article" />
    <meta property="og:title" content="Create a script for DebugDiag to analyze Managed WebExceptions" />
    <meta property="og:url" content="https://blogs.msdn.microsoft.com/jpsanders/2008/12/19/create-a-script-for-debugdiag-to-analyze-managed-webexceptions/" />
    <meta property="og:site_name" content="Http Client Protocol Issues (and other fun stuff I support)" />
    <meta property="og:description" content="DebugDiag was originally designed to help IIS engineers find issues in IIS.&nbsp; It does not have a very rich experience however when analyzing Managed Exceptions.&nbsp; I will show you how to modify some existing scripts and use then to analyze issues with the HttpWebRequest class. First copy the existing script CrashHangAnalysis.asp to a file in..." />
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="Create a script for DebugDiag to analyze Managed WebExceptions" />
    <meta name="twitter:url" content="https://blogs.msdn.microsoft.com/jpsanders/2008/12/19/create-a-script-for-debugdiag-to-analyze-managed-webexceptions/" />
    <meta name="twitter:description" content="DebugDiag was originally designed to help IIS engineers find issues in IIS.&nbsp; It does not have a very rich experience however when analyzing Managed Exceptions.&nbsp; I will show you how to modify some existing scripts and use then to analyze issues with the HttpWebRequest class. First copy the existing script CrashHangAnalysis.asp to a file in..." />
    
  - |
    <meta property="og:type" content="article" />
    <meta property="og:title" content="Create a script for DebugDiag to analyze Managed WebExceptions" />
    <meta property="og:url" content="https://blogs.msdn.microsoft.com/jpsanders/2008/12/19/create-a-script-for-debugdiag-to-analyze-managed-webexceptions/" />
    <meta property="og:site_name" content="Http Client Protocol Issues (and other fun stuff I support)" />
    <meta property="og:description" content="DebugDiag was originally designed to help IIS engineers find issues in IIS.&nbsp; It does not have a very rich experience however when analyzing Managed Exceptions.&nbsp; I will show you how to modify some existing scripts and use then to analyze issues with the HttpWebRequest class. First copy the existing script CrashHangAnalysis.asp to a file in..." />
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="Create a script for DebugDiag to analyze Managed WebExceptions" />
    <meta name="twitter:url" content="https://blogs.msdn.microsoft.com/jpsanders/2008/12/19/create-a-script-for-debugdiag-to-analyze-managed-webexceptions/" />
    <meta name="twitter:description" content="DebugDiag was originally designed to help IIS engineers find issues in IIS.&nbsp; It does not have a very rich experience however when analyzing Managed Exceptions.&nbsp; I will show you how to modify some existing scripts and use then to analyze issues with the HttpWebRequest class. First copy the existing script CrashHangAnalysis.asp to a file in..." />
    
  - |
    <meta property="og:type" content="article" />
    <meta property="og:title" content="Create a script for DebugDiag to analyze Managed WebExceptions" />
    <meta property="og:url" content="https://blogs.msdn.microsoft.com/jpsanders/2008/12/19/create-a-script-for-debugdiag-to-analyze-managed-webexceptions/" />
    <meta property="og:site_name" content="Http Client Protocol Issues (and other fun stuff I support)" />
    <meta property="og:description" content="DebugDiag was originally designed to help IIS engineers find issues in IIS.&nbsp; It does not have a very rich experience however when analyzing Managed Exceptions.&nbsp; I will show you how to modify some existing scripts and use then to analyze issues with the HttpWebRequest class. First copy the existing script CrashHangAnalysis.asp to a file in..." />
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="Create a script for DebugDiag to analyze Managed WebExceptions" />
    <meta name="twitter:url" content="https://blogs.msdn.microsoft.com/jpsanders/2008/12/19/create-a-script-for-debugdiag-to-analyze-managed-webexceptions/" />
    <meta name="twitter:description" content="DebugDiag was originally designed to help IIS engineers find issues in IIS.&nbsp; It does not have a very rich experience however when analyzing Managed Exceptions.&nbsp; I will show you how to modify some existing scripts and use then to analyze issues with the HttpWebRequest class. First copy the existing script CrashHangAnalysis.asp to a file in..." />
    
  - |
    <meta property="og:type" content="article" />
    <meta property="og:title" content="Create a script for DebugDiag to analyze Managed WebExceptions" />
    <meta property="og:url" content="https://blogs.msdn.microsoft.com/jpsanders/2008/12/19/create-a-script-for-debugdiag-to-analyze-managed-webexceptions/" />
    <meta property="og:site_name" content="Http Client Protocol Issues (and other fun stuff I support)" />
    <meta property="og:description" content="DebugDiag was originally designed to help IIS engineers find issues in IIS.&nbsp; It does not have a very rich experience however when analyzing Managed Exceptions.&nbsp; I will show you how to modify some existing scripts and use then to analyze issues with the HttpWebRequest class. First copy the existing script CrashHangAnalysis.asp to a file in..." />
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="Create a script for DebugDiag to analyze Managed WebExceptions" />
    <meta name="twitter:url" content="https://blogs.msdn.microsoft.com/jpsanders/2008/12/19/create-a-script-for-debugdiag-to-analyze-managed-webexceptions/" />
    <meta name="twitter:description" content="DebugDiag was originally designed to help IIS engineers find issues in IIS.&nbsp; It does not have a very rich experience however when analyzing Managed Exceptions.&nbsp; I will show you how to modify some existing scripts and use then to analyze issues with the HttpWebRequest class. First copy the existing script CrashHangAnalysis.asp to a file in..." />
    
  - |
    <meta property="og:type" content="article" />
    <meta property="og:title" content="Create a script for DebugDiag to analyze Managed WebExceptions" />
    <meta property="og:url" content="https://blogs.msdn.microsoft.com/jpsanders/2008/12/19/create-a-script-for-debugdiag-to-analyze-managed-webexceptions/" />
    <meta property="og:site_name" content="Http Client Protocol Issues (and other fun stuff I support)" />
    <meta property="og:description" content="DebugDiag was originally designed to help IIS engineers find issues in IIS.&nbsp; It does not have a very rich experience however when analyzing Managed Exceptions.&nbsp; I will show you how to modify some existing scripts and use then to analyze issues with the HttpWebRequest class. First copy the existing script CrashHangAnalysis.asp to a file in..." />
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="Create a script for DebugDiag to analyze Managed WebExceptions" />
    <meta name="twitter:url" content="https://blogs.msdn.microsoft.com/jpsanders/2008/12/19/create-a-script-for-debugdiag-to-analyze-managed-webexceptions/" />
    <meta name="twitter:description" content="DebugDiag was originally designed to help IIS engineers find issues in IIS.&nbsp; It does not have a very rich experience however when analyzing Managed Exceptions.&nbsp; I will show you how to modify some existing scripts and use then to analyze issues with the HttpWebRequest class. First copy the existing script CrashHangAnalysis.asp to a file in..." />
    
  - |
    <meta property="og:type" content="article" />
    <meta property="og:title" content="Create a script for DebugDiag to analyze Managed WebExceptions" />
    <meta property="og:url" content="https://blogs.msdn.microsoft.com/jpsanders/2008/12/19/create-a-script-for-debugdiag-to-analyze-managed-webexceptions/" />
    <meta property="og:site_name" content="Http Client Protocol Issues (and other fun stuff I support)" />
    <meta property="og:description" content="DebugDiag was originally designed to help IIS engineers find issues in IIS.&nbsp; It does not have a very rich experience however when analyzing Managed Exceptions.&nbsp; I will show you how to modify some existing scripts and use then to analyze issues with the HttpWebRequest class. First copy the existing script CrashHangAnalysis.asp to a file in..." />
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="Create a script for DebugDiag to analyze Managed WebExceptions" />
    <meta name="twitter:url" content="https://blogs.msdn.microsoft.com/jpsanders/2008/12/19/create-a-script-for-debugdiag-to-analyze-managed-webexceptions/" />
    <meta name="twitter:description" content="DebugDiag was originally designed to help IIS engineers find issues in IIS.&nbsp; It does not have a very rich experience however when analyzing Managed Exceptions.&nbsp; I will show you how to modify some existing scripts and use then to analyze issues with the HttpWebRequest class. First copy the existing script CrashHangAnalysis.asp to a file in..." />
    
  - |
    <meta property="og:type" content="article" />
    <meta property="og:title" content="Create a script for DebugDiag to analyze Managed WebExceptions" />
    <meta property="og:url" content="https://blogs.msdn.microsoft.com/jpsanders/2008/12/19/create-a-script-for-debugdiag-to-analyze-managed-webexceptions/" />
    <meta property="og:site_name" content="Http Client Protocol Issues (and other fun stuff I support)" />
    <meta property="og:description" content="DebugDiag was originally designed to help IIS engineers find issues in IIS.&nbsp; It does not have a very rich experience however when analyzing Managed Exceptions.&nbsp; I will show you how to modify some existing scripts and use then to analyze issues with the HttpWebRequest class. First copy the existing script CrashHangAnalysis.asp to a file in..." />
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="Create a script for DebugDiag to analyze Managed WebExceptions" />
    <meta name="twitter:url" content="https://blogs.msdn.microsoft.com/jpsanders/2008/12/19/create-a-script-for-debugdiag-to-analyze-managed-webexceptions/" />
    <meta name="twitter:description" content="DebugDiag was originally designed to help IIS engineers find issues in IIS.&nbsp; It does not have a very rich experience however when analyzing Managed Exceptions.&nbsp; I will show you how to modify some existing scripts and use then to analyze issues with the HttpWebRequest class. First copy the existing script CrashHangAnalysis.asp to a file in..." />
    
categories:
  - Uncategorized
tags:
  - DebugDiag
---
DebugDiag was originally designed to help IIS engineers find issues in IIS.&nbsp; It does not have a very rich experience however when analyzing Managed Exceptions.&nbsp; I will show you how to modify some existing scripts and use then to analyze issues with the HttpWebRequest class.

First copy the existing script CrashHangAnalysis.asp to a file in the same directory and call it HttpWebRequestCrash.asp.&nbsp; Next let’s make some modifications to call the new CLRAnalysis script we will develop.

Change the description to this: <%@ Description = Crash and hang analysis for .NET WebExceptions %>  
And then change this line: <!&#8211; #include File = &#8220;inc/AnalyzeCrash.asp&#8221; &#8211;>&nbsp; to point to the file we will create: <!&#8211; #include File = &#8220;inc/CLRAnalyzeCrash.asp&#8221; &#8211;>

Next Copy AnalyzeCrash.asp to our new file CLRAnalyzeCrash.asp.

Now the work begins.&nbsp; We will modify CLRAnalyzeCrash.asp to do some enhanced CLR analysis of WebExceptions.

This file already has a section to analyze CLR exceptions, but we want to modify it to go deep into WebExceptions.&nbsp; Find the function Sub AnalyzeClr(ByVal Exception, ByVal ExceptionThread, ByVal suppressSummary)

We will need some new variables so add these at the beginning of the function:

&nbsp;Dim CmdOutput  
&nbsp;Dim Lines  
&nbsp;Dim iStatus  
&nbsp;Dim pos  
&nbsp;Dim nextPE  
&nbsp;Dim theResponseAddr

Next we will modify the arguments passed to the function GetCLRExceptionType and modify the function itself.&nbsp; Find this function where it is called and change it to this:  
GetCLRExceptionType(GetCLRExceptionPtr(ExceptionThread), False, iStatus, theResponseAddr)

The iStatus and theResponseAddr variables will be added to return us more information about the exception.&nbsp; Next lets modify that function.

First change the signature: Function GetCLRExceptionType(ByVal ExceptionObjHexAddr, ByVal bInnerException, ByRef iStatus, ByRef theResponseAddr)

Then add this variable to the top of the function: Dim pos

Now we want to output a header if there is an inner exception, so change this code to write out ‘Inner’

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;If InStr(Lines(i), &#8220;_innerException&#8221;) <> 0 Then  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GetCLRExceptionType = GetCLRExceptionType(&#8220;0x&#8221; & Mid(Lines(i), 60, 8), False)  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Manager.Write &#8220;<br><h1>inner</h1></br>&#8221;  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exit For

Now change the outer exception code to get the status and response members (if they exist):

&nbsp;&nbsp;&nbsp;ElseIf Len(Lines(i)) >= 7 Then  
&nbsp;&nbsp;&nbsp;&nbsp;pos = InStr(Lines(i), &#8220;m_Status&#8221;)  
&nbsp;&nbsp;&nbsp;&nbsp;if pos >= 1 Then  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; iStatus = Mid(Lines(i), pos-9,8 )  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  
&nbsp;&nbsp;&nbsp;&nbsp;End If  
&nbsp;&nbsp;&nbsp;&nbsp;pos = InStr(Lines(i), &#8220;m_Response&#8221;)  
&nbsp;&nbsp;&nbsp;&nbsp;if pos >= 1 Then  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; theResponseAddr = Mid(Lines(i), pos-9,8 )  
&nbsp;&nbsp;&nbsp;&nbsp;End If

&nbsp;&nbsp;&nbsp;&nbsp;If InStr(Lines(i), &#8220;Name: &#8220;) =&nbsp;&nbsp; 1 Then  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GetCLRExceptionType = Mid(Lines(i), 7)  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  
&nbsp;&nbsp;&nbsp;&nbsp;End If  
&nbsp;&nbsp;&nbsp;End If

That should cover getting the variables, Status and Response, from the exception object, now back to the other function to do something with those variables.

The rest of the code in the previous function will make some decisions if this is a WebException and print out some possible resolutions.&nbsp; Finally it will dump the managed stack:

&nbsp;If ClrExceptionType <> &#8220;&#8221; Then  
&nbsp;&nbsp;&nbsp;&nbsp; Message = Message & &#8220;</b> has caused a <b>CLR Exception</b> of type <b>(<font color=&#8217;red&#8217;>&#8221; & ClrExceptionType & &#8220;</font>)</b>&#8221;  
&nbsp;&nbsp;&nbsp;&nbsp;  
&nbsp;&nbsp;&nbsp;&nbsp; If ClrExceptionType = &#8220;System.Net.WebException&#8221; Then  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &#8216;remove the vendor statement  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; pos = InStr( Recommendation,&#8221;Please follow up with vendor&#8221;)  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (pos<>0) then  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Recommendation = Mid(Recommendation, 1, pos-1)  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; end if  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &#8216;public enum WebExceptionStatus  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &#8216;{  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &#8216;&nbsp;&nbsp;&nbsp; Success, 0  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &#8216;&nbsp;&nbsp;&nbsp; NameResolutionFailure, 1  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &#8216;&nbsp;&nbsp;&nbsp; ConnectFailure, 2  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &#8216;&nbsp;&nbsp;&nbsp; ReceiveFailure, 3  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &#8216;&nbsp;&nbsp;&nbsp; SendFailure, 4  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &#8216;&nbsp;&nbsp;&nbsp; PipelineFailure, 5  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &#8216;&nbsp;&nbsp;&nbsp; RequestCanceled, 6  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &#8216;&nbsp;&nbsp;&nbsp; ProtocolError, 7  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &#8216;&nbsp;&nbsp;&nbsp; ConnectionClosed, 8  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &#8216;&nbsp;&nbsp;&nbsp; TrustFailure, 9  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &#8216;&nbsp;&nbsp;&nbsp; SecureChannelFailure, 10  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &#8216;&nbsp;&nbsp;&nbsp; ServerProtocolViolation, 11  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &#8216;&nbsp;&nbsp;&nbsp; KeepAliveFailure, 12  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &#8216;&nbsp;&nbsp;&nbsp; Pending, 13  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &#8216;&nbsp;&nbsp;&nbsp; Timeout, 14  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &#8216;&nbsp;&nbsp;&nbsp; ProxyNameResolutionFailure, 15  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &#8216;&nbsp;&nbsp;&nbsp; UnknownError, 16  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &#8216;&nbsp;&nbsp;&nbsp; MessageLengthLimitExceeded, 17  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &#8216;&nbsp;&nbsp;&nbsp; CacheEntryNotFound, 18  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &#8216;&nbsp;&nbsp;&nbsp; RequestProhibitedByCachePolicy, 19  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &#8216;&nbsp;&nbsp;&nbsp; RequestProhibitedByProxy 20  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &#8216;}  
&nbsp;  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Select Case CInt(iStatus)  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Case 1  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Recommendation = Recommendation &&#8221;<br><br> This is a DNS error.&nbsp; For some reason the server name cannot be resolved.&nbsp; Do you have permissions to the HOST file?&nbsp; Is this a service such as ASP.NET?&nbsp; See this article for help: <a target=&#8217;_blank&#8217; href=&#8217;http://support.microsoft.com/kb/318140&#8242;>The underlying connection was closed: The remote name could not be resolved.</a>&#8221;&nbsp;  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Case 2  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &#8216; &#8220;Unable to connect to the remote server&#8221;  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Recommendation = Recommendation &&#8221;<br><br> Lookup the error &#8216;Unable to connect to the remote server&#8217; here for a resolution: <a target=&#8217;_blank&#8217; href=&#8217;http://support.microsoft.com/kb/915599&#8242;>http://support.microsoft.com/kb/915599</a>&#8221;  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Case 3  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &#8216; &#8220;The underlying connection was closed: An unexpected error occurred on a receive.&#8221;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Recommendation = Recommendation &&#8221;<br><br> Lookup the error &#8216;An unexpected error occurred on a receive&#8217; here for a resolution: <a target=&#8217;_blank&#8217; href=&#8217;http://support.microsoft.com/kb/915599&#8242;>http://support.microsoft.com/kb/915599</a>&#8221;  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Case 4  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &#8216; The underlying connection was closed: An unexpected error occurred on a send&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Recommendation = Recommendation &&#8221;<br><br> Lookup the error &#8216;An unexpected error occurred on a send&#8217; here for a resolution: <a target=&#8217;_blank&#8217; href=&#8217;http://support.microsoft.com/kb/915599&#8242;>http://support.microsoft.com/kb/915599</a>&#8221;  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Case 9  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &#8216;TrustFailure A server certificate could not be validated.  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &#8216;The underlying connection was closed: Could not establish trust relationship for the SSL/TLS secure channel  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Recommendation = Recommendation &&#8221;<br><br> Lookup the error &#8216;Unable to connect to the remote server&#8217; here for a resolution: <a target=&#8217;_blank&#8217; href=&#8217;http://support.microsoft.com/kb/915599&#8242;>http://support.microsoft.com/kb/915599</a> <BR> to override the error you can do ignore the certificate error until you determine why the certificate is not trusted (see KB article for this information).&#8221;  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nb  
sp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Case 14  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &#8216;The operation has timed out&#8217;  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Recommendation = Recommendation &&#8221;<br><br> Lookup the error &#8216;The operation has timed out&#8217; here for a resolution: <a target=&#8217;\_blank&#8217; href=&#8217;http://support.microsoft.com/kb/915599&#8242;>http://support.microsoft.com/kb/915599</a> <BR> the request is taking too long to come back.&nbsp; Also see <a target=&#8217;\_blank&#8217; href= &#8216;http://msdn.microsoft.com/en-us/library/system.net.httpwebrequest.timeout.aspx&#8217;>HttpWebRequest Timeout Property</a>&#8221;  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Case 7&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &#8216;Protocol Error  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &#8216; check the response status code.&nbsp; Could be something like:&nbsp;&nbsp; System.Net.HttpStatusCode.Unauthorized  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &#8216; !do theResponseAddr jps  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; CmdOutput = g_Debugger.Execute(&#8220;!DumpObj &#8221; & theResponseAddr)  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Lines = split(CmdOutput, chr(10))  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; For I = 0 to UBound(Lines)  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; pos = InStr(Lines(i), &#8220;m_StatusCode&#8221;)  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; If pos <> 0 Then  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &#8216; if it is there then get the m_StatusCode  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &#8216; dump that out.  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &#8216; todo&#8230; work on status code&#8230;  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; CmdOutput = Mid(Lines(i), pos-9,8 )  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Select Case CInt(CmdOutput)  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Case 401  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Recommendation = Recommendation &&#8221;Unauthorized Http Status 401 means your credentials are denied access.&nbsp; See if you are passing credentials in your code.&nbsp; Example: <a target=&#8217;\_blank&#8217; href=&#8217;http://msdn.microsoft.com/en-us/library/system.net.httpwebrequest.credentials.aspx&#8217;> HttpWebRequest Credentials property</a>.&nbsp; Also see ASP.NET impersonation to pass the logged on user credentials: <a target=&#8217;\_blank&#8217; href=&#8217;http://msdn.microsoft.com/en-us/library/xh507fc5.aspx&#8217;>ASP.NET Impersonation</a> and this Wiki <a target=&#8217;_blank&#8217; href=&#8217;http://wiki.asp.net/page.aspx/44/impersonation-and-delegation/&#8217;>Impersonation and Delegation</a>&#8221;  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Case 407  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &#8216;hot fix? <a href="http://support.microsoft.com/kb/928563" mce_href="http://support.microsoft.com/kb/928563">http://support.microsoft.com/kb/928563</a>  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Recommendation = Recommendation &&#8221;Http Status 407 means your proxy requires credentials.&nbsp; See if you are passing proxy credentials in your code.&nbsp; Example: <a target=&#8217;\_blank&#8217; href=&#8217;http://msdn.microsoft.com/en-us/library/system.net.httpwebrequest.proxy.aspx&#8217;> HttpWebRequest Proxy property</a> and <a target=&#8217;\_blank&#8217; href=&#8217;http://support.microsoft.com:80/kb/318140&#8242;>Proxy servers that require NTLM authentication</a>.&nbsp; It is possible you may need a hotfix.&nbsp; See <a target=&#8217;_blank&#8217; href=&#8217;http://support.microsoft.com/kb/928563&#8242;>FIX: The System.Net.HttpWebRequest class may not maintain a persistent connection to a proxy in the .NET Framework 2.0</a>&#8221;  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Case Else

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End Select  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Recommendation = Recommendation & &#8220;<br>See HttpStatusCode &#8221; & CmdOutput & &#8221; in this article: <a target=&#8217;_blank&#8217; href=&#8217;http://msdn.microsoft.com/en-us/library/system.net.httpstatuscode.aspx&#8217;>HttpStatusCode Enumeration</a>&#8221;  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Exit For&nbsp;&nbsp;&nbsp;  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End If  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Next&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Case Else  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Recommendation = Recommendation & &#8220;<br><br> Status Code = &#8221; & iStatus & &#8221; <br> this error is an enumeration (starts at 0) you can look up here <a target=&#8217;_blank&#8217; href=&#8217;http://msdn.microsoft.com/en-us/library/system.net.webexceptionstatus.aspx&#8217;>WebExceptionStatus Enumeration</a><br>&#8221;  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End Select  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 

&nbsp;&nbsp;&nbsp;&nbsp; End If  
&nbsp;Else  
&nbsp;&nbsp;&nbsp;&nbsp; Message = Message & &#8220;</b> has caused a <font color=&#8217;red&#8217;>CLR Exception</font>)</b>&#8221;  
&nbsp;End If  
&nbsp;  
&nbsp;Message = Message & &#8221; on thread &#8221; &_  
&nbsp;&nbsp;GetThreadIDWithLink(ExceptionThread.ThreadID) & &#8220;<br>&#8221;

&nbsp;&nbsp;&nbsp;&nbsp;  
&nbsp;Manager.Write &#8220;<h4>Enhanced CLR analysis</h4>&#8221;  
&nbsp;  
&nbsp;CmdOutput = g_Debugger.Execute(&#8220;!CLRStack&#8221;)  
&nbsp;  
&nbsp;Manager.Write &#8220;<b>Managed Stack</b><br>&#8221;  
&nbsp;  
&nbsp;Lines = split(CmdOutput, chr(10))  
&nbsp;  
&nbsp;For I = 0 to UBound(Lines)  
&nbsp;&nbsp;&nbsp;&nbsp; Manager.Write Lines(I) & &#8220;<br>&#8221;  
&nbsp;Next  
&nbsp;  
&nbsp;CmdOutput = g_Debugger.Execute(&#8220;!pe&#8221;)  
&nbsp;Lines = split(CmdOutput, chr(10))  
&nbsp;  
&nbsp;  
&nbsp;  
&nbsp;Message = Message & &#8220;<br><b>Managed Exception:</b> <br>&#8221;  
&nbsp;For I = 0 to UBound(Lines)  
&nbsp;&nbsp;&nbsp;&nbsp; pos = InStr(Lines(i), &#8220;!PrintException&#8221;)  
&nbsp;&nbsp;&nbsp;&nbsp; If pos <> 0 Then  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &#8216;todo expand this as deep as we can  
&nbsp;&nbsp;&nbsp;&nbsp; End If  
&nbsp;&nbsp;&nbsp;&nbsp; Message = Message & Lines(I) & &#8220;<br>&#8221;  
&nbsp;Next  
&nbsp;  
&nbsp;&nbsp;

&nbsp;If DirectCaller > 0 Then  
&nbsp;&nbsp;Message = Message & &#8220;<br>This exception originated from <b>&#8221; & g_Debugger.GetSymbolFromAddress(DirectCaller) & &#8220;</b>. &#8220;  
&nbsp;End If  
&nbsp;  
&nbsp;Manager.Write Message  
&nbsp;If Not suppressSummary Then&nbsp; Manager.ReportError Message, Recommendation, 1000  
&nbsp;  
&nbsp;If Not Module is Nothing And g_Debugger.IsCrashDump Then  
&nbsp;&nbsp;ModuleInfo Module  
&nbsp;End If&nbsp;&nbsp;&nbsp;  
End Sub &#8216;AnalyzeClr<p mce_keep="true">

**Completed function for AnalyzeClr:**</p> <p mce_keep="true">Sub AnalyzeClr(ByVal Exception, ByVal ExceptionThread, ByVal suppressSummary)  
&nbsp;Dim Module, StackFrame, StackFrames  
&nbsp;Dim FunctionName, FuncName  
&nbsp;Dim Message, Recommendation  
&nbsp;Dim ExceptionCode, CallingFunction  
&nbsp;Dim DirectCaller, TargetFunctions  
&nbsp;Dim CLRExceptionType  
&nbsp;Dim CmdOutput  
&nbsp;Dim Lines  
&nbsp;Dim iStatus  
&nbsp;Dim pos  
&nbsp;Dim nextPE  
&nbsp;Dim theResponseAddr  
&nbsp;  
&nbsp;  
&nbsp;ExceptionCode = g_Debugger.GetAs32BitHexString(Exception.ExceptionCode)  
&nbsp;FunctionName = g_Debugger.GetSymbolFromAddress(Exception.ExceptionAddress)  
&nbsp;Set Module = g_Debugger.GetModuleByAddress(Exception.ExceptionAddress)  
&nbsp;  
&nbsp;  
&nbsp;  
&nbsp;Message = &#8220;In &#8221; & g_ShortDumpFileName & &#8221; the assembly instruction at <b>&#8221; & FunctionName  
&nbsp;  
&nbsp;If Module is Nothing Then  
&nbsp;&nbsp;Message = Message & &#8220;</b> which does not correspond to any known native module in the process&#8221;  
&nbsp;&nbsp;Recommendation = &#8220;Please contact Microsoft Corporation for troubleshooting steps on stack corruption<br>&#8221;  
&nbsp;Else  
&nbsp;&nbsp;Message = Message & &#8220;</b> in <b>&#8221; & Module.ImageName  
&nbsp;&nbsp;  
&nbsp;&nbsp;If Module.VSCompanyName <> &#8220;&#8221; Then  
&nbsp;&nbsp;&nbsp;Message = Message & &#8220;</b> from <b>&#8221; & Module.VSCompanyName  
&nbsp;&nbsp;End If  
&nbsp;&nbsp;  
&nbsp;&nbsp;If InStr(1, UCase(FunctionName), &#8220;KERNEL32!RAISEEXCEPTION&#8221;) <> 0 Then&nbsp;&nbsp;  
&nbsp;&nbsp;&nbsp;DirectCaller = GetDirectCaller(ExceptionThread.StackFrames, &#8220;KERNEL32!RAISEEXCEPTION&#8221;, 0)  
&nbsp;&nbsp;  
&nbsp;&nbsp;&nbsp;If DirectCaller > 0 Then  
&nbsp;&nbsp;&nbsp;&nbsp;Recommendation = &#8220;Review the faulting call stack for thread &#8221; & GetThreadIDWithLink(ExceptionThread.ThreadID) & &#8221; to determine &#8221; & _  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#8220;root cause for the exception.<br>&#8221; & GetVendorMessage(DirectCaller)  
&nbsp;&nbsp;&nbsp;Else  
&nbsp;&nbsp;&nbsp;&nbsp;Recommendation = &#8220;<br>An exception thrown by <Font Color=&#8217;Red&#8217;><b>Kernel32!RaiseException</b></Font> usually indicates a problem with another module. &#8221; &_  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#8220;Please review the stack for the faulting thread (&#8221; & GetThreadIDWithLink(ExceptionThread.ThreadID) & &#8220;) &#8221; &_  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#8220;further to determine which module actually threw the exception raised by Kernel32.dll.<br><br>&#8221;&nbsp;&nbsp;&nbsp;  
&nbsp;&nbsp;&nbsp;End If&nbsp;&nbsp;  
&nbsp;&nbsp;ElseIf InStr(1, UCase(FunctionName), &#8220;NTDLL!KIRAISEUSEREXCEPTIONDISPATCHER&#8221;) <> 0 Then  
&nbsp;&nbsp;&nbsp;TargetFunctions = &#8220;ADVAPI32!REGCLOSEKEY;KERNEL32!CLOSEHANDLE&#8221;  
&nbsp;&nbsp;&nbsp;  
&nbsp;&nbsp;&nbsp;Set StackFrames = ExceptionThread.StackFrames  
&nbsp;&nbsp;&nbsp;For I = 0 to StackFrames.Count &#8211; 1  
&nbsp;&nbsp;&nbsp;&nbsp;Set StackFrame = StackFrames(I)  
&nbsp;&nbsp;&nbsp;&nbsp;FuncName = Split(UCase(g_Debugger.GetSymbolFromAddress(StackFrame.InstructionAddress)), &#8220;+&#8221;, -1)  
&nbsp;&nbsp;&nbsp;&nbsp;  
&nbsp;&nbsp;&nbsp;&nbsp;If InStr(1, TargetFunctions, UCase(FuncName(0))) <> 0 Then  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Set CallingFunction = g_Debugger.GetModuleByAddress(StackFrame.ReturnAddress)  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DirectCaller = StackFrame.ReturnAddress  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Recommendation = &#8220;This exception occured as a result of an invalid handle passed to &#8221; & FuncName(0) & &#8221; by the following function:<br><br><b>&#8221; &_  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;g_Debugger.GetSymbolFromAddress(StackFrame.ReturnAddress) & &#8220;</b><br><br>Please follow up with the vendor of this module&#8221;  
&nbsp;&nbsp;&nbsp;&nbsp;  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;If CallingFunction.VSCompanyName <> &#8220;&#8221; Then  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Recommendation = Recommendation & &#8220;, <b>&#8221; &&nbsp; CallingFunction.VSCompanyName & &#8220;</b>,&#8221;  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;End If  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Recommendation = Recommendation & &#8221; for further assistance with this issue.&#8221;  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Set Module = g_Debugger.GetModuleByAddress(DirectCaller)  
&nbsp;&nbsp;&nbsp;&nbsp;End If  
&nbsp;&nbsp;&nbsp;Next  
&nbsp;&nbsp;Else  
&nbsp;&nbsp;&nbsp;Recommendation = GetVendorMessage(Exception.ExceptionAddress)  
&nbsp;&nbsp;End If&nbsp;&nbsp;  
&nbsp;End If</p> <p mce_keep="true">&nbsp;CLRExceptionType = GetCLRExceptionType(GetCLRExceptionPtr(ExceptionThread), False, iStatus, theResponseAddr)  
&nbsp;If ClrExceptionType <> &#8220;&#8221; Then  
&nbsp;&nbsp;&nbsp;&nbsp; Message = Message & &#8220;</b> has caused a <b>CLR Exception</b> of type <b>(<font color=&#8217;red&#8217;>&#8221; & ClrExceptionType & &#8220;</font>)</b>&#8221;  
&nbsp;&nbsp;&nbsp;&nbsp;  
&nbsp;&nbsp;&nbsp;&nbsp; If ClrExceptionType = &#8220;System.Net.WebException&#8221; Then  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &#8216;remove the vendor statement  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; pos = InStr( Recommendation,&#8221;Please follow up with vendor&#8221;)  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (pos<>0) then  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Recommendation = Mid(Recommendation, 1, pos-1)  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; end if  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &#8216;public enum WebExceptionStatus  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &#8216;{  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &#8216;&nbsp;&nbsp;&nbsp; Success, 0  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &#8216;&nbsp;&nbsp;&nbsp; NameResolutionFailure, 1  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &#8216;&nbsp;&nbsp;&nbsp; ConnectFailure, 2  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &#8216;&nbsp;&nbsp;&nbsp; ReceiveFailure, 3  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &#8216;&nbsp;&nbsp;&nbsp; SendFailure, 4  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &#8216;&nbsp;&nbsp;&nbsp; PipelineFailure, 5  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &#8216;&nbsp;&nbsp;&nbsp; RequestCanceled, 6  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &#8216;&nbsp;&nbsp;&nbsp; ProtocolError, 7  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &#8216;&nbsp;&nbsp;&nbsp; ConnectionClosed, 8  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &#8216;&nbsp;&nbsp;&nbsp; TrustFailure, 9  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &#8216;&nbsp;&nbsp;&nbsp; SecureChannelFailure, 10  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &#8216;&nbsp;&nbsp;&nbsp; ServerProtocolViolation, 11  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &#8216;&nbsp;&nbsp;&nbsp; KeepAliveFailure, 12  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &#8216;&nbsp;&nbsp;&nbsp; Pending, 13  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &#8216;&nbsp;&nbsp;&nbsp; Timeout, 14  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &#8216;&nbsp;&nbsp;&nbsp; ProxyNameResolutionFailure, 15  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &#8216;&nbsp;&nbsp;&nbsp; UnknownError, 16  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &#8216;&nbsp;&nbsp;&nbsp; MessageLengthLimitExceeded, 17  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &#8216;&nbsp;&nbsp;&nbsp; CacheEntryNotFound, 18  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &#8216;&nbsp;&nbsp;&nbsp; RequestProhibitedByCachePolicy, 19  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &#8216;&nbsp;&nbsp;&nbsp; RequestProhibitedByProxy 20  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &#8216;}  
&nbsp;  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Select Case CInt(iStatus)  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Case 1  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Recommendation = Recommendation &&#8221;<br><br> This is a DNS error.&nbsp; For some reason the server name cannot be resolved.&nbsp; Do you have permissions to the HOST file?&nbsp; Is this a service such as ASP.NET?&nbsp; See this article for help: <a target=&#8217;_blank&#8217; href=&#8217;http://support.microsoft.com/kb/318140&#8242;>The underlying connection was closed: The remote name could not be resolved.</a>&#8221;&nbsp;  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Case 2  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &#8216; &#8220;Unable to connect to the remote server&#8221;  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Recommendation = Recommendation &&#8221;<br><br> Lookup the error &#8216;Unable to connect to the remote server&#8217; here for a resolution: <a target=&#8217;_blank&#8217; href=&#8217;http://support.microsoft.com/kb/915599&#8242;>http://support.microsoft.com/kb/915599</a>&#8221;  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Case 3  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &#8216; &#8220;The underlying connection was closed: An unexpected error occurred on a receive.&#8221;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Recommendation = Recommendation &&#8221;<br><br> Lookup the error &#8216;An unexpected error occurred on a receive&#8217; here for a resolution: <a target=&#8217;_blank&#8217; href=&#8217;http://support.microsoft.com/kb/915599&#8242;>http://support.microsoft.com/kb/915599</a>&#8221;  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Case 4  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &#8216; The underlying connection was closed: An unexpected error occurred on a send&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Recommendation = Recommendation &&#8221;<br><br> Lookup the error &#8216;An unexpected error occurred on a send&#8217; here for a resolution: <a target=&#8217;_blank&#8217; href=&#8217;http://support.microsoft.com/kb/915599&#8242;>http://support.microsoft.com/kb/915599</a>&#8221;  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Case 9  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &#8216;TrustFailure A server certificate could not be validated.  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &#8216;The underlying connection was closed: Could not establish trust relationship for the SSL/TLS secure channel  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Recommendation = Recommendation &&#8221;<br><br>You could add this delegate to your code and dump the error to fix it: <a target=&#8217;_blank&#8217; href=&#8217;http://msdn.microsoft.com/en-us/library/system.net.security.remotecertificatevalidationcallback.aspx&#8217;>RemoteCertificateValidationCallback Delegate</a>. <br>Try a console app with the same code, if it succeeds but an asp.net app fails, this means the Local Machine store may not have the Trusted Roo  
t and Intermediate Authority certificates in the store.<br> Lookup the error &#8216;Unable to connect to the remote server&#8217; here for a resolution: <a target=&#8217;_blank&#8217; href=&#8217;http://support.microsoft.com/kb/915599&#8242;>http://support.microsoft.com/kb/915599</a> <BR> to override the error you can do ignore the certificate error until you determine why the certificate is not trusted (see KB article for this information).&#8221;  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Case 14  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &#8216;The operation has timed out&#8217;  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Recommendation = Recommendation &&#8221;<br><br> Lookup the error &#8216;The operation has timed out&#8217; here for a resolution: <a target=&#8217;\_blank&#8217; href=&#8217;http://support.microsoft.com/kb/915599&#8242;>http://support.microsoft.com/kb/915599</a> <BR> the request is taking too long to come back.&nbsp; Also see <a target=&#8217;\_blank&#8217; href= &#8216;http://msdn.microsoft.com/en-us/library/system.net.httpwebrequest.timeout.aspx&#8217;>HttpWebRequest Timeout Property</a>&#8221;  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Case 7&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &#8216;Protocol Error  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &#8216; check the response status code.&nbsp; Could be something like:&nbsp;&nbsp; System.Net.HttpStatusCode.Unauthorized  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &#8216; !do theResponseAddr jps  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; CmdOutput = g_Debugger.Execute(&#8220;!DumpObj &#8221; & theResponseAddr)  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Lines = split(CmdOutput, chr(10))  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; For I = 0 to UBound(Lines)  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; pos = InStr(Lines(i), &#8220;m_StatusCode&#8221;)  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; If pos <> 0 Then  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &#8216; if it is there then get the m_StatusCode  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &#8216; dump that out.  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &#8216; todo&#8230; work on status code&#8230;  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; CmdOutput = Mid(Lines(i), pos-9,8 )  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Select Case CInt(CmdOutput)  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Case 401  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Recommendation = Recommendation &&#8221;Unauthorized Http Status 401 means your credentials are denied access.&nbsp; See if you are passing credentials in your code.&nbsp; Example: <a target=&#8217;\_blank&#8217; href=&#8217;http://msdn.microsoft.com/en-us/library/system.net.httpwebrequest.credentials.aspx&#8217;> HttpWebRequest Credentials property</a>.&nbsp; Also see ASP.NET impersonation to pass the logged on user credentials: <a target=&#8217;\_blank&#8217; href=&#8217;http://msdn.microsoft.com/en-us/library/xh507fc5.aspx&#8217;>ASP.NET Impersonation</a> and this Wiki <a target=&#8217;_blank&#8217; href=&#8217;http://wiki.asp.net/page.aspx/44/impersonation-and-delegation/&#8217;>Impersonation and Delegation</a>&#8221;  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Case 407  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &#8216;hot fix? <http://support.microsoft.com/kb/928563>  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Recommendation = Recommendation &&#8221;Http Status 407 means your proxy requires credentials.&nbsp; See if you are passing proxy credentials in your code.&nbsp; Example: <a target=&#8217;\_blank&#8217; href=&#8217;http://msdn.microsoft.com/en-us/library/system.net.httpwebrequest.proxy.aspx&#8217;> HttpWebRequest Proxy property</a> and <a target=&#8217;\_blank&#8217; href=&#8217;http://support.microsoft.com:80/kb/318140&#8242;>Proxy servers that require NTLM authentication</a>.&nbsp; It is possible you may need a hotfix.&nbsp; See <a target=&#8217;_blank&#8217; href=&#8217;http://support.microsoft.com/kb/928563&#8242;>FIX: The System.Net.HttpWebRequest class may not maintain a persistent connection to a proxy in the .NET Framework 2.0</a>&#8221;  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Case Else</p> <p mce_keep="true">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End Select  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Recommendation = Recommendation & &#8220;<br>See HttpStatusCode &#8221; & CmdOutput & &#8221; in this article: <a target=&#8217;_blank&#8217; href=&#8217;http://msdn.microsoft.com/en-us/library/system.net.httpstatuscode.aspx&#8217;>HttpStatusCode Enumeration</a>&#8221;  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Exit For&nbsp;&nbsp;&nbsp;  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End If  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Next&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Case Else  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Recommendation = Recommendation & &#8220;<br><br> Status Code = &#8221; & iStatus & &#8221; <br> this error is an enumeration (starts at 0) you can look up here <a target=&#8217;_blank&#8217; href=&#8217;http://msdn.microsoft.com/en-us/library/system.net.webexceptionstatus.aspx&#8217;>WebExceptionStatus Enumeration</a><br>&#8221;  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End Select  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Else  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; If ClrExceptionType = &#8220;System.Security.Authentication.AuthenticationException&#8221; Then  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &#8216;remove the vendor statement  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; pos = InStr( Recommendation,&#8221;Please follow up with vendor&#8221;)  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (pos<>0) then  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Recommendation = Mid(Recommendation, 1, pos-1)  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; end if  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Recommendation = Recommendation &&#8221;<br><br>You could add this delegate to your code and dump the error to fix it: <a target=&#8217;\_blank&#8217; href=&#8217;http://msdn.microsoft.com/en-us/library/system.net.security.remotecertificatevalidationcallback.aspx&#8217;>RemoteCertificateValidationCallback Delegate</a>. <br>Try a console app with the same code, if it succeeds but an asp.net app fails, this means the Local Machine store may not have the Trusted Root and Intermediate Authority certificates in the store.<br> Lookup the error &#8216;Unable to connect to the remote server&#8217; here for a resolution: <a target=&#8217;\_blank&#8217; href=&#8217;http://support.microsoft.com/kb/915599&#8242;>http://support.microsoft.com/kb/915599</a> <BR> to override the error you can do ignore the certificate error until you determine why the certificate is not trusted (see KB article for this information).&#8221;</p> <p mce_keep="true">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End If  
&nbsp;&nbsp;&nbsp;&nbsp;  
&nbsp;&nbsp;&nbsp;&nbsp; End If  
&nbsp;Else  
&nbsp;&nbsp;&nbsp;&nbsp; Message = Message & &#8220;</b> has caused a <font color=&#8217;red&#8217;>CLR Exception</font>)</b>&#8221;  
&nbsp;End If  
&nbsp;  
&nbsp;Message = Message & &#8221; on thread &#8221; &_  
&nbsp;&nbsp;GetThreadIDWithLink(ExceptionThread.ThreadID) & &#8220;<br>&#8221;</p> <p mce_keep="true">&nbsp;&nbsp;&nbsp;&nbsp;  
&nbsp;Manager.Write &#8220;<h4>Enhanced CLR analysis</h4>&#8221;  
&nbsp;  
&nbsp;CmdOutput = g_Debugger.Execute(&#8220;!CLRStack&#8221;)  
&nbsp;  
&nbsp;Manager.Write &#8220;<b>Managed Stack</b><br>&#8221;  
&nbsp;  
&nbsp;Lines = split(CmdOutput, chr(10))  
&nbsp;  
&nbsp;For I = 0 to UBound(Lines)  
&nbsp;&nbsp;&nbsp;&nbsp; Manager.Write Lines(I) & &#8220;<br>&#8221;  
&nbsp;Next  
&nbsp;  
&nbsp;CmdOutput = g_Debugger.Execute(&#8220;!pe&#8221;)  
&nbsp;Lines = split(CmdOutput, chr(10))  
&nbsp;  
&nbsp;  
&nbsp;  
&nbsp;Message = Message & &#8220;<br><b>Managed Exception:</b> <br>&#8221;  
&nbsp;For I = 0 to UBound(Lines)  
&nbsp;&nbsp;&nbsp;&nbsp; pos = InStr(Lines(i), &#8220;!PrintException&#8221;)  
&nbsp;&nbsp;&nbsp;&nbsp; If pos <> 0 Then  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &#8216;todo expand this as deep as we can  
&nbsp;&nbsp;&nbsp;&nbsp; End If  
&nbsp;&nbsp;&nbsp;&nbsp; Message = Message & Lines(I) & &#8220;<br>&#8221;  
&nbsp;Next  
&nbsp;  
&nbsp;&nbsp;</p> <p mce_keep="true">&nbsp;If DirectCaller > 0 Then  
&nbsp;&nbsp;Message = Message & &#8220;<br>This exception originated from <b>&#8221; & g_Debugger.GetSymbolFromAddress(DirectCaller) & &#8220;</b>. &#8220;  
&nbsp;End If  
&nbsp;  
&nbsp;Manager.Write Message  
&nbsp;If Not suppressSummary Then&nbsp; Manager.ReportError Message, Recommendation, 1000  
&nbsp;  
&nbsp;If Not Module is Nothing And g_Debugger.IsCrashDump Then  
&nbsp;&nbsp;ModuleInfo Module  
&nbsp;End If&nbsp;&nbsp;&nbsp;  
End Sub &#8216;AnalyzeClr</p> <p mce_keep="true">**Please let me know if this is useful to you and if you run into any problems!**</p>