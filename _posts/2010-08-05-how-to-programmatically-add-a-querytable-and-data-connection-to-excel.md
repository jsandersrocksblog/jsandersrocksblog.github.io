---
id: 633
title: How to Programmatically add a QueryTable and Data Connection to Excel
date: 2010-08-05T12:15:16-05:00
author: jsanders
layout: post
guid: http://jsandersblog.azurewebsites.net/2010/08/05/how-to-programmatically-add-a-querytable-and-data-connection-to-excel/
permalink: /2010/08/05/how-to-programmatically-add-a-querytable-and-data-connection-to-excel/
orig_url:
  - http://blogs.msdn.microsoft.com/b/jpsanders/archive/2010/08/05/how-to-programmatically-add-a-querytable-and-data-connection-to-excel.aspx
  - http://blogs.msdn.microsoft.com/b/jpsanders/archive/2010/08/05/how-to-programmatically-add-a-querytable-and-data-connection-to-excel.aspx
  - http://blogs.msdn.microsoft.com/b/jpsanders/archive/2010/08/05/how-to-programmatically-add-a-querytable-and-data-connection-to-excel.aspx
  - http://blogs.msdn.microsoft.com/b/jpsanders/archive/2010/08/05/how-to-programmatically-add-a-querytable-and-data-connection-to-excel.aspx
  - http://blogs.msdn.microsoft.com/b/jpsanders/archive/2010/08/05/how-to-programmatically-add-a-querytable-and-data-connection-to-excel.aspx
  - http://blogs.msdn.microsoft.com/b/jpsanders/archive/2010/08/05/how-to-programmatically-add-a-querytable-and-data-connection-to-excel.aspx
  - http://blogs.msdn.microsoft.com/b/jpsanders/archive/2010/08/05/how-to-programmatically-add-a-querytable-and-data-connection-to-excel.aspx
  - http://blogs.msdn.microsoft.com/b/jpsanders/archive/2010/08/05/how-to-programmatically-add-a-querytable-and-data-connection-to-excel.aspx
  - http://blogs.msdn.microsoft.com/b/jpsanders/archive/2010/08/05/how-to-programmatically-add-a-querytable-and-data-connection-to-excel.aspx
orig_site_id:
  - "8394"
  - "8394"
  - "8394"
  - "8394"
  - "8394"
  - "8394"
  - "8394"
  - "8394"
  - "8394"
orig_post_id:
  - "10046727"
  - "10046727"
  - "10046727"
  - "10046727"
  - "10046727"
  - "10046727"
  - "10046727"
  - "10046727"
  - "10046727"
orig_parent_id:
  - "10046727"
  - "10046727"
  - "10046727"
  - "10046727"
  - "10046727"
  - "10046727"
  - "10046727"
  - "10046727"
  - "10046727"
orig_thread_id:
  - "728376"
  - "728376"
  - "728376"
  - "728376"
  - "728376"
  - "728376"
  - "728376"
  - "728376"
  - "728376"
orig_application_key:
  - jpsanders
  - jpsanders
  - jpsanders
  - jpsanders
  - jpsanders
  - jpsanders
  - jpsanders
  - jpsanders
  - jpsanders
orig_post_author_id:
  - "65385"
  - "65385"
  - "65385"
  - "65385"
  - "65385"
  - "65385"
  - "65385"
  - "65385"
  - "65385"
orig_post_author_username:
  - jpsanders
  - jpsanders
  - jpsanders
  - jpsanders
  - jpsanders
  - jpsanders
  - jpsanders
  - jpsanders
  - jpsanders
orig_post_author_created:
  - Jan 18 2007 01:34:53:000PM
  - Jan 18 2007 01:34:53:000PM
  - Jan 18 2007 01:34:53:000PM
  - Jan 18 2007 01:34:53:000PM
  - Jan 18 2007 01:34:53:000PM
  - Jan 18 2007 01:34:53:000PM
  - Jan 18 2007 01:34:53:000PM
  - Jan 18 2007 01:34:53:000PM
  - Jan 18 2007 01:34:53:000PM
orig_is_approved:
  - "1"
  - "1"
  - "1"
  - "1"
  - "1"
  - "1"
  - "1"
  - "1"
  - "1"
orig_attachment_count:
  - "0"
  - "0"
  - "0"
  - "0"
  - "0"
  - "0"
  - "0"
  - "0"
  - "0"
orig_url_title:
  - http://blogs.msdn.com/b/jpsanders/archive/2010/08/05/how-to-programmatically-add-a-querytable-and-data-connection-to-excel.aspx
  - http://blogs.msdn.com/b/jpsanders/archive/2010/08/05/how-to-programmatically-add-a-querytable-and-data-connection-to-excel.aspx
  - http://blogs.msdn.com/b/jpsanders/archive/2010/08/05/how-to-programmatically-add-a-querytable-and-data-connection-to-excel.aspx
  - http://blogs.msdn.com/b/jpsanders/archive/2010/08/05/how-to-programmatically-add-a-querytable-and-data-connection-to-excel.aspx
  - http://blogs.msdn.com/b/jpsanders/archive/2010/08/05/how-to-programmatically-add-a-querytable-and-data-connection-to-excel.aspx
  - http://blogs.msdn.com/b/jpsanders/archive/2010/08/05/how-to-programmatically-add-a-querytable-and-data-connection-to-excel.aspx
  - http://blogs.msdn.com/b/jpsanders/archive/2010/08/05/how-to-programmatically-add-a-querytable-and-data-connection-to-excel.aspx
  - http://blogs.msdn.com/b/jpsanders/archive/2010/08/05/how-to-programmatically-add-a-querytable-and-data-connection-to-excel.aspx
  - http://blogs.msdn.com/b/jpsanders/archive/2010/08/05/how-to-programmatically-add-a-querytable-and-data-connection-to-excel.aspx
opengraph_tags:
  - |
    <meta property="og:type" content="article" />
    <meta property="og:title" content="How to Programmatically add a QueryTable and Data Connection to Excel" />
    <meta property="og:url" content="https://blogs.msdn.microsoft.com/jpsanders/2010/08/05/how-to-programmatically-add-a-querytable-and-data-connection-to-excel/" />
    <meta property="og:site_name" content="Http Client Protocol Issues (and other fun stuff I support)" />
    <meta property="og:description" content="I needed to create an Excel Spreadsheet with a Connection object and link a QueryTable to it.&nbsp; I could not find a good example of this so I thought I would share.&nbsp; Please drop me a note if you found this useful! Code listing for sample (Copy Code): &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; private&nbsp;void createProdSheet(string topicText, bool debugView)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;..." />
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="How to Programmatically add a QueryTable and Data Connection to Excel" />
    <meta name="twitter:url" content="https://blogs.msdn.microsoft.com/jpsanders/2010/08/05/how-to-programmatically-add-a-querytable-and-data-connection-to-excel/" />
    <meta name="twitter:description" content="I needed to create an Excel Spreadsheet with a Connection object and link a QueryTable to it.&nbsp; I could not find a good example of this so I thought I would share.&nbsp; Please drop me a note if you found this useful! Code listing for sample (Copy Code): &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; private&nbsp;void createProdSheet(string topicText, bool debugView)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;..." />
    
  - |
    <meta property="og:type" content="article" />
    <meta property="og:title" content="How to Programmatically add a QueryTable and Data Connection to Excel" />
    <meta property="og:url" content="https://blogs.msdn.microsoft.com/jpsanders/2010/08/05/how-to-programmatically-add-a-querytable-and-data-connection-to-excel/" />
    <meta property="og:site_name" content="Http Client Protocol Issues (and other fun stuff I support)" />
    <meta property="og:description" content="I needed to create an Excel Spreadsheet with a Connection object and link a QueryTable to it.&nbsp; I could not find a good example of this so I thought I would share.&nbsp; Please drop me a note if you found this useful! Code listing for sample (Copy Code): &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; private&nbsp;void createProdSheet(string topicText, bool debugView)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;..." />
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="How to Programmatically add a QueryTable and Data Connection to Excel" />
    <meta name="twitter:url" content="https://blogs.msdn.microsoft.com/jpsanders/2010/08/05/how-to-programmatically-add-a-querytable-and-data-connection-to-excel/" />
    <meta name="twitter:description" content="I needed to create an Excel Spreadsheet with a Connection object and link a QueryTable to it.&nbsp; I could not find a good example of this so I thought I would share.&nbsp; Please drop me a note if you found this useful! Code listing for sample (Copy Code): &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; private&nbsp;void createProdSheet(string topicText, bool debugView)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;..." />
    
  - |
    <meta property="og:type" content="article" />
    <meta property="og:title" content="How to Programmatically add a QueryTable and Data Connection to Excel" />
    <meta property="og:url" content="https://blogs.msdn.microsoft.com/jpsanders/2010/08/05/how-to-programmatically-add-a-querytable-and-data-connection-to-excel/" />
    <meta property="og:site_name" content="Http Client Protocol Issues (and other fun stuff I support)" />
    <meta property="og:description" content="I needed to create an Excel Spreadsheet with a Connection object and link a QueryTable to it.&nbsp; I could not find a good example of this so I thought I would share.&nbsp; Please drop me a note if you found this useful! Code listing for sample (Copy Code): &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; private&nbsp;void createProdSheet(string topicText, bool debugView)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;..." />
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="How to Programmatically add a QueryTable and Data Connection to Excel" />
    <meta name="twitter:url" content="https://blogs.msdn.microsoft.com/jpsanders/2010/08/05/how-to-programmatically-add-a-querytable-and-data-connection-to-excel/" />
    <meta name="twitter:description" content="I needed to create an Excel Spreadsheet with a Connection object and link a QueryTable to it.&nbsp; I could not find a good example of this so I thought I would share.&nbsp; Please drop me a note if you found this useful! Code listing for sample (Copy Code): &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; private&nbsp;void createProdSheet(string topicText, bool debugView)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;..." />
    
  - |
    <meta property="og:type" content="article" />
    <meta property="og:title" content="How to Programmatically add a QueryTable and Data Connection to Excel" />
    <meta property="og:url" content="https://blogs.msdn.microsoft.com/jpsanders/2010/08/05/how-to-programmatically-add-a-querytable-and-data-connection-to-excel/" />
    <meta property="og:site_name" content="Http Client Protocol Issues (and other fun stuff I support)" />
    <meta property="og:description" content="I needed to create an Excel Spreadsheet with a Connection object and link a QueryTable to it.&nbsp; I could not find a good example of this so I thought I would share.&nbsp; Please drop me a note if you found this useful! Code listing for sample (Copy Code): &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; private&nbsp;void createProdSheet(string topicText, bool debugView)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;..." />
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="How to Programmatically add a QueryTable and Data Connection to Excel" />
    <meta name="twitter:url" content="https://blogs.msdn.microsoft.com/jpsanders/2010/08/05/how-to-programmatically-add-a-querytable-and-data-connection-to-excel/" />
    <meta name="twitter:description" content="I needed to create an Excel Spreadsheet with a Connection object and link a QueryTable to it.&nbsp; I could not find a good example of this so I thought I would share.&nbsp; Please drop me a note if you found this useful! Code listing for sample (Copy Code): &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; private&nbsp;void createProdSheet(string topicText, bool debugView)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;..." />
    
  - |
    <meta property="og:type" content="article" />
    <meta property="og:title" content="How to Programmatically add a QueryTable and Data Connection to Excel" />
    <meta property="og:url" content="https://blogs.msdn.microsoft.com/jpsanders/2010/08/05/how-to-programmatically-add-a-querytable-and-data-connection-to-excel/" />
    <meta property="og:site_name" content="Http Client Protocol Issues (and other fun stuff I support)" />
    <meta property="og:description" content="I needed to create an Excel Spreadsheet with a Connection object and link a QueryTable to it.&nbsp; I could not find a good example of this so I thought I would share.&nbsp; Please drop me a note if you found this useful! Code listing for sample (Copy Code): &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; private&nbsp;void createProdSheet(string topicText, bool debugView)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;..." />
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="How to Programmatically add a QueryTable and Data Connection to Excel" />
    <meta name="twitter:url" content="https://blogs.msdn.microsoft.com/jpsanders/2010/08/05/how-to-programmatically-add-a-querytable-and-data-connection-to-excel/" />
    <meta name="twitter:description" content="I needed to create an Excel Spreadsheet with a Connection object and link a QueryTable to it.&nbsp; I could not find a good example of this so I thought I would share.&nbsp; Please drop me a note if you found this useful! Code listing for sample (Copy Code): &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; private&nbsp;void createProdSheet(string topicText, bool debugView)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;..." />
    
  - |
    <meta property="og:type" content="article" />
    <meta property="og:title" content="How to Programmatically add a QueryTable and Data Connection to Excel" />
    <meta property="og:url" content="https://blogs.msdn.microsoft.com/jpsanders/2010/08/05/how-to-programmatically-add-a-querytable-and-data-connection-to-excel/" />
    <meta property="og:site_name" content="Http Client Protocol Issues (and other fun stuff I support)" />
    <meta property="og:description" content="I needed to create an Excel Spreadsheet with a Connection object and link a QueryTable to it.&nbsp; I could not find a good example of this so I thought I would share.&nbsp; Please drop me a note if you found this useful! Code listing for sample (Copy Code): &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; private&nbsp;void createProdSheet(string topicText, bool debugView)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;..." />
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="How to Programmatically add a QueryTable and Data Connection to Excel" />
    <meta name="twitter:url" content="https://blogs.msdn.microsoft.com/jpsanders/2010/08/05/how-to-programmatically-add-a-querytable-and-data-connection-to-excel/" />
    <meta name="twitter:description" content="I needed to create an Excel Spreadsheet with a Connection object and link a QueryTable to it.&nbsp; I could not find a good example of this so I thought I would share.&nbsp; Please drop me a note if you found this useful! Code listing for sample (Copy Code): &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; private&nbsp;void createProdSheet(string topicText, bool debugView)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;..." />
    
  - |
    <meta property="og:type" content="article" />
    <meta property="og:title" content="How to Programmatically add a QueryTable and Data Connection to Excel" />
    <meta property="og:url" content="https://blogs.msdn.microsoft.com/jpsanders/2010/08/05/how-to-programmatically-add-a-querytable-and-data-connection-to-excel/" />
    <meta property="og:site_name" content="Http Client Protocol Issues (and other fun stuff I support)" />
    <meta property="og:description" content="I needed to create an Excel Spreadsheet with a Connection object and link a QueryTable to it.&nbsp; I could not find a good example of this so I thought I would share.&nbsp; Please drop me a note if you found this useful! Code listing for sample (Copy Code): &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; private&nbsp;void createProdSheet(string topicText, bool debugView)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;..." />
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="How to Programmatically add a QueryTable and Data Connection to Excel" />
    <meta name="twitter:url" content="https://blogs.msdn.microsoft.com/jpsanders/2010/08/05/how-to-programmatically-add-a-querytable-and-data-connection-to-excel/" />
    <meta name="twitter:description" content="I needed to create an Excel Spreadsheet with a Connection object and link a QueryTable to it.&nbsp; I could not find a good example of this so I thought I would share.&nbsp; Please drop me a note if you found this useful! Code listing for sample (Copy Code): &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; private&nbsp;void createProdSheet(string topicText, bool debugView)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;..." />
    
  - |
    <meta property="og:type" content="article" />
    <meta property="og:title" content="How to Programmatically add a QueryTable and Data Connection to Excel" />
    <meta property="og:url" content="https://blogs.msdn.microsoft.com/jpsanders/2010/08/05/how-to-programmatically-add-a-querytable-and-data-connection-to-excel/" />
    <meta property="og:site_name" content="Http Client Protocol Issues (and other fun stuff I support)" />
    <meta property="og:description" content="I needed to create an Excel Spreadsheet with a Connection object and link a QueryTable to it.&nbsp; I could not find a good example of this so I thought I would share.&nbsp; Please drop me a note if you found this useful! Code listing for sample (Copy Code): &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; private&nbsp;void createProdSheet(string topicText, bool debugView)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;..." />
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="How to Programmatically add a QueryTable and Data Connection to Excel" />
    <meta name="twitter:url" content="https://blogs.msdn.microsoft.com/jpsanders/2010/08/05/how-to-programmatically-add-a-querytable-and-data-connection-to-excel/" />
    <meta name="twitter:description" content="I needed to create an Excel Spreadsheet with a Connection object and link a QueryTable to it.&nbsp; I could not find a good example of this so I thought I would share.&nbsp; Please drop me a note if you found this useful! Code listing for sample (Copy Code): &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; private&nbsp;void createProdSheet(string topicText, bool debugView)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;..." />
    
  - |
    <meta property="og:type" content="article" />
    <meta property="og:title" content="How to Programmatically add a QueryTable and Data Connection to Excel" />
    <meta property="og:url" content="https://blogs.msdn.microsoft.com/jpsanders/2010/08/05/how-to-programmatically-add-a-querytable-and-data-connection-to-excel/" />
    <meta property="og:site_name" content="Http Client Protocol Issues (and other fun stuff I support)" />
    <meta property="og:description" content="I needed to create an Excel Spreadsheet with a Connection object and link a QueryTable to it.&nbsp; I could not find a good example of this so I thought I would share.&nbsp; Please drop me a note if you found this useful! Code listing for sample (Copy Code): &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; private&nbsp;void createProdSheet(string topicText, bool debugView)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;..." />
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="How to Programmatically add a QueryTable and Data Connection to Excel" />
    <meta name="twitter:url" content="https://blogs.msdn.microsoft.com/jpsanders/2010/08/05/how-to-programmatically-add-a-querytable-and-data-connection-to-excel/" />
    <meta name="twitter:description" content="I needed to create an Excel Spreadsheet with a Connection object and link a QueryTable to it.&nbsp; I could not find a good example of this so I thought I would share.&nbsp; Please drop me a note if you found this useful! Code listing for sample (Copy Code): &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; private&nbsp;void createProdSheet(string topicText, bool debugView)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;..." />
    
categories:
  - Uncategorized
tags:
  - Excel
  - QueryTable
---
I needed to create an Excel Spreadsheet with a Connection object and link a QueryTable to it.&nbsp; I could not find a good example of this so I thought I would share.&nbsp; Please drop me a note if you found this useful!

**Code listing for sample (<a href="javascript:CopyCode('QueryTable1');" mce_href="javascript:CopyCode('QueryTable1');">Copy Code</a>):**

<div style="background-color: #e0e0e0" id="QueryTable1">
  <pre style="font-family: consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: blue">private</span>&nbsp;<span style="color: blue">void</span> createProdSheet(<span style="color: blue">string</span> topicText, <span style="color: blue">bool</span> debugView)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: green">// Start a new workbook in Excel.</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: blue">string</span> aProd = topicText;<br /> <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Microsoft.Office.Interop.Excel.<span style="color: #2b91af">Application</span> oXL;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: #2b91af">Workbook</span> oWB;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: #2b91af">Workbooks</span> oWBS;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: #2b91af">Worksheet</span> oTemplateSheet;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: #2b91af">Sheets</span> oSheets;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: #2b91af">QueryTables</span> oTables;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: #2b91af">QueryTable</span> oTable;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: #2b91af">Range</span> oRng;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: blue">try</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br /> <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: green">// Start Excel and get the Application object.</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; oXL = <span style="color: blue">new</span> Microsoft.Office.Interop.Excel.<span style="color: #2b91af">Application</span>();<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; oXL.Visible = <span style="color: blue">true</span>;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; oXL.ScreenUpdating = <span style="color: blue">false</span>;<br /> <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: green">// get the workbooks collection and add a new Workbook to it.</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; oWBS = oXL.Workbooks;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; oWB = oWBS.Add();<br /> <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: green">// Create a QueryTable that starts at cell A1.</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; oSheets = oWB.Sheets;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: green">// by default when you create a new WB you get 3 sheets, get the first one</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; oTemplateSheet = oSheets[1];<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; oRng = oTemplateSheet.get_Range(<span style="color: #a31515">"A1"</span>);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; oTemplateSheet.Name = <span style="color: #a31515">"ProductId Assignments"</span>;<br /> <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: green">// get the QueryTables collection</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; oTables = oTemplateSheet.QueryTables;<br /> <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: blue">string</span> SQLStr;<br /> <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: green">// decide how much detail we want and use the appropriate stored procedure</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: blue">if</span> (debugView)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; SQLStr = <span style="color: #a31515">"EXEC [dbo].[GetMergedPesIDReportForOpsByNameDetailed] @ProductFamily = N'"</span> + aProd + <span style="color: #a31515">"'"</span>;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: blue">else</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; SQLStr = <span style="color: #a31515">"EXEC [dbo].[GetMergedPesIDReportForOpsByName] @ProductFamily = N'"</span> + aProd + <span style="color: #a31515">"'"</span>;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: blue">object</span> aStrSQL = SQLStr;<br /> <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: blue">object</span> connection = <span style="color: #a31515">"OLEDB;Provider=SQLOLEDB.1;Integrated Security=SSPI;Persist Security Info=True;Initial Catalog=STIProducts;Data Source=stieditor;Use Procedure for Prepare=1;Auto Translate=True;Packet Size=4096;Workstation ID=JSANDERS6;Use Encryption for Data=False;Tag with column collation when possible=False"</span>;<br /> <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: green">// create a query table with the connection and SQL command</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; oTable = oTables.Add(connection, oRng, aStrSQL);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; oTable.RefreshStyle = <span style="color: #2b91af">XlCellInsertionMode</span>.xlInsertEntireRows;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; oTable.Refresh(<span style="color: blue">false</span>);<br /> <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: green">//Remove the Connection I made because I don't want users refreshing the data (optional)</span><br />&nbsp;&nbsp;&nbs
p;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; oWB.Connections[1].Delete();<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: green">//Make sure Excel is visible and give the user control of Microsoft Excel's lifetime.</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; oXL.Visible = <span style="color: blue">true</span>;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; oXL.ScreenUpdating = <span style="color: blue">true</span>;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; oXL.UserControl = <span style="color: blue">true</span>;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: blue">catch</span> (<span style="color: #2b91af">Exception</span> theEx)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: #2b91af">MessageBox</span>.Show(theEx.Message, <span style="color: #a31515">"Error creating prodid sheet"</span>);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br /> <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; oRng = <span style="color: blue">null</span>;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; oTable = <span style="color: blue">null</span>;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; oTables = <span style="color: blue">null</span>;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; oSheets = <span style="color: blue">null</span>;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; oTemplateSheet = <span style="color: blue">null</span>;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; oWB = <span style="color: blue">null</span>;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; oWBS = <span style="color: blue">null</span>;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; oXL = <span style="color: blue">null</span>;<br /> <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</pre>
</div>