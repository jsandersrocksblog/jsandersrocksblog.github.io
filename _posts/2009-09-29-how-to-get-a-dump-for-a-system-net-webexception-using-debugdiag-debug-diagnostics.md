This information is available in the help file as well.&nbsp; For more options please refer to the Help Documentation include with DebugDiag.

Install the latest Debug Diagnostics from <http://download.microsoft.com> (search for Debug Diagnostics once on that site)

Configure a crash rule for all w3wp.exe processes (if this dialog does not appear simply press the &lsquo;Add Rule&hellip;&rsquo; button).

<a href="/assets/images/TNBlogsFS/BlogFileStorage/blogs_msdn/jpsanders/WindowsLiveWriter/How.WebExceptionusingDebugDiagDebugDiagn_8F59/image_2.png" original-url="http://blogs.msdn.com/blogfiles/jpsanders/WindowsLiveWriter/How.WebExceptionusingDebugDiagDebugDiagn_8F59/image_2.png"><img loading="lazy" style="display: inline; border: 0px;" title="image" border="0" alt="image" src="/assets/images/TNBlogsFS/BlogFileStorage/blogs_msdn/jpsanders/WindowsLiveWriter/How.WebExceptionusingDebugDiagDebugDiagn_8F59/image_thumb.png" original-url="http://blogs.msdn.com/blogfiles/jpsanders/WindowsLiveWriter/How.WebExceptionusingDebugDiagDebugDiagn_8F59/image_thumb.png" width="376" height="331" /></a>

Select &lsquo;A specific process&rsquo;

&nbsp;<a href="/assets/images/TNBlogsFS/BlogFileStorage/blogs_msdn/jpsanders/WindowsLiveWriter/How.WebExceptionusingDebugDiagDebugDiagn_8F59/image_4.png" original-url="http://blogs.msdn.com/blogfiles/jpsanders/WindowsLiveWriter/How.WebExceptionusingDebugDiagDebugDiagn_8F59/image_4.png"><img loading="lazy" style="display: inline; border: 0px;" title="image" border="0" alt="image" src="/assets/images/TNBlogsFS/BlogFileStorage/blogs_msdn/jpsanders/WindowsLiveWriter/How.WebExceptionusingDebugDiagDebugDiagn_8F59/image_thumb_1.png" original-url="http://blogs.msdn.com/blogfiles/jpsanders/WindowsLiveWriter/How.WebExceptionusingDebugDiagDebugDiagn_8F59/image_thumb_1.png" width="369" height="326" /></a>

Make sure you DO NOT check &lsquo;This process instance only&rsquo; and type in the process we wish to monitor (in this case asp.net is running in w3wp.exe).

<a href="/assets/images/TNBlogsFS/BlogFileStorage/blogs_msdn/jpsanders/WindowsLiveWriter/How.WebExceptionusingDebugDiagDebugDiagn_8F59/image_6.png" original-url="http://blogs.msdn.com/blogfiles/jpsanders/WindowsLiveWriter/How.WebExceptionusingDebugDiagDebugDiagn_8F59/image_6.png"><img loading="lazy" style="display: inline; border: 0px;" title="image" border="0" alt="image" src="/assets/images/TNBlogsFS/BlogFileStorage/blogs_msdn/jpsanders/WindowsLiveWriter/How.WebExceptionusingDebugDiagDebugDiagn_8F59/image_thumb_2.png" original-url="http://blogs.msdn.com/blogfiles/jpsanders/WindowsLiveWriter/How.WebExceptionusingDebugDiagDebugDiagn_8F59/image_thumb_2.png" width="373" height="328" /></a>

In the &lsquo;Advanced Configuration Dialog&rsquo; select the &#8216;Exceptions&#8230;&rsquo; button at the bottom of this dialog:

<a href="/assets/images/TNBlogsFS/BlogFileStorage/blogs_msdn/jpsanders/WindowsLiveWriter/How.WebExceptionusingDebugDiagDebugDiagn_8F59/image_8.png" original-url="http://blogs.msdn.com/blogfiles/jpsanders/WindowsLiveWriter/How.WebExceptionusingDebugDiagDebugDiagn_8F59/image_8.png"><img loading="lazy" style="display: inline; border: 0px;" title="image" border="0" alt="image" src="/assets/images/TNBlogsFS/BlogFileStorage/blogs_msdn/jpsanders/WindowsLiveWriter/How.WebExceptionusingDebugDiagDebugDiagn_8F59/image_thumb_3.png" original-url="http://blogs.msdn.com/blogfiles/jpsanders/WindowsLiveWriter/How.WebExceptionusingDebugDiagDebugDiagn_8F59/image_thumb_3.png" width="376" height="331" /></a>

Choose &lsquo;Add Exception&hellip;&rsquo;.&nbsp; Clicking this button will bring up the Configure Exception dialog.&nbsp; Use this to configure actions for a specific type of first chance exception.

<a href="/assets/images/TNBlogsFS/BlogFileStorage/blogs_msdn/jpsanders/WindowsLiveWriter/How.WebExceptionusingDebugDiagDebugDiagn_8F59/image_10.png" original-url="http://blogs.msdn.com/blogfiles/jpsanders/WindowsLiveWriter/How.WebExceptionusingDebugDiagDebugDiagn_8F59/image_10.png"><img loading="lazy" style="display: inline; border: 0px;" title="image" border="0" alt="image" src="/assets/images/TNBlogsFS/BlogFileStorage/blogs_msdn/jpsanders/WindowsLiveWriter/How.WebExceptionusingDebugDiagDebugDiagn_8F59/image_thumb_4.png" original-url="http://blogs.msdn.com/blogfiles/jpsanders/WindowsLiveWriter/How.WebExceptionusingDebugDiagDebugDiagn_8F59/image_thumb_4.png" width="374" height="243" /></a>

In the Configure Exception Dialog, Choose &#8216;CLR (.NET) Exception (NOTE: if debugging the 4.0 Framework<span style="color: #1f497d; font-family: 'Calibri','sans-serif'; font-size: 11pt; mso-fareast-font-family: Calibri; mso-fareast-theme-font: minor-latin; mso-ansi-language: EN-US; mso-fareast-language: EN-US; mso-bidi-language: AR-SA;"><br />you will need to configure </span><span style="color: black; font-family: 'MS Shell Dlg 2'; font-size: 9pt; mso-fareast-font-family: Calibri; mso-fareast-theme-font: minor-latin; mso-ansi-language: EN-US; mso-fareast-language: EN-US; mso-bidi-language: AR-SA; mso-bidi-font-family: Calibri;">E0434352 </span><span style="color: #1f497d; font-family: 'Calibri','sans-serif'; font-size: 11pt; mso-fareast-font-family: Calibri; mso-fareast-theme-font: minor-latin; mso-ansi-language: EN-US; mso-fareast-language: EN-US; mso-bidi-language: AR-SA;">as CLR (.Net) Exception code instead of E0434F4D)</span>

<a href="/assets/images/TNBlogsFS/BlogFileStorage/blogs_msdn/jpsanders/WindowsLiveWriter/How.WebExceptionusingDebugDiagDebugDiagn_8F59/image_12.png" original-url="http://blogs.msdn.com/blogfiles/jpsanders/WindowsLiveWriter/How.WebExceptionusingDebugDiagDebugDiagn_8F59/image_12.png"><img loading="lazy" style="display: inline; border: 0px;" title="image" border="0" alt="image" src="/assets/images/TNBlogsFS/BlogFileStorage/blogs_msdn/jpsanders/WindowsLiveWriter/How.WebExceptionusingDebugDiagDebugDiagn_8F59/image_thumb_5.png" original-url="http://blogs.msdn.com/blogfiles/jpsanders/WindowsLiveWriter/How.WebExceptionusingDebugDiagDebugDiagn_8F59/image_thumb_5.png" width="380" height="303" /></a>

For the &#8216;Net Exception Type&#8217; field: (This will only be available when choosing the E0434F4D CLR (.NET) Exception code)&nbsp;&nbsp; You must specify the exact name of the exception in this field.&nbsp; This field is case sensitive.&nbsp; In our case we want System.Net.WebException

<a href="/assets/images/TNBlogsFS/BlogFileStorage/blogs_msdn/jpsanders/WindowsLiveWriter/How.WebExceptionusingDebugDiagDebugDiagn_8F59/image_14.png" original-url="http://blogs.msdn.com/blogfiles/jpsanders/WindowsLiveWriter/How.WebExceptionusingDebugDiagDebugDiagn_8F59/image_14.png"><img loading="lazy" style="display: inline; border: 0px;" title="image" border="0" alt="image" src="/assets/images/TNBlogsFS/BlogFileStorage/blogs_msdn/jpsanders/WindowsLiveWriter/How.WebExceptionusingDebugDiagDebugDiagn_8F59/image_thumb_6.png" original-url="http://blogs.msdn.com/blogfiles/jpsanders/WindowsLiveWriter/How.WebExceptionusingDebugDiagDebugDiagn_8F59/image_thumb_6.png" width="382" height="305" /></a>

In the &lsquo;Action Type&rsquo; pull down specify &lsquo;Full User Dump&rsquo; and you will be able to capture the state when we have the 401 (or other) WebException in the w3wp.exe process.

<a href="/assets/images/TNBlogsFS/BlogFileStorage/blogs_msdn/jpsanders/WindowsLiveWriter/How.WebExceptionusingDebugDiagDebugDiagn_8F59/image_16.png" original-url="http://blogs.msdn.com/blogfiles/jpsanders/WindowsLiveWriter/How.WebExceptionusingDebugDiagDebugDiagn_8F59/image_16.png"><img loading="lazy" style="display: inline; border: 0px;" title="image" border="0" alt="image" src="/assets/images/TNBlogsFS/BlogFileStorage/blogs_msdn/jpsanders/WindowsLiveWriter/How.WebExceptionusingDebugDiagDebugDiagn_8F59/image_thumb_7.png" original-url="http://blogs.msdn.com/blogfiles/jpsanders/WindowsLiveWriter/How.WebExceptionusingDebugDiagDebugDiagn_8F59/image_thumb_7.png" width="385" height="308" /></a>

The &lsquo;Action Limit&rsquo; by default is set to 1.&nbsp; This means only one dump will be created.&nbsp; If you wish to catch more than one dump, increase this number (usually 3 is sufficient).&nbsp; Then hit OK and proceed by hitting the &lsquo;Save & Close&rsquo; button (note you will see the configured CLR exception now).

<a href="/assets/images/TNBlogsFS/BlogFileStorage/blogs_msdn/jpsanders/WindowsLiveWriter/How.WebExceptionusingDebugDiagDebugDiagn_8F59/image_18.png" original-url="http://blogs.msdn.com/blogfiles/jpsanders/WindowsLiveWriter/How.WebExceptionusingDebugDiagDebugDiagn_8F59/image_18.png"><img loading="lazy" style="display: inline; border: 0px;" title="image" border="0" alt="image" src="/assets/images/TNBlogsFS/BlogFileStorage/blogs_msdn/jpsanders/WindowsLiveWriter/How.WebExceptionusingDebugDiagDebugDiagn_8F59/image_thumb_8.png" original-url="http://blogs.msdn.com/blogfiles/jpsanders/WindowsLiveWriter/How.WebExceptionusingDebugDiagDebugDiagn_8F59/image_thumb_8.png" width="388" height="252" /></a>

Finally hit the &lsquo;Next >&rsquo; button twice and then &lsquo;Finish&rsquo;.&nbsp; The rule will be activated.

You do not need to keep the UI up for DebugDiag.&nbsp; If you do keep it up you will see the &lsquo;Userdump Count&rsquo; increase with each exception you encounter (up to the limit you set previously) and the location of the dump is listed as well.

<a href="/assets/images/TNBlogsFS/BlogFileStorage/blogs_msdn/jpsanders/WindowsLiveWriter/How.WebExceptionusingDebugDiagDebugDiagn_8F59/image_22.png" original-url="http://blogs.msdn.com/blogfiles/jpsanders/WindowsLiveWriter/How.WebExceptionusingDebugDiagDebugDiagn_8F59/image_22.png"><img loading="lazy" style="display: inline; border-width: 0px;" title="image" border="0" alt="image" src="/assets/images/TNBlogsFS/BlogFileStorage/blogs_msdn/jpsanders/WindowsLiveWriter/How.WebExceptionusingDebugDiagDebugDiagn_8F59/image_thumb_10.png" original-url="http://blogs.msdn.com/blogfiles/jpsanders/WindowsLiveWriter/How.WebExceptionusingDebugDiagDebugDiagn_8F59/image_thumb_10.png" width="523" height="116" /></a>

Finally to analyze the dump, you can use DebugDiag to analyze the script.&nbsp; You can use the special script I developed <a href="http://blogs.msdn.com/jpsanders/archive/2009/02/23/anaylyze-httpwebrequest-hangs-with-a-vb-debugdiag-script.aspx" target="_blank">here</a> to get a good picture of what the problem may be.

Please drop me a note and let me know if this Post helped you!