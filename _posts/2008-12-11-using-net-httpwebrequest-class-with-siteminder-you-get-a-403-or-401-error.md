<p class=MsoNormal style="MARGIN: 0in 0in 0pt"><span style="FONT-SIZE: 10pt; FONT-FAMILY: 'Arial','sans-serif'">Download Fiddler from <a href="http://fiddlertool.com/"><font color=#0000ff>http://fiddlertool.com</font></a> and run this for an Internet Explorer browser session that successfully connects.<?xml:namespace prefix = o ns = "urn:schemas-microsoft-com:office:office" /><o:p></o:p></span></p> <p class=MsoNormal style="MARGIN: 0in 0in 0pt">

<span style="FONT-SIZE: 10pt; FONT-FAMILY: 'Arial','sans-serif'"><o:p>&nbsp;</o:p></span></p> <p class=MsoNormal style="MARGIN: 0in 0in 0pt"><span style="FONT-SIZE: 10pt; FONT-FAMILY: 'Arial','sans-serif'">Then hit the same site with your .NET 2.0 client application and make sure you set the credentials in your code as well: <a href="http://msdn.microsoft.com/en-us/library/system.net.networkcredential.aspx"><font color=#0000ff>http://msdn.microsoft.com/en-us/library/system.net.networkcredential.aspx</font></a> &nbsp;(Note you can set myCreds directly on the Credentials property of the HttpWebRequest object&#8230; no need for the Credential Cache object, but it will not hurt anything).<o:p></o:p></span></p> <p class=MsoNormal style="MARGIN: 0in 0in 0pt"><span style="FONT-SIZE: 10pt; FONT-FAMILY: 'Arial','sans-serif'"><o:p>&nbsp;</o:p></span></p> <p class=MsoNormal style="MARGIN: 0in 0in 0pt"><span style="FONT-SIZE: 10pt; FONT-FAMILY: 'Arial','sans-serif'">Compare the two traces in Fiddler in the Sessions Tab on the right side.&nbsp; If the credentials are successfully passed you should see the 401 challenge from the site answered with the same Basic Authentication header (a base 64 encoded jumble of characters).&nbsp; If they are the same then you are passing the credentials correctly so what could be the problem?<o:p></o:p></span></p> <p class=MsoNormal style="MARGIN: 0in 0in 0pt"><span style="FONT-SIZE: 10pt; FONT-FAMILY: 'Arial','sans-serif'"><o:p>&nbsp;</o:p></span></p> <p class=MsoNormal style="MARGIN: 0in 0in 0pt"><span style="FONT-SIZE: 10pt; FONT-FAMILY: 'Arial','sans-serif'">Using my post on http troubleshooting: <a href="http://blogs.msdn.com/jpsanders/archive/2008/06/25/troubleshooting-code-that-uses-the-http-protocol.aspx">http://blogs.msdn.com/jpsanders/archive/2008/06/25/troubleshooting-code-that-uses-the-http-protocol.aspx</a><o:p></o:p></span></p> <p class=MsoNormal style="MARGIN: 0in 0in 0pt"><span style="FONT-SIZE: 10pt; FONT-FAMILY: 'Arial','sans-serif'"><o:p>&nbsp;</o:p></span></p> <p class=MsoNormal style="MARGIN: 0in 0in 0pt"><span style="FONT-SIZE: 10pt; FONT-FAMILY: 'Arial','sans-serif'"><o:p>&nbsp;</o:p></span></p> <p class=MsoNormal style="MARGIN: 0in 0in 0pt"><span style="FONT-SIZE: 10pt; FONT-FAMILY: 'Arial','sans-serif'">to simplify the issue you will see no Cookies in the failed case.&nbsp; What is going on?<o:p></o:p></span></p> <p class=MsoNormal style="MARGIN: 0in 0in 0pt"><span style="FONT-SIZE: 10pt; FONT-FAMILY: 'Arial','sans-serif'"><o:p>&nbsp;</o:p></span></p> <p class=MsoNormal style="MARGIN: 0in 0in 0pt"><span style="FONT-SIZE: 10pt; FONT-FAMILY: 'Arial','sans-serif'">The .NET classes do not implement a cookie container by default and if you wish to use cookies, you need to provide a cookie container.&nbsp; You may want to make this container global to your app or simply local to the function (this is your design decision).&nbsp; Here is the documentation:<o:p></o:p></span></p> <p class=MsoNormal style="MARGIN: 0in 0in 0pt"><span style="FONT-SIZE: 10pt; FONT-FAMILY: 'Arial','sans-serif'"><a href="http://msdn.microsoft.com/en-us/library/system.net.httpwebrequest.cookiecontainer.aspx"><font color=#0000ff>http://msdn.microsoft.com/en-us/library/system.net.httpwebrequest.cookiecontainer.aspx</font></a> <o:p></o:p></span></p> <p class=MsoNormal style="MARGIN: 0in 0in 0pt"><span style="FONT-SIZE: 10pt; FONT-FAMILY: 'Arial','sans-serif'"><o:p>&nbsp;</o:p></span></p> <p class=MsoNormal style="MARGIN: 0in 0in 0pt"><span style="FONT-SIZE: 10pt; FONT-FAMILY: 'Arial','sans-serif'">Implement the container and use Fiddler once again if it does not work to ensure the successful and failed cases send the exact same data (hint they do not send the same headers and data if this fails still).<o:p></o:p></span></p> <p class=MsoNormal style="MARGIN: 0in 0in 0pt"><span style="COLOR: #1f497d"><o:p><font face=Calibri size=3>&nbsp;</font></o:p></span></p>