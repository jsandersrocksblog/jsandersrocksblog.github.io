---
id: 1123
title: Workaround For WinInet DNS not refreshing when using KB 263558
date: 2008-11-14T09:45:00-05:00
author: jsanders
layout: post
guid: http://jsandersblog.azurewebsites.net/2008/11/14/workaround-for-wininet-dns-not-refreshing-when-using-kb-263558/
permalink: /2008/11/14/workaround-for-wininet-dns-not-refreshing-when-using-kb-263558/
orig_url:
  - http://blogs.msdn.microsoft.com/b/jpsanders/archive/2008/11/14/workaround-for-wininet-dns-not-refreshing-when-using-kb-263558.aspx
  - http://blogs.msdn.microsoft.com/b/jpsanders/archive/2008/11/14/workaround-for-wininet-dns-not-refreshing-when-using-kb-263558.aspx
  - http://blogs.msdn.microsoft.com/b/jpsanders/archive/2008/11/14/workaround-for-wininet-dns-not-refreshing-when-using-kb-263558.aspx
  - http://blogs.msdn.microsoft.com/b/jpsanders/archive/2008/11/14/workaround-for-wininet-dns-not-refreshing-when-using-kb-263558.aspx
  - http://blogs.msdn.microsoft.com/b/jpsanders/archive/2008/11/14/workaround-for-wininet-dns-not-refreshing-when-using-kb-263558.aspx
  - http://blogs.msdn.microsoft.com/b/jpsanders/archive/2008/11/14/workaround-for-wininet-dns-not-refreshing-when-using-kb-263558.aspx
  - http://blogs.msdn.microsoft.com/b/jpsanders/archive/2008/11/14/workaround-for-wininet-dns-not-refreshing-when-using-kb-263558.aspx
  - http://blogs.msdn.microsoft.com/b/jpsanders/archive/2008/11/14/workaround-for-wininet-dns-not-refreshing-when-using-kb-263558.aspx
  - http://blogs.msdn.microsoft.com/b/jpsanders/archive/2008/11/14/workaround-for-wininet-dns-not-refreshing-when-using-kb-263558.aspx
  - http://blogs.msdn.microsoft.com/b/jpsanders/archive/2008/11/14/workaround-for-wininet-dns-not-refreshing-when-using-kb-263558.aspx
orig_site_id:
  - "8394"
  - "8394"
  - "8394"
  - "8394"
  - "8394"
  - "8394"
  - "8394"
  - "8394"
  - "8394"
  - "8394"
orig_post_id:
  - "9072245"
  - "9072245"
  - "9072245"
  - "9072245"
  - "9072245"
  - "9072245"
  - "9072245"
  - "9072245"
  - "9072245"
  - "9072245"
orig_parent_id:
  - "9072245"
  - "9072245"
  - "9072245"
  - "9072245"
  - "9072245"
  - "9072245"
  - "9072245"
  - "9072245"
  - "9072245"
  - "9072245"
orig_thread_id:
  - "618937"
  - "618937"
  - "618937"
  - "618937"
  - "618937"
  - "618937"
  - "618937"
  - "618937"
  - "618937"
  - "618937"
orig_application_key:
  - jpsanders
  - jpsanders
  - jpsanders
  - jpsanders
  - jpsanders
  - jpsanders
  - jpsanders
  - jpsanders
  - jpsanders
  - jpsanders
orig_post_author_id:
  - "65385"
  - "65385"
  - "65385"
  - "65385"
  - "65385"
  - "65385"
  - "65385"
  - "65385"
  - "65385"
  - "65385"
orig_post_author_username:
  - jpsanders
  - jpsanders
  - jpsanders
  - jpsanders
  - jpsanders
  - jpsanders
  - jpsanders
  - jpsanders
  - jpsanders
  - jpsanders
orig_post_author_created:
  - Jan 18 2007 01:34:53:000PM
  - Jan 18 2007 01:34:53:000PM
  - Jan 18 2007 01:34:53:000PM
  - Jan 18 2007 01:34:53:000PM
  - Jan 18 2007 01:34:53:000PM
  - Jan 18 2007 01:34:53:000PM
  - Jan 18 2007 01:34:53:000PM
  - Jan 18 2007 01:34:53:000PM
  - Jan 18 2007 01:34:53:000PM
  - Jan 18 2007 01:34:53:000PM
orig_is_approved:
  - "1"
  - "1"
  - "1"
  - "1"
  - "1"
  - "1"
  - "1"
  - "1"
  - "1"
  - "1"
orig_attachment_count:
  - "0"
  - "0"
  - "0"
  - "0"
  - "0"
  - "0"
  - "0"
  - "0"
  - "0"
  - "0"
orig_url_title:
  - http://blogs.msdn.com/b/jpsanders/archive/2008/11/14/workaround-for-wininet-dns-not-refreshing-when-using-kb-263558.aspx
  - http://blogs.msdn.com/b/jpsanders/archive/2008/11/14/workaround-for-wininet-dns-not-refreshing-when-using-kb-263558.aspx
  - http://blogs.msdn.com/b/jpsanders/archive/2008/11/14/workaround-for-wininet-dns-not-refreshing-when-using-kb-263558.aspx
  - http://blogs.msdn.com/b/jpsanders/archive/2008/11/14/workaround-for-wininet-dns-not-refreshing-when-using-kb-263558.aspx
  - http://blogs.msdn.com/b/jpsanders/archive/2008/11/14/workaround-for-wininet-dns-not-refreshing-when-using-kb-263558.aspx
  - http://blogs.msdn.com/b/jpsanders/archive/2008/11/14/workaround-for-wininet-dns-not-refreshing-when-using-kb-263558.aspx
  - http://blogs.msdn.com/b/jpsanders/archive/2008/11/14/workaround-for-wininet-dns-not-refreshing-when-using-kb-263558.aspx
  - http://blogs.msdn.com/b/jpsanders/archive/2008/11/14/workaround-for-wininet-dns-not-refreshing-when-using-kb-263558.aspx
  - http://blogs.msdn.com/b/jpsanders/archive/2008/11/14/workaround-for-wininet-dns-not-refreshing-when-using-kb-263558.aspx
  - http://blogs.msdn.com/b/jpsanders/archive/2008/11/14/workaround-for-wininet-dns-not-refreshing-when-using-kb-263558.aspx
opengraph_tags:
  - |
    <meta property="og:type" content="article" />
    <meta property="og:title" content="Workaround For WinInet DNS not refreshing when using KB 263558" />
    <meta property="og:url" content="https://blogs.msdn.microsoft.com/jpsanders/2008/11/14/workaround-for-wininet-dns-not-refreshing-when-using-kb-263558/" />
    <meta property="og:site_name" content="Http Client Protocol Issues (and other fun stuff I support)" />
    <meta property="og:description" content="If you are making Synchronous calls in WinInet, the DNS timeouts don&#8217;t appear to work when set (see: http://support.microsoft.com/kb/263558&nbsp;). Async calls do however work correctly. One workaround is to simply restart the&nbsp;application&nbsp;using WinInet.&nbsp; I found a code workaround for the issue as well.&nbsp; Simply open and close the handle you get with the InternetOpen call..." />
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="Workaround For WinInet DNS not refreshing when using KB 263558" />
    <meta name="twitter:url" content="https://blogs.msdn.microsoft.com/jpsanders/2008/11/14/workaround-for-wininet-dns-not-refreshing-when-using-kb-263558/" />
    <meta name="twitter:description" content="If you are making Synchronous calls in WinInet, the DNS timeouts don&#8217;t appear to work when set (see: http://support.microsoft.com/kb/263558&nbsp;). Async calls do however work correctly. One workaround is to simply restart the&nbsp;application&nbsp;using WinInet.&nbsp; I found a code workaround for the issue as well.&nbsp; Simply open and close the handle you get with the InternetOpen call..." />
    
  - |
    <meta property="og:type" content="article" />
    <meta property="og:title" content="Workaround For WinInet DNS not refreshing when using KB 263558" />
    <meta property="og:url" content="https://blogs.msdn.microsoft.com/jpsanders/2008/11/14/workaround-for-wininet-dns-not-refreshing-when-using-kb-263558/" />
    <meta property="og:site_name" content="Http Client Protocol Issues (and other fun stuff I support)" />
    <meta property="og:description" content="If you are making Synchronous calls in WinInet, the DNS timeouts don&#8217;t appear to work when set (see: http://support.microsoft.com/kb/263558&nbsp;). Async calls do however work correctly. One workaround is to simply restart the&nbsp;application&nbsp;using WinInet.&nbsp; I found a code workaround for the issue as well.&nbsp; Simply open and close the handle you get with the InternetOpen call..." />
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="Workaround For WinInet DNS not refreshing when using KB 263558" />
    <meta name="twitter:url" content="https://blogs.msdn.microsoft.com/jpsanders/2008/11/14/workaround-for-wininet-dns-not-refreshing-when-using-kb-263558/" />
    <meta name="twitter:description" content="If you are making Synchronous calls in WinInet, the DNS timeouts don&#8217;t appear to work when set (see: http://support.microsoft.com/kb/263558&nbsp;). Async calls do however work correctly. One workaround is to simply restart the&nbsp;application&nbsp;using WinInet.&nbsp; I found a code workaround for the issue as well.&nbsp; Simply open and close the handle you get with the InternetOpen call..." />
    
  - |
    <meta property="og:type" content="article" />
    <meta property="og:title" content="Workaround For WinInet DNS not refreshing when using KB 263558" />
    <meta property="og:url" content="https://blogs.msdn.microsoft.com/jpsanders/2008/11/14/workaround-for-wininet-dns-not-refreshing-when-using-kb-263558/" />
    <meta property="og:site_name" content="Http Client Protocol Issues (and other fun stuff I support)" />
    <meta property="og:description" content="If you are making Synchronous calls in WinInet, the DNS timeouts don&#8217;t appear to work when set (see: http://support.microsoft.com/kb/263558&nbsp;). Async calls do however work correctly. One workaround is to simply restart the&nbsp;application&nbsp;using WinInet.&nbsp; I found a code workaround for the issue as well.&nbsp; Simply open and close the handle you get with the InternetOpen call..." />
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="Workaround For WinInet DNS not refreshing when using KB 263558" />
    <meta name="twitter:url" content="https://blogs.msdn.microsoft.com/jpsanders/2008/11/14/workaround-for-wininet-dns-not-refreshing-when-using-kb-263558/" />
    <meta name="twitter:description" content="If you are making Synchronous calls in WinInet, the DNS timeouts don&#8217;t appear to work when set (see: http://support.microsoft.com/kb/263558&nbsp;). Async calls do however work correctly. One workaround is to simply restart the&nbsp;application&nbsp;using WinInet.&nbsp; I found a code workaround for the issue as well.&nbsp; Simply open and close the handle you get with the InternetOpen call..." />
    
  - |
    <meta property="og:type" content="article" />
    <meta property="og:title" content="Workaround For WinInet DNS not refreshing when using KB 263558" />
    <meta property="og:url" content="https://blogs.msdn.microsoft.com/jpsanders/2008/11/14/workaround-for-wininet-dns-not-refreshing-when-using-kb-263558/" />
    <meta property="og:site_name" content="Http Client Protocol Issues (and other fun stuff I support)" />
    <meta property="og:description" content="If you are making Synchronous calls in WinInet, the DNS timeouts don&#8217;t appear to work when set (see: http://support.microsoft.com/kb/263558&nbsp;). Async calls do however work correctly. One workaround is to simply restart the&nbsp;application&nbsp;using WinInet.&nbsp; I found a code workaround for the issue as well.&nbsp; Simply open and close the handle you get with the InternetOpen call..." />
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="Workaround For WinInet DNS not refreshing when using KB 263558" />
    <meta name="twitter:url" content="https://blogs.msdn.microsoft.com/jpsanders/2008/11/14/workaround-for-wininet-dns-not-refreshing-when-using-kb-263558/" />
    <meta name="twitter:description" content="If you are making Synchronous calls in WinInet, the DNS timeouts don&#8217;t appear to work when set (see: http://support.microsoft.com/kb/263558&nbsp;). Async calls do however work correctly. One workaround is to simply restart the&nbsp;application&nbsp;using WinInet.&nbsp; I found a code workaround for the issue as well.&nbsp; Simply open and close the handle you get with the InternetOpen call..." />
    
  - |
    <meta property="og:type" content="article" />
    <meta property="og:title" content="Workaround For WinInet DNS not refreshing when using KB 263558" />
    <meta property="og:url" content="https://blogs.msdn.microsoft.com/jpsanders/2008/11/14/workaround-for-wininet-dns-not-refreshing-when-using-kb-263558/" />
    <meta property="og:site_name" content="Http Client Protocol Issues (and other fun stuff I support)" />
    <meta property="og:description" content="If you are making Synchronous calls in WinInet, the DNS timeouts don&#8217;t appear to work when set (see: http://support.microsoft.com/kb/263558&nbsp;). Async calls do however work correctly. One workaround is to simply restart the&nbsp;application&nbsp;using WinInet.&nbsp; I found a code workaround for the issue as well.&nbsp; Simply open and close the handle you get with the InternetOpen call..." />
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="Workaround For WinInet DNS not refreshing when using KB 263558" />
    <meta name="twitter:url" content="https://blogs.msdn.microsoft.com/jpsanders/2008/11/14/workaround-for-wininet-dns-not-refreshing-when-using-kb-263558/" />
    <meta name="twitter:description" content="If you are making Synchronous calls in WinInet, the DNS timeouts don&#8217;t appear to work when set (see: http://support.microsoft.com/kb/263558&nbsp;). Async calls do however work correctly. One workaround is to simply restart the&nbsp;application&nbsp;using WinInet.&nbsp; I found a code workaround for the issue as well.&nbsp; Simply open and close the handle you get with the InternetOpen call..." />
    
  - |
    <meta property="og:type" content="article" />
    <meta property="og:title" content="Workaround For WinInet DNS not refreshing when using KB 263558" />
    <meta property="og:url" content="https://blogs.msdn.microsoft.com/jpsanders/2008/11/14/workaround-for-wininet-dns-not-refreshing-when-using-kb-263558/" />
    <meta property="og:site_name" content="Http Client Protocol Issues (and other fun stuff I support)" />
    <meta property="og:description" content="If you are making Synchronous calls in WinInet, the DNS timeouts don&#8217;t appear to work when set (see: http://support.microsoft.com/kb/263558&nbsp;). Async calls do however work correctly. One workaround is to simply restart the&nbsp;application&nbsp;using WinInet.&nbsp; I found a code workaround for the issue as well.&nbsp; Simply open and close the handle you get with the InternetOpen call..." />
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="Workaround For WinInet DNS not refreshing when using KB 263558" />
    <meta name="twitter:url" content="https://blogs.msdn.microsoft.com/jpsanders/2008/11/14/workaround-for-wininet-dns-not-refreshing-when-using-kb-263558/" />
    <meta name="twitter:description" content="If you are making Synchronous calls in WinInet, the DNS timeouts don&#8217;t appear to work when set (see: http://support.microsoft.com/kb/263558&nbsp;). Async calls do however work correctly. One workaround is to simply restart the&nbsp;application&nbsp;using WinInet.&nbsp; I found a code workaround for the issue as well.&nbsp; Simply open and close the handle you get with the InternetOpen call..." />
    
  - |
    <meta property="og:type" content="article" />
    <meta property="og:title" content="Workaround For WinInet DNS not refreshing when using KB 263558" />
    <meta property="og:url" content="https://blogs.msdn.microsoft.com/jpsanders/2008/11/14/workaround-for-wininet-dns-not-refreshing-when-using-kb-263558/" />
    <meta property="og:site_name" content="Http Client Protocol Issues (and other fun stuff I support)" />
    <meta property="og:description" content="If you are making Synchronous calls in WinInet, the DNS timeouts don&#8217;t appear to work when set (see: http://support.microsoft.com/kb/263558&nbsp;). Async calls do however work correctly. One workaround is to simply restart the&nbsp;application&nbsp;using WinInet.&nbsp; I found a code workaround for the issue as well.&nbsp; Simply open and close the handle you get with the InternetOpen call..." />
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="Workaround For WinInet DNS not refreshing when using KB 263558" />
    <meta name="twitter:url" content="https://blogs.msdn.microsoft.com/jpsanders/2008/11/14/workaround-for-wininet-dns-not-refreshing-when-using-kb-263558/" />
    <meta name="twitter:description" content="If you are making Synchronous calls in WinInet, the DNS timeouts don&#8217;t appear to work when set (see: http://support.microsoft.com/kb/263558&nbsp;). Async calls do however work correctly. One workaround is to simply restart the&nbsp;application&nbsp;using WinInet.&nbsp; I found a code workaround for the issue as well.&nbsp; Simply open and close the handle you get with the InternetOpen call..." />
    
  - |
    <meta property="og:type" content="article" />
    <meta property="og:title" content="Workaround For WinInet DNS not refreshing when using KB 263558" />
    <meta property="og:url" content="https://blogs.msdn.microsoft.com/jpsanders/2008/11/14/workaround-for-wininet-dns-not-refreshing-when-using-kb-263558/" />
    <meta property="og:site_name" content="Http Client Protocol Issues (and other fun stuff I support)" />
    <meta property="og:description" content="If you are making Synchronous calls in WinInet, the DNS timeouts don&#8217;t appear to work when set (see: http://support.microsoft.com/kb/263558&nbsp;). Async calls do however work correctly. One workaround is to simply restart the&nbsp;application&nbsp;using WinInet.&nbsp; I found a code workaround for the issue as well.&nbsp; Simply open and close the handle you get with the InternetOpen call..." />
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="Workaround For WinInet DNS not refreshing when using KB 263558" />
    <meta name="twitter:url" content="https://blogs.msdn.microsoft.com/jpsanders/2008/11/14/workaround-for-wininet-dns-not-refreshing-when-using-kb-263558/" />
    <meta name="twitter:description" content="If you are making Synchronous calls in WinInet, the DNS timeouts don&#8217;t appear to work when set (see: http://support.microsoft.com/kb/263558&nbsp;). Async calls do however work correctly. One workaround is to simply restart the&nbsp;application&nbsp;using WinInet.&nbsp; I found a code workaround for the issue as well.&nbsp; Simply open and close the handle you get with the InternetOpen call..." />
    
  - |
    <meta property="og:type" content="article" />
    <meta property="og:title" content="Workaround For WinInet DNS not refreshing when using KB 263558" />
    <meta property="og:url" content="https://blogs.msdn.microsoft.com/jpsanders/2008/11/14/workaround-for-wininet-dns-not-refreshing-when-using-kb-263558/" />
    <meta property="og:site_name" content="Http Client Protocol Issues (and other fun stuff I support)" />
    <meta property="og:description" content="If you are making Synchronous calls in WinInet, the DNS timeouts don&#8217;t appear to work when set (see: http://support.microsoft.com/kb/263558&nbsp;). Async calls do however work correctly. One workaround is to simply restart the&nbsp;application&nbsp;using WinInet.&nbsp; I found a code workaround for the issue as well.&nbsp; Simply open and close the handle you get with the InternetOpen call..." />
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="Workaround For WinInet DNS not refreshing when using KB 263558" />
    <meta name="twitter:url" content="https://blogs.msdn.microsoft.com/jpsanders/2008/11/14/workaround-for-wininet-dns-not-refreshing-when-using-kb-263558/" />
    <meta name="twitter:description" content="If you are making Synchronous calls in WinInet, the DNS timeouts don&#8217;t appear to work when set (see: http://support.microsoft.com/kb/263558&nbsp;). Async calls do however work correctly. One workaround is to simply restart the&nbsp;application&nbsp;using WinInet.&nbsp; I found a code workaround for the issue as well.&nbsp; Simply open and close the handle you get with the InternetOpen call..." />
    
  - |
    <meta property="og:type" content="article" />
    <meta property="og:title" content="Workaround For WinInet DNS not refreshing when using KB 263558" />
    <meta property="og:url" content="https://blogs.msdn.microsoft.com/jpsanders/2008/11/14/workaround-for-wininet-dns-not-refreshing-when-using-kb-263558/" />
    <meta property="og:site_name" content="Http Client Protocol Issues (and other fun stuff I support)" />
    <meta property="og:description" content="If you are making Synchronous calls in WinInet, the DNS timeouts don&#8217;t appear to work when set (see: http://support.microsoft.com/kb/263558&nbsp;). Async calls do however work correctly. One workaround is to simply restart the&nbsp;application&nbsp;using WinInet.&nbsp; I found a code workaround for the issue as well.&nbsp; Simply open and close the handle you get with the InternetOpen call..." />
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="Workaround For WinInet DNS not refreshing when using KB 263558" />
    <meta name="twitter:url" content="https://blogs.msdn.microsoft.com/jpsanders/2008/11/14/workaround-for-wininet-dns-not-refreshing-when-using-kb-263558/" />
    <meta name="twitter:description" content="If you are making Synchronous calls in WinInet, the DNS timeouts don&#8217;t appear to work when set (see: http://support.microsoft.com/kb/263558&nbsp;). Async calls do however work correctly. One workaround is to simply restart the&nbsp;application&nbsp;using WinInet.&nbsp; I found a code workaround for the issue as well.&nbsp; Simply open and close the handle you get with the InternetOpen call..." />
    
categories:
  - Uncategorized
tags:
  - WinInet
---
If you are making Synchronous calls in WinInet, the DNS timeouts don&#8217;t appear to work when set (see: <a href="http://support.microsoft.com/kb/263558" mce_href="http://support.microsoft.com/kb/263558">http://support.microsoft.com/kb/263558</a>&nbsp;).

Async calls do however work correctly.

One workaround is to simply restart the&nbsp;application&nbsp;using WinInet.&nbsp;

I found a code workaround for the issue as well.&nbsp; Simply open and close the handle you get with the InternetOpen call then open it again:

hOpen= ::InternetOpen(&#8230;..);

InternetCloseHandle(hOpen);

hOpen= ::InternetOpen(&#8230;..);

// now use handle&#8230;

&nbsp;The performance impact will be very low.

&nbsp;-Jeff