---
id: 953
title: How to get Certificate Information Using WinInet APIs
date: 2009-04-17T07:10:00-05:00
author: jsanders
layout: post
guid: http://jsandersblog.azurewebsites.net/2009/04/17/how-to-get-certificate-information-using-wininet-apis/
permalink: /2009/04/17/how-to-get-certificate-information-using-wininet-apis/
orig_url:
  - http://blogs.msdn.microsoft.com/b/jpsanders/archive/2009/04/17/how-to-get-certificate-information-using-wininet-apis.aspx
  - http://blogs.msdn.microsoft.com/b/jpsanders/archive/2009/04/17/how-to-get-certificate-information-using-wininet-apis.aspx
  - http://blogs.msdn.microsoft.com/b/jpsanders/archive/2009/04/17/how-to-get-certificate-information-using-wininet-apis.aspx
  - http://blogs.msdn.microsoft.com/b/jpsanders/archive/2009/04/17/how-to-get-certificate-information-using-wininet-apis.aspx
  - http://blogs.msdn.microsoft.com/b/jpsanders/archive/2009/04/17/how-to-get-certificate-information-using-wininet-apis.aspx
  - http://blogs.msdn.microsoft.com/b/jpsanders/archive/2009/04/17/how-to-get-certificate-information-using-wininet-apis.aspx
  - http://blogs.msdn.microsoft.com/b/jpsanders/archive/2009/04/17/how-to-get-certificate-information-using-wininet-apis.aspx
  - http://blogs.msdn.microsoft.com/b/jpsanders/archive/2009/04/17/how-to-get-certificate-information-using-wininet-apis.aspx
  - http://blogs.msdn.microsoft.com/b/jpsanders/archive/2009/04/17/how-to-get-certificate-information-using-wininet-apis.aspx
  - http://blogs.msdn.microsoft.com/b/jpsanders/archive/2009/04/17/how-to-get-certificate-information-using-wininet-apis.aspx
orig_site_id:
  - "8394"
  - "8394"
  - "8394"
  - "8394"
  - "8394"
  - "8394"
  - "8394"
  - "8394"
  - "8394"
  - "8394"
orig_post_id:
  - "9538205"
  - "9538205"
  - "9538205"
  - "9538205"
  - "9538205"
  - "9538205"
  - "9538205"
  - "9538205"
  - "9538205"
  - "9538205"
orig_parent_id:
  - "9538205"
  - "9538205"
  - "9538205"
  - "9538205"
  - "9538205"
  - "9538205"
  - "9538205"
  - "9538205"
  - "9538205"
  - "9538205"
orig_thread_id:
  - "647647"
  - "647647"
  - "647647"
  - "647647"
  - "647647"
  - "647647"
  - "647647"
  - "647647"
  - "647647"
  - "647647"
orig_application_key:
  - jpsanders
  - jpsanders
  - jpsanders
  - jpsanders
  - jpsanders
  - jpsanders
  - jpsanders
  - jpsanders
  - jpsanders
  - jpsanders
orig_post_author_id:
  - "65385"
  - "65385"
  - "65385"
  - "65385"
  - "65385"
  - "65385"
  - "65385"
  - "65385"
  - "65385"
  - "65385"
orig_post_author_username:
  - jpsanders
  - jpsanders
  - jpsanders
  - jpsanders
  - jpsanders
  - jpsanders
  - jpsanders
  - jpsanders
  - jpsanders
  - jpsanders
orig_post_author_created:
  - Jan 18 2007 01:34:53:000PM
  - Jan 18 2007 01:34:53:000PM
  - Jan 18 2007 01:34:53:000PM
  - Jan 18 2007 01:34:53:000PM
  - Jan 18 2007 01:34:53:000PM
  - Jan 18 2007 01:34:53:000PM
  - Jan 18 2007 01:34:53:000PM
  - Jan 18 2007 01:34:53:000PM
  - Jan 18 2007 01:34:53:000PM
  - Jan 18 2007 01:34:53:000PM
orig_is_approved:
  - "1"
  - "1"
  - "1"
  - "1"
  - "1"
  - "1"
  - "1"
  - "1"
  - "1"
  - "1"
orig_attachment_count:
  - "0"
  - "0"
  - "0"
  - "0"
  - "0"
  - "0"
  - "0"
  - "0"
  - "0"
  - "0"
orig_url_title:
  - http://blogs.msdn.com/b/jpsanders/archive/2009/04/17/how-to-get-certificate-information-using-wininet-apis.aspx
  - http://blogs.msdn.com/b/jpsanders/archive/2009/04/17/how-to-get-certificate-information-using-wininet-apis.aspx
  - http://blogs.msdn.com/b/jpsanders/archive/2009/04/17/how-to-get-certificate-information-using-wininet-apis.aspx
  - http://blogs.msdn.com/b/jpsanders/archive/2009/04/17/how-to-get-certificate-information-using-wininet-apis.aspx
  - http://blogs.msdn.com/b/jpsanders/archive/2009/04/17/how-to-get-certificate-information-using-wininet-apis.aspx
  - http://blogs.msdn.com/b/jpsanders/archive/2009/04/17/how-to-get-certificate-information-using-wininet-apis.aspx
  - http://blogs.msdn.com/b/jpsanders/archive/2009/04/17/how-to-get-certificate-information-using-wininet-apis.aspx
  - http://blogs.msdn.com/b/jpsanders/archive/2009/04/17/how-to-get-certificate-information-using-wininet-apis.aspx
  - http://blogs.msdn.com/b/jpsanders/archive/2009/04/17/how-to-get-certificate-information-using-wininet-apis.aspx
  - http://blogs.msdn.com/b/jpsanders/archive/2009/04/17/how-to-get-certificate-information-using-wininet-apis.aspx
opengraph_tags:
  - |
    <meta property="og:type" content="article" />
    <meta property="og:title" content="How to get Certificate Information Using WinInet APIs" />
    <meta property="og:url" content="https://blogs.msdn.microsoft.com/jpsanders/2009/04/17/how-to-get-certificate-information-using-wininet-apis/" />
    <meta property="og:site_name" content="Http Client Protocol Issues (and other fun stuff I support)" />
    <meta property="og:description" content="There are two different structures you can query in order to retrieve server certificate information.  You must do some sort of request to complete the SSL server certificate exchange, and then you can retrieve this information.  Here is an example of that technique. C++ code listing for sample (Copy Code): // CertificateInfo.cpp : Defines the..." />
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="How to get Certificate Information Using WinInet APIs" />
    <meta name="twitter:url" content="https://blogs.msdn.microsoft.com/jpsanders/2009/04/17/how-to-get-certificate-information-using-wininet-apis/" />
    <meta name="twitter:description" content="There are two different structures you can query in order to retrieve server certificate information.  You must do some sort of request to complete the SSL server certificate exchange, and then you can retrieve this information.  Here is an example of that technique. C++ code listing for sample (Copy Code): // CertificateInfo.cpp : Defines the..." />
    
  - |
    <meta property="og:type" content="article" />
    <meta property="og:title" content="How to get Certificate Information Using WinInet APIs" />
    <meta property="og:url" content="https://blogs.msdn.microsoft.com/jpsanders/2009/04/17/how-to-get-certificate-information-using-wininet-apis/" />
    <meta property="og:site_name" content="Http Client Protocol Issues (and other fun stuff I support)" />
    <meta property="og:description" content="There are two different structures you can query in order to retrieve server certificate information.  You must do some sort of request to complete the SSL server certificate exchange, and then you can retrieve this information.  Here is an example of that technique. C++ code listing for sample (Copy Code): // CertificateInfo.cpp : Defines the..." />
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="How to get Certificate Information Using WinInet APIs" />
    <meta name="twitter:url" content="https://blogs.msdn.microsoft.com/jpsanders/2009/04/17/how-to-get-certificate-information-using-wininet-apis/" />
    <meta name="twitter:description" content="There are two different structures you can query in order to retrieve server certificate information.  You must do some sort of request to complete the SSL server certificate exchange, and then you can retrieve this information.  Here is an example of that technique. C++ code listing for sample (Copy Code): // CertificateInfo.cpp : Defines the..." />
    
  - |
    <meta property="og:type" content="article" />
    <meta property="og:title" content="How to get Certificate Information Using WinInet APIs" />
    <meta property="og:url" content="https://blogs.msdn.microsoft.com/jpsanders/2009/04/17/how-to-get-certificate-information-using-wininet-apis/" />
    <meta property="og:site_name" content="Http Client Protocol Issues (and other fun stuff I support)" />
    <meta property="og:description" content="There are two different structures you can query in order to retrieve server certificate information.  You must do some sort of request to complete the SSL server certificate exchange, and then you can retrieve this information.  Here is an example of that technique. C++ code listing for sample (Copy Code): // CertificateInfo.cpp : Defines the..." />
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="How to get Certificate Information Using WinInet APIs" />
    <meta name="twitter:url" content="https://blogs.msdn.microsoft.com/jpsanders/2009/04/17/how-to-get-certificate-information-using-wininet-apis/" />
    <meta name="twitter:description" content="There are two different structures you can query in order to retrieve server certificate information.  You must do some sort of request to complete the SSL server certificate exchange, and then you can retrieve this information.  Here is an example of that technique. C++ code listing for sample (Copy Code): // CertificateInfo.cpp : Defines the..." />
    
  - |
    <meta property="og:type" content="article" />
    <meta property="og:title" content="How to get Certificate Information Using WinInet APIs" />
    <meta property="og:url" content="https://blogs.msdn.microsoft.com/jpsanders/2009/04/17/how-to-get-certificate-information-using-wininet-apis/" />
    <meta property="og:site_name" content="Http Client Protocol Issues (and other fun stuff I support)" />
    <meta property="og:description" content="There are two different structures you can query in order to retrieve server certificate information.  You must do some sort of request to complete the SSL server certificate exchange, and then you can retrieve this information.  Here is an example of that technique. C++ code listing for sample (Copy Code): // CertificateInfo.cpp : Defines the..." />
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="How to get Certificate Information Using WinInet APIs" />
    <meta name="twitter:url" content="https://blogs.msdn.microsoft.com/jpsanders/2009/04/17/how-to-get-certificate-information-using-wininet-apis/" />
    <meta name="twitter:description" content="There are two different structures you can query in order to retrieve server certificate information.  You must do some sort of request to complete the SSL server certificate exchange, and then you can retrieve this information.  Here is an example of that technique. C++ code listing for sample (Copy Code): // CertificateInfo.cpp : Defines the..." />
    
  - |
    <meta property="og:type" content="article" />
    <meta property="og:title" content="How to get Certificate Information Using WinInet APIs" />
    <meta property="og:url" content="https://blogs.msdn.microsoft.com/jpsanders/2009/04/17/how-to-get-certificate-information-using-wininet-apis/" />
    <meta property="og:site_name" content="Http Client Protocol Issues (and other fun stuff I support)" />
    <meta property="og:description" content="There are two different structures you can query in order to retrieve server certificate information.  You must do some sort of request to complete the SSL server certificate exchange, and then you can retrieve this information.  Here is an example of that technique. C++ code listing for sample (Copy Code): // CertificateInfo.cpp : Defines the..." />
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="How to get Certificate Information Using WinInet APIs" />
    <meta name="twitter:url" content="https://blogs.msdn.microsoft.com/jpsanders/2009/04/17/how-to-get-certificate-information-using-wininet-apis/" />
    <meta name="twitter:description" content="There are two different structures you can query in order to retrieve server certificate information.  You must do some sort of request to complete the SSL server certificate exchange, and then you can retrieve this information.  Here is an example of that technique. C++ code listing for sample (Copy Code): // CertificateInfo.cpp : Defines the..." />
    
  - |
    <meta property="og:type" content="article" />
    <meta property="og:title" content="How to get Certificate Information Using WinInet APIs" />
    <meta property="og:url" content="https://blogs.msdn.microsoft.com/jpsanders/2009/04/17/how-to-get-certificate-information-using-wininet-apis/" />
    <meta property="og:site_name" content="Http Client Protocol Issues (and other fun stuff I support)" />
    <meta property="og:description" content="There are two different structures you can query in order to retrieve server certificate information.  You must do some sort of request to complete the SSL server certificate exchange, and then you can retrieve this information.  Here is an example of that technique. C++ code listing for sample (Copy Code): // CertificateInfo.cpp : Defines the..." />
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="How to get Certificate Information Using WinInet APIs" />
    <meta name="twitter:url" content="https://blogs.msdn.microsoft.com/jpsanders/2009/04/17/how-to-get-certificate-information-using-wininet-apis/" />
    <meta name="twitter:description" content="There are two different structures you can query in order to retrieve server certificate information.  You must do some sort of request to complete the SSL server certificate exchange, and then you can retrieve this information.  Here is an example of that technique. C++ code listing for sample (Copy Code): // CertificateInfo.cpp : Defines the..." />
    
  - |
    <meta property="og:type" content="article" />
    <meta property="og:title" content="How to get Certificate Information Using WinInet APIs" />
    <meta property="og:url" content="https://blogs.msdn.microsoft.com/jpsanders/2009/04/17/how-to-get-certificate-information-using-wininet-apis/" />
    <meta property="og:site_name" content="Http Client Protocol Issues (and other fun stuff I support)" />
    <meta property="og:description" content="There are two different structures you can query in order to retrieve server certificate information.  You must do some sort of request to complete the SSL server certificate exchange, and then you can retrieve this information.  Here is an example of that technique. C++ code listing for sample (Copy Code): // CertificateInfo.cpp : Defines the..." />
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="How to get Certificate Information Using WinInet APIs" />
    <meta name="twitter:url" content="https://blogs.msdn.microsoft.com/jpsanders/2009/04/17/how-to-get-certificate-information-using-wininet-apis/" />
    <meta name="twitter:description" content="There are two different structures you can query in order to retrieve server certificate information.  You must do some sort of request to complete the SSL server certificate exchange, and then you can retrieve this information.  Here is an example of that technique. C++ code listing for sample (Copy Code): // CertificateInfo.cpp : Defines the..." />
    
  - |
    <meta property="og:type" content="article" />
    <meta property="og:title" content="How to get Certificate Information Using WinInet APIs" />
    <meta property="og:url" content="https://blogs.msdn.microsoft.com/jpsanders/2009/04/17/how-to-get-certificate-information-using-wininet-apis/" />
    <meta property="og:site_name" content="Http Client Protocol Issues (and other fun stuff I support)" />
    <meta property="og:description" content="There are two different structures you can query in order to retrieve server certificate information.  You must do some sort of request to complete the SSL server certificate exchange, and then you can retrieve this information.  Here is an example of that technique. C++ code listing for sample (Copy Code): // CertificateInfo.cpp : Defines the..." />
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="How to get Certificate Information Using WinInet APIs" />
    <meta name="twitter:url" content="https://blogs.msdn.microsoft.com/jpsanders/2009/04/17/how-to-get-certificate-information-using-wininet-apis/" />
    <meta name="twitter:description" content="There are two different structures you can query in order to retrieve server certificate information.  You must do some sort of request to complete the SSL server certificate exchange, and then you can retrieve this information.  Here is an example of that technique. C++ code listing for sample (Copy Code): // CertificateInfo.cpp : Defines the..." />
    
  - |
    <meta property="og:type" content="article" />
    <meta property="og:title" content="How to get Certificate Information Using WinInet APIs" />
    <meta property="og:url" content="https://blogs.msdn.microsoft.com/jpsanders/2009/04/17/how-to-get-certificate-information-using-wininet-apis/" />
    <meta property="og:site_name" content="Http Client Protocol Issues (and other fun stuff I support)" />
    <meta property="og:description" content="There are two different structures you can query in order to retrieve server certificate information.  You must do some sort of request to complete the SSL server certificate exchange, and then you can retrieve this information.  Here is an example of that technique. C++ code listing for sample (Copy Code): // CertificateInfo.cpp : Defines the..." />
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="How to get Certificate Information Using WinInet APIs" />
    <meta name="twitter:url" content="https://blogs.msdn.microsoft.com/jpsanders/2009/04/17/how-to-get-certificate-information-using-wininet-apis/" />
    <meta name="twitter:description" content="There are two different structures you can query in order to retrieve server certificate information.  You must do some sort of request to complete the SSL server certificate exchange, and then you can retrieve this information.  Here is an example of that technique. C++ code listing for sample (Copy Code): // CertificateInfo.cpp : Defines the..." />
    
  - |
    <meta property="og:type" content="article" />
    <meta property="og:title" content="How to get Certificate Information Using WinInet APIs" />
    <meta property="og:url" content="https://blogs.msdn.microsoft.com/jpsanders/2009/04/17/how-to-get-certificate-information-using-wininet-apis/" />
    <meta property="og:site_name" content="Http Client Protocol Issues (and other fun stuff I support)" />
    <meta property="og:description" content="There are two different structures you can query in order to retrieve server certificate information.  You must do some sort of request to complete the SSL server certificate exchange, and then you can retrieve this information.  Here is an example of that technique. C++ code listing for sample (Copy Code): // CertificateInfo.cpp : Defines the..." />
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="How to get Certificate Information Using WinInet APIs" />
    <meta name="twitter:url" content="https://blogs.msdn.microsoft.com/jpsanders/2009/04/17/how-to-get-certificate-information-using-wininet-apis/" />
    <meta name="twitter:description" content="There are two different structures you can query in order to retrieve server certificate information.  You must do some sort of request to complete the SSL server certificate exchange, and then you can retrieve this information.  Here is an example of that technique. C++ code listing for sample (Copy Code): // CertificateInfo.cpp : Defines the..." />
    
categories:
  - Uncategorized
tags:
  - WinInet
---
  
There are two different structures you can query in order to retrieve server certificate information.  You must do some sort of request to complete the SSL server certificate exchange, and then you can retrieve this information.  Here is an example of that technique.  
**C++ code listing for sample (<a>Copy Code</a>):**

<div id="certinfo1" style="background-color: #e0e0e0">
  // CertificateInfo.cpp : Defines the entry point for the console application.<br /> // This is sample code. You are responsible for input validation, and error processing.<br /> // The following macros define the minimum required platform. The minimum required platform<br /> // is the earliest version of Windows, Internet Explorer etc. that has the necessary features to run<br /> // your application. The macros work by enabling all features available on platform versions up to and<br /> // including the version specified.<br /> // Modify the following defines if you have to target a platform prior to the ones specified below.<br /> // Refer to MSDN for the latest info on corresponding values for different platforms.<br /> &nbsp;<br /> <span style="color: #008000;font-size: small"><span style="color: #0000ff;font-size: small"><span style="color: #0000ff;font-size: small">#ifndef</span></span><span style="font-size: small"> _WIN32_WINNT </span><span style="color: #008000;font-size: small"><span style="color: #008000;font-size: small">// Specifies that the minimum required platform is Windows Vista.<br /> </span></span><span style="color: #0000ff;font-size: small"><span style="color: #0000ff;font-size: small">#define</span></span><span style="font-size: small"> _WIN32_WINNT 0x0600 </span><span style="color: #008000;font-size: small"><span style="color: #008000;font-size: small">// Change this to the appropriate value to target other versions of Windows.<br /> </span></span><span style="color: #0000ff;font-size: small"><span style="color: #0000ff;font-size: small">#endif<br /> #ifndef</span></span><span style="font-size: small"> WIN32_LEAN_AND_MEAN</span><br /> <span style="color: #0000ff;font-size: small"><span style="color: #0000ff;font-size: small">#define</span></span><span style="font-size: small"> WIN32_LEAN_AND_MEAN<br /> </span><span style="color: #0000ff;font-size: small"><span style="color: #0000ff;font-size: small">#endif<br /> #include</span></span> <span style="color: #a31515;font-size: small"><span style="color: #a31515;font-size: small"><windows.h><br /> </span></span><span style="color: #0000ff;font-size: small"><span style="color: #0000ff;font-size: small">#include</span></span> <span style="color: #a31515;font-size: small"><span style="color: #a31515;font-size: small"><stdio.h><br /> </span></span><span style="color: #0000ff;font-size: small"><span style="color: #0000ff;font-size: small">#include</span></span> <span style="color: #a31515;font-size: small"><span style="color: #a31515;font-size: small"><iostream><br /> </span></span><span style="color: #0000ff;font-size: small"><span style="color: #0000ff;font-size: small">#include</span></span> <span style="color: #a31515;font-size: small"><span style="color: #a31515;font-size: small"><tchar.h><br /> </span></span><span style="color: #0000ff;font-size: small"><span style="color: #0000ff;font-size: small">#include</span></span> <span style="color: #a31515;font-size: small"><span style="color: #a31515;font-size: small"><wininet.h></span></span> <span style="color: #008000;font-size: small"><span style="color: #008000;font-size: small">// make sure you link with WinInet.lib</span></span></span><span style="color: #0000ff;font-size: small"><span style="color: #0000ff;font-size: small">int</span></span><span style="font-size: small"> _tmain(</span><span style="color: #0000ff;font-size: small"><span style="color: #0000ff;font-size: small">int</span></span><span style="font-size: small"> argc, _TCHAR* argv[])<br /> {</span><br /> <span style="color: #0000ff;font-size: small"><span style="color: #0000ff;font-size: small">  if</span></span><span style="font-size: small"> (argc < 2)<br /> {</span><br /> <span style="font-size: small">std::cout << </span><span style="color: #a31515;font-size: small"><span style="color: #a31515;font-size: small">&#8220;Please specify and HTTPS address to query the certificate information for&#8221;</span></span><span style="font-size: small"> << std::endl;</span><br /> <span style="font-size: small">}<br /> </span><span style="color: #0000ff;font-size: small"><span style="color: #0000ff;font-size: small">  else<br /> </span></span><span style="font-size: small">  {</span><br /> <span style="color: #008000;font-size: small"><span style="color: #008000;font-size: small">// Get Scheme and HostName from URL passed in<br /> </span></span><span style="font-size: small">    ::URL_COMPONENTS urlComp;<br /> ::ZeroMemory((</span><span style="color: #0000ff;font-size: small"><span style="color: #0000ff;font-size: small">void</span></span><span style="font-size: small"> *)&urlComp,</span><span style="color: #0000ff;font-size: small"><span style="color: #0000ff;font-size: small">sizeof</span></span><span style="font-size: small">(URL_COMPONENTS));<br /> urlComp.dwSchemeLength = -1;<br /> urlComp.dwHostNameLength = -1;<br /> </span><span style="font-size: small">urlComp.dwUrlPathLength = -1;<br /> </span><span style="font-size: small">    urlComp.dwStructSize = <span style="color: #0000ff">sizeof</span><span style="font-size: small">(URL_COMPONENTS)</span>;<br /> </span><span style="color: #0000ff;font-size: small"><span style="color: #0000ff;font-size: small">    if</span></span><span style="font-size: small"> (!::InternetCrackUrl(argv[1],wcslen(argv[1]),0,&urlComp))<br /> {<br /> std::cout << </span><span style="color: #a31515;font-size: small"><span style="color: #a31515;font-size: small">&#8220;InternetCrackUrl failed&#8221;</span></span><span style="font-size: small"> << std::endl;</span><br /> <span style="font-size: small">}<br /> </span><span style="color: #0000ff;font-size: small"><span style="color: #0000ff;font-size: small">    else<br /> </span></span><span style="font-size: small">    {<br /> </span><span style="color: #0000ff;font-size: small"><span style="color: #0000ff;font-size: small">if</span></span><span style="font-size: small"> (urlComp.nScheme != INTERNET_SCHEME_HTTPS)<br /> {<br /> std::cout << </span><span style="color: #a31515;font-size: small"><span style="color: #a31515;font-size: small">&#8220;Please specify and HTTPS address to query the certificate information for: https://www.someserver.com&#8221;</span></span><span style="font-size: small"> << std::endl;<br /> }<br /> </span><span style="color: #0000ff;font-size: small"><span style="color: #0000ff;font-size: small">        else<br /> </span></span><span style="font-size: small">        {<br /> std::wcout << </span><span style="color: #a31515;font-size: small"><span style="color: #a31515;font-size: small">&#8220;opening connection to host: &#8220;</span></span><span style="font-size: small"> << (LPWSTR)urlComp.lpszHostName << std::endl; </span><br /> HINTERNET hInternet = ::InternetOpen(_T(<span style="color: #a31515;font-size: small"><span style="color: #a31515;font-size: small">&#8220;&#8221;</span></span><span style="font-size: small">), INTERNET_OPEN_TYPE_PRECONFIG, NULL, NULL, 0);<br /> </span><span style="color: #0000ff;font-size: small"><span style="color: #0000ff;font-size: small">            if</span></span><span style="font-size: small"> (hInternet)<br /> {<br /> HINTERNET hConnect = ::InternetConnect( hInternet, urlComp.lpszHostName, INTERNET_DEFAULT_HTTPS_PORT, NULL, NULL, INTERNET_SERVICE_HTTP, INTERNET_FLAG_SECURE, NULL);<br /> </span><span style="color: #0000ff;font-size: small"><span style="color: #0000ff;font-size: small">                if</span></span><span style="font-size: small"> (hConnect)<br /> {<br /> </span><span style="color: #008000;font-size: small"><span style="color: #008000;font-size: small">// you could use HEAD,GET or POST here. HEAD will not return the body of the page so will be more efficient<br /> </span></span><span style="font-size: small">                    HINTERNET hRequest = ::HttpOpenRequest(hConnect,_T(</span><span style="color: #a31515;font-size: small"><span style="color: #a31515;font-size: small">&#8220;HEAD&#8221;</span></span><span style="font-size: small">), NULL, NULL, NULL,<br /> NULL, INTERNET_FLAG_SECURE, NULL);<br /> </span><span style="color: #0000ff;font-size: small"><span style="color: #0000ff;font-size: small"><br /> </span></span><span style="color: #0000ff;font-size: small"><span style="color: #0000ff;font-size: small">if</span></span><span style="font-size: small"> (NULL != hRequest)<br /> {<br /> </span><span style="color: #008000;font-size: small"><span style="color: #008000;font-size: small">// Send<br /> </span></span><span style="font-size: small">                        BOOL fRet = ::HttpSendRequest( hRequest, _T(</span><span style="color: #a31515;font-size: small"><span style="color: #a31515;font-size: small">&#8220;&#8221;</span></span><span style="font-size: small">), 0, NULL, 0);<br /> </span><span style="color: #0000ff;font-size: small"><span style="color: #0000ff;font-size: small"><br /> </span></span><span style="color: #0000ff;font-size: small"><span style="color: #0000ff;font-size: small">                        if</span></span><span style="font-size: small"> (fRet)<br /> {<br /> </span><span style="color: #0000ff;font-size: small"><span style="color: #0000ff;font-size: small">char</span></span><span style="font-size: small"> certificateInfoStr[2048];<br /> certificateInfoStr[0] = </span><span style="color: #a31515;font-size: small"><span style="color: #a31515;font-size: small">&#8216;\0&#8217;</span></span><span style="font-size: small">;<br /> DWORD certInfoLength = 2048;<br /> </span><span style="color: #0000ff;font-size: small"><span style="color: #0000ff;font-size: small">                            if</span></span><span style="font-size: small"> ( TRUE  == ::InternetQueryOption( hRequest, INTERNET_OPTION_SECURITY_CERTIFICATE, &certificateInfoStr, &certInfoLength) )<br /> {<br /> </span><span style="color: #0000ff;font-size: small"><span style="color: #0000ff;font-size: small">if</span></span><span style="font-size: small"> ( certificateInfoStr )<br /> {<br /> std::cout << (</span><span style="color: #0000ff;font-size: small"><span style="color: #0000ff;font-size: small">char</span></span><span style="font-size: small"> *) certificateInfoStr << std::endl;<br /> }<br /> }<br /> </span><span style="color: #0000ff;font-size: small"><span style="color: #0000ff;font-size: small">else</span></span><span style="font-size: small"><br /> {<br /> </span><span style="color: #008000;font-size: small"><span style="color: #008000;font-size: small">                                // process error here<br /> </span></span><span style="font-size: small">DWORD error = GetLastError();<br /> } </span><br /> INTERNET_CERTIFICATE_INFO certificateInfo;<br /> certInfoLength =<br /> <span style="color: #0000ff;font-size: small"><span style="color: #0000ff;font-size: small">sizeof</span></span><span style="font-size: small">(INTERNET_CERTIFICATE_INFO);<br /> </span><span style="color: #0000ff;font-size: small"><span style="color: #0000ff;font-size: small">if</span></span><span style="font-size: small"> ( TRUE == InternetQueryOption( hRequest,<br /> INTERNET_OPTION_SECURITY_CERTIFICATE_STRUCT,<br /> &certificateInfo,<br /> &certInfoLength) )<br /> {<br /> </span><span style="color: #008000;font-size: small"><span style="color: #008000;font-size: small">// free up memory with LocalFree() </span></span><br /> &nbsp;<br /> <span style="color: #0000ff;font-size: small"><span style="color: #0000ff;font-size: small">                                if</span></span><span style="font-size: small"> ( certificateInfo.lpszEncryptionAlgName )<br /> {<br /> std::cout << (</span><span style="color: #0000ff;font-size: small"><span style="color: #0000ff;font-size: small">char</span></span><span style="font-size: small"> *) certificateInfo.lpszEncryptionAlgName << std::endl;<br /> LocalFree( certificateInfo.lpszEncryptionAlgName);<br /> }</span><br /> <span style="color: #0000ff;font-size: small"><span style="color: #0000ff;font-size: small">                                if</span></span><span style="font-size: small"> ( certificateInfo.lpszIssuerInfo )<br /> {<br /> std::cout << (</span><span style="color: #0000ff;font-size: small"><span style="color: #0000ff;font-size: small">char</span></span><span style="font-size: small"> *) certificateInfo.lpszIssuerInfo << std::endl;<br /> LocalFree( certificateInfo.lpszIssuerInfo );<br /> }</span><br /> <span style="color: #0000ff;font-size: small"><span style="color: #0000ff;font-size: small">                                if</span></span><span style="font-size: small"> ( certificateInfo.lpszProtocolName )<br /> {<br /> std::cout << (</span><span style="color: #0000ff;font-size: small"><span style="color: #0000ff;font-size: small">char</span></span><span style="font-size: small"> *) certificateInfo.lpszProtocolName << std::endl;<br /> LocalFree( certificateInfo.lpszProtocolName );<br /> }</span><br /> <span style="color: #0000ff;font-size: small"><span style="color: #0000ff;font-size: small">                                if</span></span><span style="font-size: small"> ( certificateInfo.lpszSignatureAlgName )<br /> {<br /> std::cout << (</span><span style="color: #0000ff;font-size: small"><span style="color: #0000ff;font-size: small">char</span></span><span style="font-size: small"> *) certificateInfo.lpszSignatureAlgName << std::endl;<br /> LocalFree( certificateInfo.lpszSignatureAlgName );<br /> }</span><br /> <span style="color: #0000ff;font-size: small"><span style="color: #0000ff;font-size: small">                                if</span></span><span style="font-size: small"> ( certificateInfo.lpszSubjectInfo )<br /> {<br /> std::cout << (</span><span style="color: #0000ff;font-size: small"><span style="color: #0000ff;font-size: small">char</span></span><span style="font-size: small"> *) certificateInfo.lpszSubjectInfo << std::endl;<br /> LocalFree( certificateInfo.lpszSubjectInfo );<br /> }</span><br /> }<br /> <span style="color: #0000ff;font-size: small"><span style="color: #0000ff;font-size: small">else</span></span><span style="font-size: small"><br /> {<br /> </span><span style="color: #008000;font-size: small"><span style="color: #008000;font-size: small">// process error<br /> </span></span><span style="font-size: small">                                    DWORD error = GetLastError();<br /> }<br /> }</span><br /> ::InternetCloseHandle(hRequest);<br /> }<br /> <span style="color: #0000ff;font-size: small"><span style="color: #0000ff;font-size: small">else<br /> </span></span><span style="font-size: small">{<br /> std::cout << </span><span style="color: #a31515;font-size: small"><span style="color: #a31515;font-size: small">&#8220;HttpOpenRequest failed&#8221;</span></span><span style="font-size: small"> << std::endl;<br /> }</span><br /> ::InternetCloseHandle(hConnect);<br /> }<br /> <span style="color: #0000ff;font-size: small"><span style="color: #0000ff;font-size: small">                else<br /> </span></span><span style="font-size: small">                {<br /> std::cout << </span><span style="color: #a31515;font-size: small"><span style="color: #a31515;font-size: small">&#8220;InternetConnect failed&#8221;</span></span><span style="font-size: small"> << std::endl;<br /> }<br /> ::InternetCloseHandle(hInternet);<br /> }<br /> </span><span style="color: #0000ff;font-size: small"><span style="color: #0000ff;font-size: small">else<br /> </span></span><span style="font-size: small">{<br /> std::cout << </span><span style="color: #a31515;font-size: small"><span style="color: #a31515;font-size: small">&#8220;InternetOpen failed&#8221;</span></span><span style="font-size: small"> << std::endl;<br /> }<br /> }<br /> }<br /> }</span><br /> <span style="color: #0000ff;font-size: small"><span style="color: #0000ff;font-size: small">return</span></span><span style="font-size: small"> 0;<br /> }</span>
</div>

Please Drop me a comment if you found this useful!