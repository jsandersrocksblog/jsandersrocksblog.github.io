---
id: 623
title: Understanding Problems with MS10-049, KB 980436 and IETF RFC5746
date: 2010-09-08T10:49:00-05:00
author: jsanders
layout: post
guid: http://jsandersblog.azurewebsites.net/2010/09/08/understanding-problems-with-ms10-049-kb-980436-and-ietf-rfc5746/
permalink: /2010/09/08/understanding-problems-with-ms10-049-kb-980436-and-ietf-rfc5746/
orig_url:
  - http://blogs.msdn.microsoft.com/b/jpsanders/archive/2010/09/08/understanding-problems-with-ms10-049-kb-980436-and-ietf-rfc5746.aspx
  - http://blogs.msdn.microsoft.com/b/jpsanders/archive/2010/09/08/understanding-problems-with-ms10-049-kb-980436-and-ietf-rfc5746.aspx
  - http://blogs.msdn.microsoft.com/b/jpsanders/archive/2010/09/08/understanding-problems-with-ms10-049-kb-980436-and-ietf-rfc5746.aspx
  - http://blogs.msdn.microsoft.com/b/jpsanders/archive/2010/09/08/understanding-problems-with-ms10-049-kb-980436-and-ietf-rfc5746.aspx
  - http://blogs.msdn.microsoft.com/b/jpsanders/archive/2010/09/08/understanding-problems-with-ms10-049-kb-980436-and-ietf-rfc5746.aspx
  - http://blogs.msdn.microsoft.com/b/jpsanders/archive/2010/09/08/understanding-problems-with-ms10-049-kb-980436-and-ietf-rfc5746.aspx
  - http://blogs.msdn.microsoft.com/b/jpsanders/archive/2010/09/08/understanding-problems-with-ms10-049-kb-980436-and-ietf-rfc5746.aspx
  - http://blogs.msdn.microsoft.com/b/jpsanders/archive/2010/09/08/understanding-problems-with-ms10-049-kb-980436-and-ietf-rfc5746.aspx
  - http://blogs.msdn.microsoft.com/b/jpsanders/archive/2010/09/08/understanding-problems-with-ms10-049-kb-980436-and-ietf-rfc5746.aspx
orig_site_id:
  - "8394"
  - "8394"
  - "8394"
  - "8394"
  - "8394"
  - "8394"
  - "8394"
  - "8394"
  - "8394"
orig_post_id:
  - "10059430"
  - "10059430"
  - "10059430"
  - "10059430"
  - "10059430"
  - "10059430"
  - "10059430"
  - "10059430"
  - "10059430"
orig_parent_id:
  - "10059430"
  - "10059430"
  - "10059430"
  - "10059430"
  - "10059430"
  - "10059430"
  - "10059430"
  - "10059430"
  - "10059430"
orig_thread_id:
  - "731808"
  - "731808"
  - "731808"
  - "731808"
  - "731808"
  - "731808"
  - "731808"
  - "731808"
  - "731808"
orig_application_key:
  - jpsanders
  - jpsanders
  - jpsanders
  - jpsanders
  - jpsanders
  - jpsanders
  - jpsanders
  - jpsanders
  - jpsanders
orig_post_author_id:
  - "65385"
  - "65385"
  - "65385"
  - "65385"
  - "65385"
  - "65385"
  - "65385"
  - "65385"
  - "65385"
orig_post_author_username:
  - jpsanders
  - jpsanders
  - jpsanders
  - jpsanders
  - jpsanders
  - jpsanders
  - jpsanders
  - jpsanders
  - jpsanders
orig_post_author_created:
  - Jan 18 2007 01:34:53:000PM
  - Jan 18 2007 01:34:53:000PM
  - Jan 18 2007 01:34:53:000PM
  - Jan 18 2007 01:34:53:000PM
  - Jan 18 2007 01:34:53:000PM
  - Jan 18 2007 01:34:53:000PM
  - Jan 18 2007 01:34:53:000PM
  - Jan 18 2007 01:34:53:000PM
  - Jan 18 2007 01:34:53:000PM
orig_is_approved:
  - "1"
  - "1"
  - "1"
  - "1"
  - "1"
  - "1"
  - "1"
  - "1"
  - "1"
orig_attachment_count:
  - "0"
  - "0"
  - "0"
  - "0"
  - "0"
  - "0"
  - "0"
  - "0"
  - "0"
orig_url_title:
  - http://blogs.msdn.com/b/jpsanders/archive/2010/09/08/understanding-problems-with-ms10-049-kb-980436-and-ietf-rfc5746.aspx
  - http://blogs.msdn.com/b/jpsanders/archive/2010/09/08/understanding-problems-with-ms10-049-kb-980436-and-ietf-rfc5746.aspx
  - http://blogs.msdn.com/b/jpsanders/archive/2010/09/08/understanding-problems-with-ms10-049-kb-980436-and-ietf-rfc5746.aspx
  - http://blogs.msdn.com/b/jpsanders/archive/2010/09/08/understanding-problems-with-ms10-049-kb-980436-and-ietf-rfc5746.aspx
  - http://blogs.msdn.com/b/jpsanders/archive/2010/09/08/understanding-problems-with-ms10-049-kb-980436-and-ietf-rfc5746.aspx
  - http://blogs.msdn.com/b/jpsanders/archive/2010/09/08/understanding-problems-with-ms10-049-kb-980436-and-ietf-rfc5746.aspx
  - http://blogs.msdn.com/b/jpsanders/archive/2010/09/08/understanding-problems-with-ms10-049-kb-980436-and-ietf-rfc5746.aspx
  - http://blogs.msdn.com/b/jpsanders/archive/2010/09/08/understanding-problems-with-ms10-049-kb-980436-and-ietf-rfc5746.aspx
  - http://blogs.msdn.com/b/jpsanders/archive/2010/09/08/understanding-problems-with-ms10-049-kb-980436-and-ietf-rfc5746.aspx
opengraph_tags:
  - |
    <meta property="og:type" content="article" />
    <meta property="og:title" content="Understanding Problems with MS10-049, KB 980436 and IETF RFC5746" />
    <meta property="og:url" content="https://blogs.msdn.microsoft.com/jpsanders/2010/09/08/understanding-problems-with-ms10-049-kb-980436-and-ietf-rfc5746/" />
    <meta property="og:site_name" content="Http Client Protocol Issues (and other fun stuff I support)" />
    <meta property="og:description" content="Understanding Problems with MS10-049, KB 980436 and IETF RFC5746 Microsoft released a Security update MS10-049: Vulnerabilities in SChannel could allow remote code execution. This update patches vulnerabilities in SChannel (TLS) that can be exploited (see: CVE-2009-3555). Read the RFC and CVE articles to understand what vulnerability this is addressing: http://tools.ietf.org/html/rfc5746 http://tools.ietf.org/html/draft-ietf-tls-renegotiation-03 There are some ancient..." />
    <meta property="og:image" content="/assets/images/MSDNBlogsFS/prod.evol.blogs.msdn.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/00/83/94/metablogapi/5430.clip_image001_thumb.png" />
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="Understanding Problems with MS10-049, KB 980436 and IETF RFC5746" />
    <meta name="twitter:url" content="https://blogs.msdn.microsoft.com/jpsanders/2010/09/08/understanding-problems-with-ms10-049-kb-980436-and-ietf-rfc5746/" />
    <meta name="twitter:description" content="Understanding Problems with MS10-049, KB 980436 and IETF RFC5746 Microsoft released a Security update MS10-049: Vulnerabilities in SChannel could allow remote code execution. This update patches vulnerabilities in SChannel (TLS) that can be exploited (see: CVE-2009-3555). Read the RFC and CVE articles to understand what vulnerability this is addressing: http://tools.ietf.org/html/rfc5746 http://tools.ietf.org/html/draft-ietf-tls-renegotiation-03 There are some ancient..." />
    <meta name="twitter:image" content="/assets/images/MSDNBlogsFS/prod.evol.blogs.msdn.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/00/83/94/metablogapi/5430.clip_image001_thumb.png" />
    
  - |
    <meta property="og:type" content="article" />
    <meta property="og:title" content="Understanding Problems with MS10-049, KB 980436 and IETF RFC5746" />
    <meta property="og:url" content="https://blogs.msdn.microsoft.com/jpsanders/2010/09/08/understanding-problems-with-ms10-049-kb-980436-and-ietf-rfc5746/" />
    <meta property="og:site_name" content="Http Client Protocol Issues (and other fun stuff I support)" />
    <meta property="og:description" content="Understanding Problems with MS10-049, KB 980436 and IETF RFC5746 Microsoft released a Security update MS10-049: Vulnerabilities in SChannel could allow remote code execution. This update patches vulnerabilities in SChannel (TLS) that can be exploited (see: CVE-2009-3555). Read the RFC and CVE articles to understand what vulnerability this is addressing: http://tools.ietf.org/html/rfc5746 http://tools.ietf.org/html/draft-ietf-tls-renegotiation-03 There are some ancient..." />
    <meta property="og:image" content="/assets/images/MSDNBlogsFS/prod.evol.blogs.msdn.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/00/83/94/metablogapi/5430.clip_image001_thumb.png" />
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="Understanding Problems with MS10-049, KB 980436 and IETF RFC5746" />
    <meta name="twitter:url" content="https://blogs.msdn.microsoft.com/jpsanders/2010/09/08/understanding-problems-with-ms10-049-kb-980436-and-ietf-rfc5746/" />
    <meta name="twitter:description" content="Understanding Problems with MS10-049, KB 980436 and IETF RFC5746 Microsoft released a Security update MS10-049: Vulnerabilities in SChannel could allow remote code execution. This update patches vulnerabilities in SChannel (TLS) that can be exploited (see: CVE-2009-3555). Read the RFC and CVE articles to understand what vulnerability this is addressing: http://tools.ietf.org/html/rfc5746 http://tools.ietf.org/html/draft-ietf-tls-renegotiation-03 There are some ancient..." />
    <meta name="twitter:image" content="/assets/images/MSDNBlogsFS/prod.evol.blogs.msdn.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/00/83/94/metablogapi/5430.clip_image001_thumb.png" />
    
  - |
    <meta property="og:type" content="article" />
    <meta property="og:title" content="Understanding Problems with MS10-049, KB 980436 and IETF RFC5746" />
    <meta property="og:url" content="https://blogs.msdn.microsoft.com/jpsanders/2010/09/08/understanding-problems-with-ms10-049-kb-980436-and-ietf-rfc5746/" />
    <meta property="og:site_name" content="Http Client Protocol Issues (and other fun stuff I support)" />
    <meta property="og:description" content="Understanding Problems with MS10-049, KB 980436 and IETF RFC5746 Microsoft released a Security update MS10-049: Vulnerabilities in SChannel could allow remote code execution. This update patches vulnerabilities in SChannel (TLS) that can be exploited (see: CVE-2009-3555). Read the RFC and CVE articles to understand what vulnerability this is addressing: http://tools.ietf.org/html/rfc5746 http://tools.ietf.org/html/draft-ietf-tls-renegotiation-03 There are some ancient..." />
    <meta property="og:image" content="/assets/images/MSDNBlogsFS/prod.evol.blogs.msdn.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/00/83/94/metablogapi/5430.clip_image001_thumb.png" />
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="Understanding Problems with MS10-049, KB 980436 and IETF RFC5746" />
    <meta name="twitter:url" content="https://blogs.msdn.microsoft.com/jpsanders/2010/09/08/understanding-problems-with-ms10-049-kb-980436-and-ietf-rfc5746/" />
    <meta name="twitter:description" content="Understanding Problems with MS10-049, KB 980436 and IETF RFC5746 Microsoft released a Security update MS10-049: Vulnerabilities in SChannel could allow remote code execution. This update patches vulnerabilities in SChannel (TLS) that can be exploited (see: CVE-2009-3555). Read the RFC and CVE articles to understand what vulnerability this is addressing: http://tools.ietf.org/html/rfc5746 http://tools.ietf.org/html/draft-ietf-tls-renegotiation-03 There are some ancient..." />
    <meta name="twitter:image" content="/assets/images/MSDNBlogsFS/prod.evol.blogs.msdn.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/00/83/94/metablogapi/5430.clip_image001_thumb.png" />
    
  - |
    <meta property="og:type" content="article" />
    <meta property="og:title" content="Understanding Problems with MS10-049, KB 980436 and IETF RFC5746" />
    <meta property="og:url" content="https://blogs.msdn.microsoft.com/jpsanders/2010/09/08/understanding-problems-with-ms10-049-kb-980436-and-ietf-rfc5746/" />
    <meta property="og:site_name" content="Http Client Protocol Issues (and other fun stuff I support)" />
    <meta property="og:description" content="Understanding Problems with MS10-049, KB 980436 and IETF RFC5746 Microsoft released a Security update MS10-049: Vulnerabilities in SChannel could allow remote code execution. This update patches vulnerabilities in SChannel (TLS) that can be exploited (see: CVE-2009-3555). Read the RFC and CVE articles to understand what vulnerability this is addressing: http://tools.ietf.org/html/rfc5746 http://tools.ietf.org/html/draft-ietf-tls-renegotiation-03 There are some ancient..." />
    <meta property="og:image" content="/assets/images/MSDNBlogsFS/prod.evol.blogs.msdn.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/00/83/94/metablogapi/5430.clip_image001_thumb.png" />
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="Understanding Problems with MS10-049, KB 980436 and IETF RFC5746" />
    <meta name="twitter:url" content="https://blogs.msdn.microsoft.com/jpsanders/2010/09/08/understanding-problems-with-ms10-049-kb-980436-and-ietf-rfc5746/" />
    <meta name="twitter:description" content="Understanding Problems with MS10-049, KB 980436 and IETF RFC5746 Microsoft released a Security update MS10-049: Vulnerabilities in SChannel could allow remote code execution. This update patches vulnerabilities in SChannel (TLS) that can be exploited (see: CVE-2009-3555). Read the RFC and CVE articles to understand what vulnerability this is addressing: http://tools.ietf.org/html/rfc5746 http://tools.ietf.org/html/draft-ietf-tls-renegotiation-03 There are some ancient..." />
    <meta name="twitter:image" content="/assets/images/MSDNBlogsFS/prod.evol.blogs.msdn.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/00/83/94/metablogapi/5430.clip_image001_thumb.png" />
    
  - |
    <meta property="og:type" content="article" />
    <meta property="og:title" content="Understanding Problems with MS10-049, KB 980436 and IETF RFC5746" />
    <meta property="og:url" content="https://blogs.msdn.microsoft.com/jpsanders/2010/09/08/understanding-problems-with-ms10-049-kb-980436-and-ietf-rfc5746/" />
    <meta property="og:site_name" content="Http Client Protocol Issues (and other fun stuff I support)" />
    <meta property="og:description" content="Understanding Problems with MS10-049, KB 980436 and IETF RFC5746 Microsoft released a Security update MS10-049: Vulnerabilities in SChannel could allow remote code execution. This update patches vulnerabilities in SChannel (TLS) that can be exploited (see: CVE-2009-3555). Read the RFC and CVE articles to understand what vulnerability this is addressing: http://tools.ietf.org/html/rfc5746 http://tools.ietf.org/html/draft-ietf-tls-renegotiation-03 There are some ancient..." />
    <meta property="og:image" content="/assets/images/MSDNBlogsFS/prod.evol.blogs.msdn.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/00/83/94/metablogapi/5430.clip_image001_thumb.png" />
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="Understanding Problems with MS10-049, KB 980436 and IETF RFC5746" />
    <meta name="twitter:url" content="https://blogs.msdn.microsoft.com/jpsanders/2010/09/08/understanding-problems-with-ms10-049-kb-980436-and-ietf-rfc5746/" />
    <meta name="twitter:description" content="Understanding Problems with MS10-049, KB 980436 and IETF RFC5746 Microsoft released a Security update MS10-049: Vulnerabilities in SChannel could allow remote code execution. This update patches vulnerabilities in SChannel (TLS) that can be exploited (see: CVE-2009-3555). Read the RFC and CVE articles to understand what vulnerability this is addressing: http://tools.ietf.org/html/rfc5746 http://tools.ietf.org/html/draft-ietf-tls-renegotiation-03 There are some ancient..." />
    <meta name="twitter:image" content="/assets/images/MSDNBlogsFS/prod.evol.blogs.msdn.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/00/83/94/metablogapi/5430.clip_image001_thumb.png" />
    
  - |
    <meta property="og:type" content="article" />
    <meta property="og:title" content="Understanding Problems with MS10-049, KB 980436 and IETF RFC5746" />
    <meta property="og:url" content="https://blogs.msdn.microsoft.com/jpsanders/2010/09/08/understanding-problems-with-ms10-049-kb-980436-and-ietf-rfc5746/" />
    <meta property="og:site_name" content="Http Client Protocol Issues (and other fun stuff I support)" />
    <meta property="og:description" content="Understanding Problems with MS10-049, KB 980436 and IETF RFC5746 Microsoft released a Security update MS10-049: Vulnerabilities in SChannel could allow remote code execution. This update patches vulnerabilities in SChannel (TLS) that can be exploited (see: CVE-2009-3555). Read the RFC and CVE articles to understand what vulnerability this is addressing: http://tools.ietf.org/html/rfc5746 http://tools.ietf.org/html/draft-ietf-tls-renegotiation-03 There are some ancient..." />
    <meta property="og:image" content="/assets/images/MSDNBlogsFS/prod.evol.blogs.msdn.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/00/83/94/metablogapi/5430.clip_image001_thumb.png" />
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="Understanding Problems with MS10-049, KB 980436 and IETF RFC5746" />
    <meta name="twitter:url" content="https://blogs.msdn.microsoft.com/jpsanders/2010/09/08/understanding-problems-with-ms10-049-kb-980436-and-ietf-rfc5746/" />
    <meta name="twitter:description" content="Understanding Problems with MS10-049, KB 980436 and IETF RFC5746 Microsoft released a Security update MS10-049: Vulnerabilities in SChannel could allow remote code execution. This update patches vulnerabilities in SChannel (TLS) that can be exploited (see: CVE-2009-3555). Read the RFC and CVE articles to understand what vulnerability this is addressing: http://tools.ietf.org/html/rfc5746 http://tools.ietf.org/html/draft-ietf-tls-renegotiation-03 There are some ancient..." />
    <meta name="twitter:image" content="/assets/images/MSDNBlogsFS/prod.evol.blogs.msdn.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/00/83/94/metablogapi/5430.clip_image001_thumb.png" />
    
  - |
    <meta property="og:type" content="article" />
    <meta property="og:title" content="Understanding Problems with MS10-049, KB 980436 and IETF RFC5746" />
    <meta property="og:url" content="https://blogs.msdn.microsoft.com/jpsanders/2010/09/08/understanding-problems-with-ms10-049-kb-980436-and-ietf-rfc5746/" />
    <meta property="og:site_name" content="Http Client Protocol Issues (and other fun stuff I support)" />
    <meta property="og:description" content="Understanding Problems with MS10-049, KB 980436 and IETF RFC5746 Microsoft released a Security update MS10-049: Vulnerabilities in SChannel could allow remote code execution. This update patches vulnerabilities in SChannel (TLS) that can be exploited (see: CVE-2009-3555). Read the RFC and CVE articles to understand what vulnerability this is addressing: http://tools.ietf.org/html/rfc5746 http://tools.ietf.org/html/draft-ietf-tls-renegotiation-03 There are some ancient..." />
    <meta property="og:image" content="/assets/images/MSDNBlogsFS/prod.evol.blogs.msdn.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/00/83/94/metablogapi/5430.clip_image001_thumb.png" />
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="Understanding Problems with MS10-049, KB 980436 and IETF RFC5746" />
    <meta name="twitter:url" content="https://blogs.msdn.microsoft.com/jpsanders/2010/09/08/understanding-problems-with-ms10-049-kb-980436-and-ietf-rfc5746/" />
    <meta name="twitter:description" content="Understanding Problems with MS10-049, KB 980436 and IETF RFC5746 Microsoft released a Security update MS10-049: Vulnerabilities in SChannel could allow remote code execution. This update patches vulnerabilities in SChannel (TLS) that can be exploited (see: CVE-2009-3555). Read the RFC and CVE articles to understand what vulnerability this is addressing: http://tools.ietf.org/html/rfc5746 http://tools.ietf.org/html/draft-ietf-tls-renegotiation-03 There are some ancient..." />
    <meta name="twitter:image" content="/assets/images/MSDNBlogsFS/prod.evol.blogs.msdn.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/00/83/94/metablogapi/5430.clip_image001_thumb.png" />
    
  - |
    <meta property="og:type" content="article" />
    <meta property="og:title" content="Understanding Problems with MS10-049, KB 980436 and IETF RFC5746" />
    <meta property="og:url" content="https://blogs.msdn.microsoft.com/jpsanders/2010/09/08/understanding-problems-with-ms10-049-kb-980436-and-ietf-rfc5746/" />
    <meta property="og:site_name" content="Http Client Protocol Issues (and other fun stuff I support)" />
    <meta property="og:description" content="Understanding Problems with MS10-049, KB 980436 and IETF RFC5746 Microsoft released a Security update MS10-049: Vulnerabilities in SChannel could allow remote code execution. This update patches vulnerabilities in SChannel (TLS) that can be exploited (see: CVE-2009-3555). Read the RFC and CVE articles to understand what vulnerability this is addressing: http://tools.ietf.org/html/rfc5746 http://tools.ietf.org/html/draft-ietf-tls-renegotiation-03 There are some ancient..." />
    <meta property="og:image" content="/assets/images/MSDNBlogsFS/prod.evol.blogs.msdn.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/00/83/94/metablogapi/5430.clip_image001_thumb.png" />
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="Understanding Problems with MS10-049, KB 980436 and IETF RFC5746" />
    <meta name="twitter:url" content="https://blogs.msdn.microsoft.com/jpsanders/2010/09/08/understanding-problems-with-ms10-049-kb-980436-and-ietf-rfc5746/" />
    <meta name="twitter:description" content="Understanding Problems with MS10-049, KB 980436 and IETF RFC5746 Microsoft released a Security update MS10-049: Vulnerabilities in SChannel could allow remote code execution. This update patches vulnerabilities in SChannel (TLS) that can be exploited (see: CVE-2009-3555). Read the RFC and CVE articles to understand what vulnerability this is addressing: http://tools.ietf.org/html/rfc5746 http://tools.ietf.org/html/draft-ietf-tls-renegotiation-03 There are some ancient..." />
    <meta name="twitter:image" content="/assets/images/MSDNBlogsFS/prod.evol.blogs.msdn.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/00/83/94/metablogapi/5430.clip_image001_thumb.png" />
    
  - |
    <meta property="og:type" content="article" />
    <meta property="og:title" content="Understanding Problems with MS10-049, KB 980436 and IETF RFC5746" />
    <meta property="og:url" content="https://blogs.msdn.microsoft.com/jpsanders/2010/09/08/understanding-problems-with-ms10-049-kb-980436-and-ietf-rfc5746/" />
    <meta property="og:site_name" content="Http Client Protocol Issues (and other fun stuff I support)" />
    <meta property="og:description" content="Understanding Problems with MS10-049, KB 980436 and IETF RFC5746 Microsoft released a Security update MS10-049: Vulnerabilities in SChannel could allow remote code execution. This update patches vulnerabilities in SChannel (TLS) that can be exploited (see: CVE-2009-3555). Read the RFC and CVE articles to understand what vulnerability this is addressing: http://tools.ietf.org/html/rfc5746 http://tools.ietf.org/html/draft-ietf-tls-renegotiation-03 There are some ancient..." />
    <meta property="og:image" content="/assets/images/MSDNBlogsFS/prod.evol.blogs.msdn.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/00/83/94/metablogapi/5430.clip_image001_thumb.png" />
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="Understanding Problems with MS10-049, KB 980436 and IETF RFC5746" />
    <meta name="twitter:url" content="https://blogs.msdn.microsoft.com/jpsanders/2010/09/08/understanding-problems-with-ms10-049-kb-980436-and-ietf-rfc5746/" />
    <meta name="twitter:description" content="Understanding Problems with MS10-049, KB 980436 and IETF RFC5746 Microsoft released a Security update MS10-049: Vulnerabilities in SChannel could allow remote code execution. This update patches vulnerabilities in SChannel (TLS) that can be exploited (see: CVE-2009-3555). Read the RFC and CVE articles to understand what vulnerability this is addressing: http://tools.ietf.org/html/rfc5746 http://tools.ietf.org/html/draft-ietf-tls-renegotiation-03 There are some ancient..." />
    <meta name="twitter:image" content="/assets/images/MSDNBlogsFS/prod.evol.blogs.msdn.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/00/83/94/metablogapi/5430.clip_image001_thumb.png" />
    
categories:
  - Uncategorized
---
**Understanding Problems with MS10-049, KB 980436 and IETF RFC5746**

Microsoft released a Security update MS10-049: Vulnerabilities in SChannel could allow remote code execution. This update patches vulnerabilities in SChannel (TLS) that can be exploited (see: [CVE-2009-3555](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-3555)). Read the RFC and CVE articles to understand what vulnerability this is addressing: <http://tools.ietf.org/html/rfc5746> <http://tools.ietf.org/html/draft-ietf-tls-renegotiation-03>

There are some ancient servers still out in the wild however that do not correctly ignore ClientHelloExtensions that they do not understand. According to the RFCs they should ignore the unknown extensions, but they are not compliant. The obvious workaround is to upgrade those servers so that they do not barf on the unknown extensions, but there may be cases where you do not have control over the target servers or cannot convince the owners to upgrade to a fixed version.

There are two problems you may see from non compliant servers:

1. The non-compliant server may not renegotiate leaving it vulnerable to [CVE-2009-3555](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-3555)

2. TLS requires servers to accept extended client hello messages, even if the server does not &#8220;understand&#8221; the extension ([http://tools.ietf.org/html/draft-ietf-tls-rfc3546bis-02](http://tools.ietf.org/html/draft-ietf-tls-rfc3546bis-02 "http://tools.ietf.org/html/draft-ietf-tls-rfc3546bis-02")).&nbsp; The non-compliant server may refuse the SSL connection if it does not correctly understand the extended client hello messages and not allow you to establish a connection.

For both of these problems the fix should be to **UPDATE the problem server**.&nbsp; All major 3rd parties do have updates that comply to this so you should contact the vendors for update information.

**Layman&rsquo;s explanation**

To remove this vulnerability ([CVE-2009-3555](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-3555)), IETF RFC5746 recommends using the ClientHelloExtension with Renegotiation Info. Bad evil servers that are not RFC3546 compliant do not ignore this extension and therefore will send back an encrypted alert. You will see this in a Netmon trace when you have enabled only TLS in the advanced options of IE and try to hit an <https://somebadSite>.

**Identify if you are seeing the issue**

So that you do not cry &lsquo;wolf&rsquo; and blame this update on your TLS woes, I will show you what to look for in a Netmon or wireshark trace to identify if you are falling under this problem, and then some options to work around the issue. WinInet, WinHTTP, and HttpWebRequest application implementations that make SSL requests over HTTP (HTTPS) are using SChannel, so they may experience this problem after installation of MS10-049.&nbsp; This could also affect raw SSL traffic.

Start Netmon and look for the client hello (apply TLS as a filter):

TLS: TLS Rec Layer-1 HandShake: Client Hello.

Expand this out and notice the highlighted information below:

<a href="/assets/images/MSDNBlogsFS/prod.evol.blogs.msdn.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/00/83/94/metablogapi/1614.clip_image001_2.png" original-url="http://blogs.msdn.com/cfs-file.ashx/__key/CommunityServer-Blogs-Components-WeblogFiles/00-00-00-83-94-metablogapi/1614.clip_5F00_image001_5F00_2.png"><img loading="lazy" style="background-image: none; margin: 5px 5px 5px 0px; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border-width: 0px;" title="clip_image001" border="0" alt="clip_image001" src="/assets/images/MSDNBlogsFS/prod.evol.blogs.msdn.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/00/83/94/metablogapi/5430.clip_image001_thumb.png" original-url="http://blogs.msdn.com/cfs-file.ashx/__key/CommunityServer-Blogs-Components-WeblogFiles/00-00-00-83-94-metablogapi/5430.clip_5F00_image001_5F00_thumb.png" width="457" height="427" /></a>

If the server is OK with the ClientHello it will return a Server Hello like this:

<a href="/assets/images/MSDNBlogsFS/prod.evol.blogs.msdn.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/00/83/94/metablogapi/4857.clip_image002_2.png" original-url="http://blogs.msdn.com/cfs-file.ashx/__key/CommunityServer-Blogs-Components-WeblogFiles/00-00-00-83-94-metablogapi/4857.clip_5F00_image002_5F00_2.png"><img loading="lazy" style="background-image: none; margin: 5px 5px 5px 0px; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border-width: 0px;" title="clip_image002" border="0" alt="clip_image002" src="/assets/images/MSDNBlogsFS/prod.evol.blogs.msdn.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/00/83/94/metablogapi/7573.clip_image002_thumb.png" original-url="http://blogs.msdn.com/cfs-file.ashx/__key/CommunityServer-Blogs-Components-WeblogFiles/00-00-00-83-94-metablogapi/7573.clip_5F00_image002_5F00_thumb.png" width="779" height="76" /></a>

Here you will see that the server responded to the Client Hello with an Encrypted Alert which means in this case that it does not like the format of the Client Hello:

<a href="/assets/images/MSDNBlogsFS/prod.evol.blogs.msdn.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/00/83/94/metablogapi/3386.clip_image003_2.png" original-url="http://blogs.msdn.com/cfs-file.ashx/__key/CommunityServer-Blogs-Components-WeblogFiles/00-00-00-83-94-metablogapi/3386.clip_5F00_image003_5F00_2.png"><img loading="lazy" style="background-image: none; margin: 5px 5px 5px 0px; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border-width: 0px;" title="clip_image003" border="0" alt="clip_image003" src="/assets/images/MSDNBlogsFS/prod.evol.blogs.msdn.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/00/83/94/metablogapi/7571.clip_image003_thumb.png" original-url="http://blogs.msdn.com/cfs-file.ashx/__key/CommunityServer-Blogs-Components-WeblogFiles/00-00-00-83-94-metablogapi/7571.clip_5F00_image003_5F00_thumb.png" width="779" height="143" /></a>

This is the first indicator of the problem.

The fix is to make sure that the server is updated and will not fall victim to the vulnerability. An IIS 6 server that is not patched will not send the Encrypted Alert, but it will simply ignore this Extension. You must update your servers to be protected (or convince the target server owner to patch their server).&nbsp; All major servers have recent patches or updates for this vulnerability.

&nbsp;

**What can I do in the short term?**

**NOTE:** These are ALL SHORT term fixes.

There are several things you can do client side to get around this issue.

Apply the registry setting in KB 980436

**This does NOT work with Windows 7**

**Selecting the Signaling mechanism for Windows Server 2008, Windows Vista, Windows Server 2003, and Windows XP only**

The RFC5746 recommends sending the TLS Renego extension in the TLS Client Hello packet at the client. However, in some cases, there might be the need to send SCSV for signaling in its TLS Client Hello packet. An administrator can use the UseScsvForTls entry DWORD value together with a nonzero value in the following registry path to send SCSV for signaling in TLS:

HKEY\_LOCAL\_MACHINE\System\CurrentControlSet\Control\SecurityProviders\SCHANNEL

The following table shows how this DWORD value can be used:

<p sizcache="4" sizset="0">
  Collapse this tableExpand this table
</p>

<table border="0" cellspacing="1" cellpadding="0">
  <tr>
    <td width="143">
      <p>
        <b>DWORD</b>
      </p>
    </td>
    
    <td width="256">
      <p>
        <b>Value = zero</b>
      </p>
    </td>
    
    <td>
      <p>
        <b>Value = nonzero</b>
      </p>
    </td>
  </tr>
  
  <tr>
    <td valign="top" width="143">
      <p>
        UseScsvForTls
      </p>
    </td>
    
    <td valign="top" width="256">
      <p>
        Client sends Renego Info extension for TLS protocol
      </p>
    </td>
    
    <td valign="top">
      <p>
        Client sends SCSV for TLS protocol
      </p>
    </td>
  </tr>
</table>

For example, to get around the TLS Client Hello Extension problem (on non compliant target server) create a DWORD registry value and set the value to 1:

HKEY\_LOCAL\_MACHINE\System\CurrentControlSet\Control\SecurityProviders\SCHANNEL\UseScsvForTls

Reboot and validate that instead of the ClientHelloExtension being sent, the flag is sent as a TLSCipherSuite 255 (0xFF):

<a href="/assets/images/MSDNBlogsFS/prod.evol.blogs.msdn.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/00/83/94/metablogapi/2604.clip_image004_2.png" original-url="http://blogs.msdn.com/cfs-file.ashx/__key/CommunityServer-Blogs-Components-WeblogFiles/00-00-00-83-94-metablogapi/2604.clip_5F00_image004_5F00_2.png"><img loading="lazy" style="background-image: none; margin: 5px 5px 5px 0px; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border-width: 0px;" title="clip_image004" border="0" alt="clip_image004" src="/assets/images/MSDNBlogsFS/prod.evol.blogs.msdn.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/00/83/94/metablogapi/5430.clip_image004_thumb.png" original-url="http://blogs.msdn.com/cfs-file.ashx/__key/CommunityServer-Blogs-Components-WeblogFiles/00-00-00-83-94-metablogapi/5430.clip_5F00_image004_5F00_thumb.png" width="764" height="112" /></a>

This should keep the non-compliant server from choking.

**You can also set this for your application if it is using WinInet, WinHttp or Managed code instead of for the entire machine**

For WinINet based applications (like IE) use the SSL3 Protocol instead of TLS.

In IE this is under the Advanced Settings:

<a href="/assets/images/MSDNBlogsFS/prod.evol.blogs.msdn.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/00/83/94/metablogapi/0143.clip_image005_2.png" original-url="http://blogs.msdn.com/cfs-file.ashx/__key/CommunityServer-Blogs-Components-WeblogFiles/00-00-00-83-94-metablogapi/0143.clip_5F00_image005_5F00_2.png"><img loading="lazy" style="background-image: none; margin: 5px 5px 5px 0px; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border-width: 0px;" title="clip_image005" border="0" alt="clip_image005" src="/assets/images/MSDNBlogsFS/prod.evol.blogs.msdn.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/00/83/94/metablogapi/5758.clip_image005_thumb.png" original-url="http://blogs.msdn.com/cfs-file.ashx/__key/CommunityServer-Blogs-Components-WeblogFiles/00-00-00-83-94-metablogapi/5758.clip_5F00_image005_5F00_thumb.png" width="350" height="404" /></a>

In managed code use the ServicePointManager before making any requests:

ServicePointManager.SecurityProtocol = SecurityProtocolType.Ssl3;

For WinHttp you can set this option in your code: WINHTTP\_OPTION\_SECURE_PROTOCOLS

&nbsp;If this is a third party library, you need to engage that 3rd party and ask them how you can set their classes so that they can use SSL3 instead of TLS!

**Again, this is only temporary. Fix the Server!&nbsp; OpenSSL, Apache etc.. all have fixes for this (see [CVE-2009-3555](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-3555) for links to your product).**

&nbsp;

**What are the other registry keys listed in MS10-049?**

You can _force_ the strict communication by setting the client and/or server to strict mode so you know you will not be vulnerable to [CVE-2009-3555](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-3555).

&nbsp;

**Please let me know if you found this article helpful.**