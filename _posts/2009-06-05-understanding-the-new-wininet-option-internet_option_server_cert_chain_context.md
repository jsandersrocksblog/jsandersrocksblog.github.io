---
id: 873
title: Understanding the new WinInet option INTERNET_OPTION_SERVER_CERT_CHAIN_CONTEXT
date: 2009-06-05T16:03:00-05:00
author: jsanders
layout: post
guid: http://jsandersblog.azurewebsites.net/2009/06/05/understanding-the-new-wininet-option-internet_option_server_cert_chain_context/
permalink: /2009/06/05/understanding-the-new-wininet-option-internet_option_server_cert_chain_context/
orig_url:
  - http://blogs.msdn.microsoft.com/b/jpsanders/archive/2009/06/05/understanding-the-new-wininet-option-internet-option-server-cert-chain-context.aspx
  - http://blogs.msdn.microsoft.com/b/jpsanders/archive/2009/06/05/understanding-the-new-wininet-option-internet-option-server-cert-chain-context.aspx
  - http://blogs.msdn.microsoft.com/b/jpsanders/archive/2009/06/05/understanding-the-new-wininet-option-internet-option-server-cert-chain-context.aspx
  - http://blogs.msdn.microsoft.com/b/jpsanders/archive/2009/06/05/understanding-the-new-wininet-option-internet-option-server-cert-chain-context.aspx
  - http://blogs.msdn.microsoft.com/b/jpsanders/archive/2009/06/05/understanding-the-new-wininet-option-internet-option-server-cert-chain-context.aspx
  - http://blogs.msdn.microsoft.com/b/jpsanders/archive/2009/06/05/understanding-the-new-wininet-option-internet-option-server-cert-chain-context.aspx
  - http://blogs.msdn.microsoft.com/b/jpsanders/archive/2009/06/05/understanding-the-new-wininet-option-internet-option-server-cert-chain-context.aspx
  - http://blogs.msdn.microsoft.com/b/jpsanders/archive/2009/06/05/understanding-the-new-wininet-option-internet-option-server-cert-chain-context.aspx
  - http://blogs.msdn.microsoft.com/b/jpsanders/archive/2009/06/05/understanding-the-new-wininet-option-internet-option-server-cert-chain-context.aspx
  - http://blogs.msdn.microsoft.com/b/jpsanders/archive/2009/06/05/understanding-the-new-wininet-option-internet-option-server-cert-chain-context.aspx
orig_site_id:
  - "8394"
  - "8394"
  - "8394"
  - "8394"
  - "8394"
  - "8394"
  - "8394"
  - "8394"
  - "8394"
  - "8394"
orig_post_id:
  - "9701919"
  - "9701919"
  - "9701919"
  - "9701919"
  - "9701919"
  - "9701919"
  - "9701919"
  - "9701919"
  - "9701919"
  - "9701919"
orig_parent_id:
  - "9701919"
  - "9701919"
  - "9701919"
  - "9701919"
  - "9701919"
  - "9701919"
  - "9701919"
  - "9701919"
  - "9701919"
  - "9701919"
orig_thread_id:
  - "659568"
  - "659568"
  - "659568"
  - "659568"
  - "659568"
  - "659568"
  - "659568"
  - "659568"
  - "659568"
  - "659568"
orig_application_key:
  - jpsanders
  - jpsanders
  - jpsanders
  - jpsanders
  - jpsanders
  - jpsanders
  - jpsanders
  - jpsanders
  - jpsanders
  - jpsanders
orig_post_author_id:
  - "65385"
  - "65385"
  - "65385"
  - "65385"
  - "65385"
  - "65385"
  - "65385"
  - "65385"
  - "65385"
  - "65385"
orig_post_author_username:
  - jpsanders
  - jpsanders
  - jpsanders
  - jpsanders
  - jpsanders
  - jpsanders
  - jpsanders
  - jpsanders
  - jpsanders
  - jpsanders
orig_post_author_created:
  - Jan 18 2007 01:34:53:000PM
  - Jan 18 2007 01:34:53:000PM
  - Jan 18 2007 01:34:53:000PM
  - Jan 18 2007 01:34:53:000PM
  - Jan 18 2007 01:34:53:000PM
  - Jan 18 2007 01:34:53:000PM
  - Jan 18 2007 01:34:53:000PM
  - Jan 18 2007 01:34:53:000PM
  - Jan 18 2007 01:34:53:000PM
  - Jan 18 2007 01:34:53:000PM
orig_is_approved:
  - "1"
  - "1"
  - "1"
  - "1"
  - "1"
  - "1"
  - "1"
  - "1"
  - "1"
  - "1"
orig_attachment_count:
  - "0"
  - "0"
  - "0"
  - "0"
  - "0"
  - "0"
  - "0"
  - "0"
  - "0"
  - "0"
orig_url_title:
  - http://blogs.msdn.com/b/jpsanders/archive/2009/06/05/understanding-the-new-wininet-option-internet_option_server_cert_chain_context.aspx
  - http://blogs.msdn.com/b/jpsanders/archive/2009/06/05/understanding-the-new-wininet-option-internet_option_server_cert_chain_context.aspx
  - http://blogs.msdn.com/b/jpsanders/archive/2009/06/05/understanding-the-new-wininet-option-internet_option_server_cert_chain_context.aspx
  - http://blogs.msdn.com/b/jpsanders/archive/2009/06/05/understanding-the-new-wininet-option-internet_option_server_cert_chain_context.aspx
  - http://blogs.msdn.com/b/jpsanders/archive/2009/06/05/understanding-the-new-wininet-option-internet_option_server_cert_chain_context.aspx
  - http://blogs.msdn.com/b/jpsanders/archive/2009/06/05/understanding-the-new-wininet-option-internet_option_server_cert_chain_context.aspx
  - http://blogs.msdn.com/b/jpsanders/archive/2009/06/05/understanding-the-new-wininet-option-internet_option_server_cert_chain_context.aspx
  - http://blogs.msdn.com/b/jpsanders/archive/2009/06/05/understanding-the-new-wininet-option-internet_option_server_cert_chain_context.aspx
  - http://blogs.msdn.com/b/jpsanders/archive/2009/06/05/understanding-the-new-wininet-option-internet_option_server_cert_chain_context.aspx
  - http://blogs.msdn.com/b/jpsanders/archive/2009/06/05/understanding-the-new-wininet-option-internet_option_server_cert_chain_context.aspx
opengraph_tags:
  - |
    <meta property="og:type" content="article" />
    <meta property="og:title" content="Understanding the new WinInet option INTERNET_OPTION_SERVER_CERT_CHAIN_CONTEXT" />
    <meta property="og:url" content="https://blogs.msdn.microsoft.com/jpsanders/2009/06/05/understanding-the-new-wininet-option-internet_option_server_cert_chain_context/" />
    <meta property="og:site_name" content="Http Client Protocol Issues (and other fun stuff I support)" />
    <meta property="og:description" content="With the release of Internet Explorer 8 comes a new option you can query for with programming with the WinInet APIs: INTERNET_OPTION_SERVER_CERT_CHAIN_CONTEXT.&nbsp; The MSDN documentation tells you it allows you to get the PCCERT_CHAIN_CONTEXT, and not much more.&nbsp;&nbsp;It does not show you how to properly get the Context.&nbsp; I like to see things in action..." />
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="Understanding the new WinInet option INTERNET_OPTION_SERVER_CERT_CHAIN_CONTEXT" />
    <meta name="twitter:url" content="https://blogs.msdn.microsoft.com/jpsanders/2009/06/05/understanding-the-new-wininet-option-internet_option_server_cert_chain_context/" />
    <meta name="twitter:description" content="With the release of Internet Explorer 8 comes a new option you can query for with programming with the WinInet APIs: INTERNET_OPTION_SERVER_CERT_CHAIN_CONTEXT.&nbsp; The MSDN documentation tells you it allows you to get the PCCERT_CHAIN_CONTEXT, and not much more.&nbsp;&nbsp;It does not show you how to properly get the Context.&nbsp; I like to see things in action..." />
    
  - |
    <meta property="og:type" content="article" />
    <meta property="og:title" content="Understanding the new WinInet option INTERNET_OPTION_SERVER_CERT_CHAIN_CONTEXT" />
    <meta property="og:url" content="https://blogs.msdn.microsoft.com/jpsanders/2009/06/05/understanding-the-new-wininet-option-internet_option_server_cert_chain_context/" />
    <meta property="og:site_name" content="Http Client Protocol Issues (and other fun stuff I support)" />
    <meta property="og:description" content="With the release of Internet Explorer 8 comes a new option you can query for with programming with the WinInet APIs: INTERNET_OPTION_SERVER_CERT_CHAIN_CONTEXT.&nbsp; The MSDN documentation tells you it allows you to get the PCCERT_CHAIN_CONTEXT, and not much more.&nbsp;&nbsp;It does not show you how to properly get the Context.&nbsp; I like to see things in action..." />
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="Understanding the new WinInet option INTERNET_OPTION_SERVER_CERT_CHAIN_CONTEXT" />
    <meta name="twitter:url" content="https://blogs.msdn.microsoft.com/jpsanders/2009/06/05/understanding-the-new-wininet-option-internet_option_server_cert_chain_context/" />
    <meta name="twitter:description" content="With the release of Internet Explorer 8 comes a new option you can query for with programming with the WinInet APIs: INTERNET_OPTION_SERVER_CERT_CHAIN_CONTEXT.&nbsp; The MSDN documentation tells you it allows you to get the PCCERT_CHAIN_CONTEXT, and not much more.&nbsp;&nbsp;It does not show you how to properly get the Context.&nbsp; I like to see things in action..." />
    
  - |
    <meta property="og:type" content="article" />
    <meta property="og:title" content="Understanding the new WinInet option INTERNET_OPTION_SERVER_CERT_CHAIN_CONTEXT" />
    <meta property="og:url" content="https://blogs.msdn.microsoft.com/jpsanders/2009/06/05/understanding-the-new-wininet-option-internet_option_server_cert_chain_context/" />
    <meta property="og:site_name" content="Http Client Protocol Issues (and other fun stuff I support)" />
    <meta property="og:description" content="With the release of Internet Explorer 8 comes a new option you can query for with programming with the WinInet APIs: INTERNET_OPTION_SERVER_CERT_CHAIN_CONTEXT.&nbsp; The MSDN documentation tells you it allows you to get the PCCERT_CHAIN_CONTEXT, and not much more.&nbsp;&nbsp;It does not show you how to properly get the Context.&nbsp; I like to see things in action..." />
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="Understanding the new WinInet option INTERNET_OPTION_SERVER_CERT_CHAIN_CONTEXT" />
    <meta name="twitter:url" content="https://blogs.msdn.microsoft.com/jpsanders/2009/06/05/understanding-the-new-wininet-option-internet_option_server_cert_chain_context/" />
    <meta name="twitter:description" content="With the release of Internet Explorer 8 comes a new option you can query for with programming with the WinInet APIs: INTERNET_OPTION_SERVER_CERT_CHAIN_CONTEXT.&nbsp; The MSDN documentation tells you it allows you to get the PCCERT_CHAIN_CONTEXT, and not much more.&nbsp;&nbsp;It does not show you how to properly get the Context.&nbsp; I like to see things in action..." />
    
  - |
    <meta property="og:type" content="article" />
    <meta property="og:title" content="Understanding the new WinInet option INTERNET_OPTION_SERVER_CERT_CHAIN_CONTEXT" />
    <meta property="og:url" content="https://blogs.msdn.microsoft.com/jpsanders/2009/06/05/understanding-the-new-wininet-option-internet_option_server_cert_chain_context/" />
    <meta property="og:site_name" content="Http Client Protocol Issues (and other fun stuff I support)" />
    <meta property="og:description" content="With the release of Internet Explorer 8 comes a new option you can query for with programming with the WinInet APIs: INTERNET_OPTION_SERVER_CERT_CHAIN_CONTEXT.&nbsp; The MSDN documentation tells you it allows you to get the PCCERT_CHAIN_CONTEXT, and not much more.&nbsp;&nbsp;It does not show you how to properly get the Context.&nbsp; I like to see things in action..." />
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="Understanding the new WinInet option INTERNET_OPTION_SERVER_CERT_CHAIN_CONTEXT" />
    <meta name="twitter:url" content="https://blogs.msdn.microsoft.com/jpsanders/2009/06/05/understanding-the-new-wininet-option-internet_option_server_cert_chain_context/" />
    <meta name="twitter:description" content="With the release of Internet Explorer 8 comes a new option you can query for with programming with the WinInet APIs: INTERNET_OPTION_SERVER_CERT_CHAIN_CONTEXT.&nbsp; The MSDN documentation tells you it allows you to get the PCCERT_CHAIN_CONTEXT, and not much more.&nbsp;&nbsp;It does not show you how to properly get the Context.&nbsp; I like to see things in action..." />
    
  - |
    <meta property="og:type" content="article" />
    <meta property="og:title" content="Understanding the new WinInet option INTERNET_OPTION_SERVER_CERT_CHAIN_CONTEXT" />
    <meta property="og:url" content="https://blogs.msdn.microsoft.com/jpsanders/2009/06/05/understanding-the-new-wininet-option-internet_option_server_cert_chain_context/" />
    <meta property="og:site_name" content="Http Client Protocol Issues (and other fun stuff I support)" />
    <meta property="og:description" content="With the release of Internet Explorer 8 comes a new option you can query for with programming with the WinInet APIs: INTERNET_OPTION_SERVER_CERT_CHAIN_CONTEXT.&nbsp; The MSDN documentation tells you it allows you to get the PCCERT_CHAIN_CONTEXT, and not much more.&nbsp;&nbsp;It does not show you how to properly get the Context.&nbsp; I like to see things in action..." />
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="Understanding the new WinInet option INTERNET_OPTION_SERVER_CERT_CHAIN_CONTEXT" />
    <meta name="twitter:url" content="https://blogs.msdn.microsoft.com/jpsanders/2009/06/05/understanding-the-new-wininet-option-internet_option_server_cert_chain_context/" />
    <meta name="twitter:description" content="With the release of Internet Explorer 8 comes a new option you can query for with programming with the WinInet APIs: INTERNET_OPTION_SERVER_CERT_CHAIN_CONTEXT.&nbsp; The MSDN documentation tells you it allows you to get the PCCERT_CHAIN_CONTEXT, and not much more.&nbsp;&nbsp;It does not show you how to properly get the Context.&nbsp; I like to see things in action..." />
    
  - |
    <meta property="og:type" content="article" />
    <meta property="og:title" content="Understanding the new WinInet option INTERNET_OPTION_SERVER_CERT_CHAIN_CONTEXT" />
    <meta property="og:url" content="https://blogs.msdn.microsoft.com/jpsanders/2009/06/05/understanding-the-new-wininet-option-internet_option_server_cert_chain_context/" />
    <meta property="og:site_name" content="Http Client Protocol Issues (and other fun stuff I support)" />
    <meta property="og:description" content="With the release of Internet Explorer 8 comes a new option you can query for with programming with the WinInet APIs: INTERNET_OPTION_SERVER_CERT_CHAIN_CONTEXT.&nbsp; The MSDN documentation tells you it allows you to get the PCCERT_CHAIN_CONTEXT, and not much more.&nbsp;&nbsp;It does not show you how to properly get the Context.&nbsp; I like to see things in action..." />
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="Understanding the new WinInet option INTERNET_OPTION_SERVER_CERT_CHAIN_CONTEXT" />
    <meta name="twitter:url" content="https://blogs.msdn.microsoft.com/jpsanders/2009/06/05/understanding-the-new-wininet-option-internet_option_server_cert_chain_context/" />
    <meta name="twitter:description" content="With the release of Internet Explorer 8 comes a new option you can query for with programming with the WinInet APIs: INTERNET_OPTION_SERVER_CERT_CHAIN_CONTEXT.&nbsp; The MSDN documentation tells you it allows you to get the PCCERT_CHAIN_CONTEXT, and not much more.&nbsp;&nbsp;It does not show you how to properly get the Context.&nbsp; I like to see things in action..." />
    
  - |
    <meta property="og:type" content="article" />
    <meta property="og:title" content="Understanding the new WinInet option INTERNET_OPTION_SERVER_CERT_CHAIN_CONTEXT" />
    <meta property="og:url" content="https://blogs.msdn.microsoft.com/jpsanders/2009/06/05/understanding-the-new-wininet-option-internet_option_server_cert_chain_context/" />
    <meta property="og:site_name" content="Http Client Protocol Issues (and other fun stuff I support)" />
    <meta property="og:description" content="With the release of Internet Explorer 8 comes a new option you can query for with programming with the WinInet APIs: INTERNET_OPTION_SERVER_CERT_CHAIN_CONTEXT.&nbsp; The MSDN documentation tells you it allows you to get the PCCERT_CHAIN_CONTEXT, and not much more.&nbsp;&nbsp;It does not show you how to properly get the Context.&nbsp; I like to see things in action..." />
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="Understanding the new WinInet option INTERNET_OPTION_SERVER_CERT_CHAIN_CONTEXT" />
    <meta name="twitter:url" content="https://blogs.msdn.microsoft.com/jpsanders/2009/06/05/understanding-the-new-wininet-option-internet_option_server_cert_chain_context/" />
    <meta name="twitter:description" content="With the release of Internet Explorer 8 comes a new option you can query for with programming with the WinInet APIs: INTERNET_OPTION_SERVER_CERT_CHAIN_CONTEXT.&nbsp; The MSDN documentation tells you it allows you to get the PCCERT_CHAIN_CONTEXT, and not much more.&nbsp;&nbsp;It does not show you how to properly get the Context.&nbsp; I like to see things in action..." />
    
  - |
    <meta property="og:type" content="article" />
    <meta property="og:title" content="Understanding the new WinInet option INTERNET_OPTION_SERVER_CERT_CHAIN_CONTEXT" />
    <meta property="og:url" content="https://blogs.msdn.microsoft.com/jpsanders/2009/06/05/understanding-the-new-wininet-option-internet_option_server_cert_chain_context/" />
    <meta property="og:site_name" content="Http Client Protocol Issues (and other fun stuff I support)" />
    <meta property="og:description" content="With the release of Internet Explorer 8 comes a new option you can query for with programming with the WinInet APIs: INTERNET_OPTION_SERVER_CERT_CHAIN_CONTEXT.&nbsp; The MSDN documentation tells you it allows you to get the PCCERT_CHAIN_CONTEXT, and not much more.&nbsp;&nbsp;It does not show you how to properly get the Context.&nbsp; I like to see things in action..." />
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="Understanding the new WinInet option INTERNET_OPTION_SERVER_CERT_CHAIN_CONTEXT" />
    <meta name="twitter:url" content="https://blogs.msdn.microsoft.com/jpsanders/2009/06/05/understanding-the-new-wininet-option-internet_option_server_cert_chain_context/" />
    <meta name="twitter:description" content="With the release of Internet Explorer 8 comes a new option you can query for with programming with the WinInet APIs: INTERNET_OPTION_SERVER_CERT_CHAIN_CONTEXT.&nbsp; The MSDN documentation tells you it allows you to get the PCCERT_CHAIN_CONTEXT, and not much more.&nbsp;&nbsp;It does not show you how to properly get the Context.&nbsp; I like to see things in action..." />
    
  - |
    <meta property="og:type" content="article" />
    <meta property="og:title" content="Understanding the new WinInet option INTERNET_OPTION_SERVER_CERT_CHAIN_CONTEXT" />
    <meta property="og:url" content="https://blogs.msdn.microsoft.com/jpsanders/2009/06/05/understanding-the-new-wininet-option-internet_option_server_cert_chain_context/" />
    <meta property="og:site_name" content="Http Client Protocol Issues (and other fun stuff I support)" />
    <meta property="og:description" content="With the release of Internet Explorer 8 comes a new option you can query for with programming with the WinInet APIs: INTERNET_OPTION_SERVER_CERT_CHAIN_CONTEXT.&nbsp; The MSDN documentation tells you it allows you to get the PCCERT_CHAIN_CONTEXT, and not much more.&nbsp;&nbsp;It does not show you how to properly get the Context.&nbsp; I like to see things in action..." />
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="Understanding the new WinInet option INTERNET_OPTION_SERVER_CERT_CHAIN_CONTEXT" />
    <meta name="twitter:url" content="https://blogs.msdn.microsoft.com/jpsanders/2009/06/05/understanding-the-new-wininet-option-internet_option_server_cert_chain_context/" />
    <meta name="twitter:description" content="With the release of Internet Explorer 8 comes a new option you can query for with programming with the WinInet APIs: INTERNET_OPTION_SERVER_CERT_CHAIN_CONTEXT.&nbsp; The MSDN documentation tells you it allows you to get the PCCERT_CHAIN_CONTEXT, and not much more.&nbsp;&nbsp;It does not show you how to properly get the Context.&nbsp; I like to see things in action..." />
    
  - |
    <meta property="og:type" content="article" />
    <meta property="og:title" content="Understanding the new WinInet option INTERNET_OPTION_SERVER_CERT_CHAIN_CONTEXT" />
    <meta property="og:url" content="https://blogs.msdn.microsoft.com/jpsanders/2009/06/05/understanding-the-new-wininet-option-internet_option_server_cert_chain_context/" />
    <meta property="og:site_name" content="Http Client Protocol Issues (and other fun stuff I support)" />
    <meta property="og:description" content="With the release of Internet Explorer 8 comes a new option you can query for with programming with the WinInet APIs: INTERNET_OPTION_SERVER_CERT_CHAIN_CONTEXT.&nbsp; The MSDN documentation tells you it allows you to get the PCCERT_CHAIN_CONTEXT, and not much more.&nbsp;&nbsp;It does not show you how to properly get the Context.&nbsp; I like to see things in action..." />
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="Understanding the new WinInet option INTERNET_OPTION_SERVER_CERT_CHAIN_CONTEXT" />
    <meta name="twitter:url" content="https://blogs.msdn.microsoft.com/jpsanders/2009/06/05/understanding-the-new-wininet-option-internet_option_server_cert_chain_context/" />
    <meta name="twitter:description" content="With the release of Internet Explorer 8 comes a new option you can query for with programming with the WinInet APIs: INTERNET_OPTION_SERVER_CERT_CHAIN_CONTEXT.&nbsp; The MSDN documentation tells you it allows you to get the PCCERT_CHAIN_CONTEXT, and not much more.&nbsp;&nbsp;It does not show you how to properly get the Context.&nbsp; I like to see things in action..." />
    
categories:
  - Uncategorized
tags:
  - IE 8
  - WinInet
---
With the release of Internet Explorer 8 comes a new option you can query for with programming with the WinInet APIs: INTERNET\_OPTION\_SERVER\_CERT\_CHAIN_CONTEXT.&nbsp; The MSDN documentation tells you it allows you to get the <font size=2>PCCERT\_CHAIN\_CONTEXT</font>, and not much more.&nbsp;&nbsp;It does not show you how to properly get the Context.&nbsp; I like to see things in action so here is some sample code.

This option is documented here: <a href="http://msdn.microsoft.com/en-us/library/aa385328(VS.85).aspx" mce_href="http://msdn.microsoft.com/en-us/library/aa385328(VS.85).aspx">http://msdn.microsoft.com/en-us/library/aa385328(VS.85).aspx</a> (note that if you are not using the latest SDK headers, the value for this option is also documented here).

To sum it up, use this option to get the Server Certificate Chain Context&nbsp; to use with other Crypto API functions&nbsp; To understand this option you can modify the HttpDump example in the Platforms SDK and see how this option can be used.&nbsp;&nbsp; Since this is an option for the request you get this option using&nbsp;the request handle&nbsp;after you execute the request.&nbsp; I am not a Crypto API guru so I stole some code examples from MSDN just to dump out some information about the&nbsp;Certificate&nbsp;Chain.&nbsp;  
&nbsp;  
The most important (and undocumented) part of getting this option is to pass a Pointer to a&nbsp; <font size=2>PCCERT\_CHAIN\_CONTEXT.&nbsp;&nbsp;Below is a code snippet that I added to the HttpDump sample in the Windows 7 SDK (RC).</font>

First, there is a problem with that sample when compiled for unicode.&nbsp; I fixed it with this replacement code:

**C++ code listing&nbsp;for sample&nbsp;([Copy Code](javascript:CopyCode('certctxcode1');)):**<div id=certctxcode1 style="BACKGROUND-COLOR: #e0e0e0"> 

dwSize=0;  
TCHAR *myBuff = NULL;

</font><font color=#008000 size=2><font color=#008000 size=2>

// First time we will find out the size of the headers.  
</font></font><font size=2>HttpQueryInfo (hReq,HTTP\_QUERY\_RAW\_HEADERS\_CRLF, NULL, &dwSize, NULL);  
myBuff = </font><font color=#0000ff size=2><font color=#0000ff size=2>new</font></font><font size=2> TCHAR [dwSize+1];  
</font><font color=#008000 size=2><font color=#008000 size=2>// Now we call HttpQueryInfo again to get the headers.  
</font></font><font color=#0000ff size=2><font color=#0000ff size=2>if</font></font><font size=2> (!HttpQueryInfo (hReq,HTTP\_QUERY\_RAW\_HEADERS\_CRLF, (LPVOID) myBuff,  
&dwSize, NULL))  
{  
&nbsp;&nbsp;&nbsp; ErrorOut (GetLastError(), TEXT(</font><font color=#a31515 size=2><font color=#a31515 size=2>&#8220;HttpQueryInfo&#8221;</font></font><font size=2>));  
}  
</font><font color=#0000ff size=2><font color=#0000ff size=2>else  
</font></font><font size=2>{  
&nbsp;&nbsp;&nbsp; *(myBuff + dwSize) = </font><font color=#a31515 size=2><font color=#a31515 size=2>&#8216;\0&#8217;</font></font><font size=2>;  
&nbsp;&nbsp;&nbsp; wcout << myBuff << endl;  
}  
</font>

<font color=#0000ff size=2><font color=#0000ff size=2>delete</font></font><font size=2> myBuff;</font></div> 

<font size=2>Next I added this code just before closing the request handle ( &#8216;<font color=#0000ff size=2><font color=#0000ff size=2>if</font></font><font size=2> (!InternetCloseHandle (hReq) )&#8217; ).

</font></font>

**C++ code listing&nbsp;for sample&nbsp;([Copy Code](javascript:CopyCode('certctxcode2');)):**<div id=certctxcode2 style="BACKGROUND-COLOR: #e0e0e0"><font size=2><font size=2></p> 

PCCERT\_CHAIN\_CONTEXT CertCtx=NULL;  
DWORD cbCertSize = </font><font color=#0000ff size=2><font color=#0000ff size=2>sizeof</font></font><font size=2>(&CertCtx);

</font><font color=#008000 size=2><font color=#008000 size=2>

//GetCertificate information  
</font></font><font color=#0000ff size=2><font color=#0000ff size=2>if</font></font><font size=2> (InternetQueryOption(hReq,INTERNET\_OPTION\_SERVER\_CERT\_CHAIN_CONTEXT ,(LPVOID)&CertCtx,&cbCertSize))  
{  
</font><font color=#008000 size=2><font color=#008000 size=2>//&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;  
</font></font><font size=2></font><font color=#008000 size=2><font color=#008000 size=2>// Display some of the contents of the chain.  
</font></font><font size=2>PCCERT\_CHAIN\_CONTEXT pChainContext=CertCtx;  
printf(</font><font color=#a31515 size=2><font color=#a31515 size=2>&#8220;The size of the chain context </font></font><font color=#a31515 size=2><font color=#a31515 size=2>is %d. \n&#8221;</font></font><font size=2>,pChainContext->cbSize);  
printf(</font><font color=#a31515 size=2><font color=#a31515 size=2>&#8220;%d simple chains found.\n&#8221;</font></font><font size=2>,pChainContext->cChain);  
printf(</font><font color=#a31515 size=2><font color=#a31515 size=2>&#8220;\nError status for the chain:\n&#8221;</font></font><font size=2>);  
</font><font color=#0000ff size=2><font color=#0000ff size=2>switch</font></font><font size=2>(pChainContext->TrustStatus.dwErrorStatus)  
{  
</font><font color=#0000ff size=2><font color=#0000ff size=2>case</font></font><font size=2> CERT\_TRUST\_NO_ERROR :  
printf(</font><font color=#a31515 size=2><font color=#a31515 size=2>&#8220;No error found for this certificate or chain.\n&#8221;</font></font><font size=2>);  
</font><font color=#0000ff size=2><font color=#0000ff size=2>break</font></font><font size=2>;  
</font><font color=#0000ff size=2><font color=#0000ff size=2>case</font></font><font size=2> CERT\_TRUST\_IS\_NOT\_TIME_VALID:  
printf(</font><font color=#a31515 size=2><font color=#a31515 size=2>&#8220;This certificate or one of the certificates in the </font></font><font color=#a31515 size=2><font color=#a31515 size=2>certificate chain is not time-valid.\n&#8221;</font></font><font size=2>);  
</font><font color=#0000ff size=2><font color=#0000ff size=2>break</font></font><font size=2>;  
</font><font color=#0000ff size=2><font color=#0000ff size=2>case</font></font><font size=2> CERT\_TRUST\_IS\_NOT\_TIME_NESTED:  
printf(</font><font color=#a31515 size=2><font color=#a31515 size=2>&#8220;Certificates in the chain are not properly </font></font><font color=#a31515 size=2><font color=#a31515 size=2>time-nested.\n&#8221;</font></font><font size=2>);  
</font><font color=#0000ff size=2><font color=#0000ff size=2>break</font></font><font size=2>;  
</font><font color=#0000ff size=2><font color=#0000ff size=2>case</font></font><font size=2> CERT\_TRUST\_IS_REVOKED:  
printf(</font><font color=#a31515 size=2><font color=#a31515 size=2>&#8220;Trust for this certificate or one of the certificates </font></font><font color=#a31515 size=2><font color=#a31515 size=2>in the certificate chain has been revoked.\n&#8221;</font></font><font size=2>);  
</font><font color=#0000ff size=2><font color=#0000ff size=2>break</font></font><font size=2>;  
</font><font color=#0000ff size=2><font color=#0000ff size=2>case</font></font><font size=2> CERT\_TRUST\_IS\_NOT\_SIGNATURE_VALID:  
printf(</font><font color=#a31515 size=2><font color=#a31515 size=2>&#8220;The certificate or one of the certificates in the </font></font><font color=#a31515 size=2><font color=#a31515 size=2>certificate chain does not have a valid signature.\n&#8221;</font></font><font size=2>);  
</font><font color=#0000ff size=2><font color=#0000ff size=2>break</font></font><font size=2>;  
</font><font color=#0000ff size=2><font color=#0000ff size=2>case</font></font><font size=2> CERT\_TRUST\_IS\_NOT\_VALID\_FOR\_USAGE:  
printf(</font><font color=#a31515 size=2><font color=#a31515 size=2>&#8220;The certificate or certificate chain is not valid </font></font><font color=#a31515 size=2><font color=#a31515 size=2>in its proposed usage.\n&#8221;</font></font><font size=2>);  
</font><font color=#0000ff size=2><font color=#0000ff size=2>break</font></font><font size=2>;  
</font><font color=#0000ff size=2><font color=#0000ff size=2>case</font></font><font size=2> CERT\_TRUST\_IS\_UNTRUSTED\_ROOT:  
printf(</font><font color=#a31515 size=2><font color=#a31515 size=2>&#8220;The certificate or certificate chain is based </font></font><font color=#a31515 size=2><font color=#a31515 size=2>on an untrusted root.\n&#8221;</font></font><font size=2>);  
</font><font color=#0000ff size=2><font color=#0000ff size=2>break</font></font><font size=2>;  
</font><font color=#0000ff size=2><font color=#0000ff size=2>case</font></font><font size=2> CERT\_TRUST\_REVOCATION\_STATUS\_UNKNOWN:  
printf(</font><font color=#a31515 size=2><font color=#a31515 size=2>&#8220;The revocation status of the certificate or one of the </font></font><font color=#a31515 size=2><font color=#a31515 size=2>certificates in the certificate chain is unknown.\n&#8221;</font></font><font size=2>);  
</font><font color=#0000ff size=2><font color=#0000ff size=2>break</font></font><font size=2>;  
</font><font color=#0000ff size=2><font color=#0000ff size=2>case</font></font><font size=2> CERT\_TRUST\_IS_CYCLIC :  
printf(</font><font color=#a31515 size=2><font color=#a31515 size=2>&#8220;One of the certificates in the chain was issued by a </font></font><font color=#a31515 size=2><font color=#a31515 size=2>certification authority that the original certificate </font></font><font color=#a31515 size=2><font color=#a31515 size=2>had certified.\n&#8221;</font></font><font size=2>);  
</font><font color=#0000ff size=2><font color=#0000ff size=2>break</font></font><font size=2>;  
</font><font color=#0000ff size=2><font color=#0000ff size=2>case</font></font><font size=2> CERT\_TRUST\_IS\_PARTIAL\_CHAIN:  
printf(</font><font color=#a31515 size=2><font color=#a31515 size=2>&#8220;The certificate chain is not complete.\n&#8221;</font></font><font size=2>);  
</font><font color=#0000ff size=2><font color=#0000ff size=2>break</font></font><font size=2>;  
</font><font color=#0000ff size=2><font color=#0000ff size=2>case</font></font><font size=2> CERT\_TRUST\_CTL\_IS\_NOT\_TIME\_VALID:  
printf(</font><font color=#a31515 size=2><font color=#a31515 size=2>&#8220;A CTL used to create this chain was not time-valid.\n&#8221;</font></font><font size=2>);  
</font><font color=#0000ff size=2><font color=#0000ff size=2>break</font></font><font size=2>;  
</font><font color=#0000ff size=2><font color=#0000ff size=2>case</font></font><font size=2> CERT\_TRUST\_CTL\_IS\_NOT\_SIGNATURE\_VALID:  
printf(</font><font color=#a31515 size=2><font color=#a31515 size=2>&#8220;A CTL used to create this chain did not have a valid </font></font><font color=#a31515 size=2><font color=#a31515 size=2>signature.\n&#8221;</font></font><font size=2>);  
</font><font color=#0000ff size=2><font color=#0000ff size=2>break</font></font><font size=2>;</font>  
<font color=#0000ff size=2><font color=#0000ff size=2>case</font></font><font size=2> CERT\_TRUST\_CTL\_IS\_NOT\_VALID\_FOR_USAGE:  
printf(</font><font color=#a31515 size=2><font color=#a31515 size=2>&#8220;A CTL used to create this chain is not valid for this </font></font><font color=#a31515 size=2><font color=#a31515 size=2>usage.\n&#8221;</font></font><font size=2>);  
} </font><font color=#008000 size=2><font color=#008000 size=2>// End switch

</font></font><font size=2>

printf(</font><font color=#a31515 size=2><font color=#a31515 size=2>&#8220;\nInfo status for the chain:\n&#8221;</font></font><font size=2>);  
</font><font color=#0000ff size=2><font color=#0000ff size=2>switch</font></font><font size=2>(pChainContext->TrustStatus.dwInfoStatus)  
{  
</font><font color=#0000ff size=2><font color=#0000ff size=2>case</font></font><font size=2> 0:  
printf(</font><font color=#a31515 size=2><font color=#a31515 size=2>&#8220;No information status reported.\n&#8221;</font></font><font size=2>);  
</font><font color=#0000ff size=2><font color=#0000ff size=2>break</font></font><font size=2>;  
</font><font color=#0000ff size=2><font color=#0000ff size=2>case</font></font><font size=2> CERT\_TRUST\_HAS\_EXACT\_MATCH_ISSUER :  
printf(</font><font color=#a31515 size=2><font color=#a31515 size=2>&#8220;An exact match issuer certificate has been found for </font></font><font color=#a31515 size=2><font color=#a31515 size=2>this certificate.\n&#8221;</font></font><font size=2>);  
</font><font color=#0000ff size=2><font color=#0000ff size=2>break</font></font><font size=2>;  
</font><font color=#0000ff size=2><font color=#0000ff size=2>case</font></font><font size=2> CERT\_TRUST\_HAS\_KEY\_MATCH_ISSUER:  
printf(</font><font color=#a31515 size=2><font color=#a31515 size=2>&#8220;A key match issuer certificate has been found for this </font></font><font color=#a31515 size=2><font color=#a31515 size=2>certificate.\n&#8221;</font></font><font size=2>);  
</font><font color=#0000ff size=2><font color=#0000ff size=2>break</font></font><font size=2>;  
</font><font color=#0000ff size=2><font color=#0000ff size=2>case</font></font><font size=2> CERT\_TRUST\_HAS\_NAME\_MATCH_ISSUER:  
printf(</font><font color=#a31515 size=2><font color=#a31515 size=2>&#8220;A name match issuer certificate has been found for this </font></font><font color=#a31515 size=2><font color=#a31515 size=2>certificate.\n&#8221;</font></font><font size=2>);  
</font><font color=#0000ff size=2><font color=#0000ff size=2>break</font></font><font size=2>;  
</font><font color=#0000ff size=2><font color=#0000ff size=2>case</font></font><font size=2> CERT\_TRUST\_IS\_SELF\_SIGNED:  
printf(</font><font color=#a31515 size=2><font color=#a31515 size=2>&#8220;This certificate is self-signed.\n&#8221;</font></font><font size=2>);  
</font><font color=#0000ff size=2><font color=#0000ff size=2>break</font></font><font size=2>;  
</font><font color=#0000ff size=2><font color=#0000ff size=2>case</font></font><font size=2> CERT\_TRUST\_IS\_COMPLEX\_CHAIN:  
printf(</font><font color=#a31515 size=2><font color=#a31515 size=2>&#8220;The certificate chain created is a complex chain.\n&#8221;</font></font><font size=2>);  
</font><font color=#0000ff size=2><font color=#0000ff size=2>break</font></font><font size=2>;  
</font><font color=#0000ff size=2><font color=#0000ff size=2>case</font></font><font size=2> CERT\_TRUST\_HAS\_PREFERRED\_ISSUER:  
printf(</font><font color=#a31515 size=2><font color=#a31515 size=2>&#8220;The certificate chain has a preferred issuer.\n&#8221;</font></font><font size=2>);  
</font><font color=#0000ff size=2><font color=#0000ff size=2>break</font></font><font size=2>;  
</font><font color=#0000ff size=2><font color=#0000ff size=2>case</font></font><font size=2> CERT\_TRUST\_HAS\_ISSUANCE\_CHAIN_POLICY:  
printf(</font><font color=#a31515 size=2><font color=#a31515 size=2>&#8220;The certificate chain has issuance chain policy.\n&#8221;</font></font><font size=2>);  
</font><font color=#0000ff size=2><font color=#0000ff size=2>break</font></font><font size=2>;  
</font><font color=#0000ff size=2><font color=#0000ff size=2>case</font></font><font size=2> CERT\_TRUST\_HAS\_VALID\_NAME_CONSTRAINTS:  
printf(</font><font color=#a31515 size=2><font color=#a31515 size=2>&#8220;The certificate chain valid name contraints.\n&#8221;</font></font><font size=2>);  
</font><font color=#0000ff size=2><font color=#0000ff size=2>break</font></font><font size=2>;  
</font><font color=#0000ff size=2><font color=#0000ff size=2>case</font></font><font size=2> CERT\_TRUST\_IS\_PEER\_TRUSTED:  
printf(</font><font color=#a31515 size=2><font color=#a31515 size=2>&#8220;The certificate chain is peer trusted.\n&#8221;</font></font><font size=2>);  
</font><font color=#0000ff size=2><font color=#0000ff size=2>break</font></font><font size=2>;  
</font><font color=#0000ff size=2><font color=#0000ff size=2>case</font></font><font size=2> CERT\_TRUST\_HAS\_CRL\_VALIDITY_EXTENDED:  
printf(</font><font color=#a31515 size=2><font color=#a31515 size=2>&#8220;The certificate chain has CRL validity extended.\n&#8221;</font></font><font size=2>);  
</font><font color=#0000ff size=2><font color=#0000ff size=2>break</font></font><font size=2>;  
</font><font color=#0000ff size=2><font color=#0000ff size=2>case</font></font><font size=2> CERT\_TRUST\_IS\_FROM\_EXCLUSIVE\_TRUST\_STORE:  
printf(</font><font color=#a31515 size=2><font color=#a31515 size=2>&#8220;The certificate chain was found in a store specified by hExclusiveRoot or hExclusiveTrustedPeople.\n&#8221;</font></font><font size=2>);  
</font><font color=#0000ff size=2><font color=#0000ff size=2>break</font></font><font size=2>;  
} </font><font color=#008000 size=2><font color=#008000 size=2>// end switch<p mce_keep="true"></font></font><font size=2>CERT\_SIMPLE\_CHAIN *simpleCertificateChainWithinContext = NULL;

  
</font><font color=#0000ff size=2><font color=#0000ff size=2>for</font></font><font size=2> (</font><font color=#0000ff size=2><font color=#0000ff size=2>int</font></font><font size=2> i=0; i<pChainContext->cChain; i++)  
{  
&nbsp;&nbsp;&nbsp; simpleCertificateChainWithinContext=pChainContext->rgpChain[i];  
</font><font color=#008000 size=2><font color=#008000 size=2>&nbsp;&nbsp;&nbsp; // for each certificate chain in this context&#8230;  
&nbsp;&nbsp;&nbsp; </font></font><font size=2></font><font color=#0000ff size=2><font color=#0000ff size=2>for</font></font><font size=2> (</font><font color=#0000ff size=2><font color=#0000ff size=2>int</font></font><font size=2> simpleCertChainIndex = 0;  
&nbsp;&nbsp;&nbsp; simpleCertChainIndex < simpleCertificateChainWithinContext->cElement;  
&nbsp;&nbsp;&nbsp; simpleCertChainIndex++)  
&nbsp;&nbsp;&nbsp; {  
<font color=#008000 size=2><font color=#008000 size=2></p> 

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // get the CertContext from the array  
</font></font></font><font color=#008000 size=2><font color=#008000 size=2>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></font><font size=2>PCCERT_CONTEXT pCertContext =  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; simpleCertificateChainWithinContext->rgpElement[simpleCertChainIndex]->pCertContext;

</font><font color=#008000 size=2><font color=#008000 size=2>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;-  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></font><font size=2></font><font color=#008000 size=2><font color=#008000 size=2>// Find and print the name of the subject of the certificate  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></font><font size=2></font><font color=#008000 size=2><font color=#008000 size=2>// just retrieved.  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></font><font size=2>TCHAR pszNameString[256];&nbsp;  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color=#0000ff size=2><font color=#0000ff size=2>if</font></font><font size=2>(CertGetNameString(  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; pCertContext,  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; CERT\_NAME\_SIMPLE\_DISPLAY\_TYPE,  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0,  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; NULL,  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; pszNameString,  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 128))  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; wprintf(L</font><font color=#a31515 size=2><font color=#a31515 size=2>&#8220;Certificate for %s has been retrieved.\n&#8221;</font></font><font size=2>, pszNameString);  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font><font color=#0000ff size=2><font color=#0000ff size=2>else  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></font><font size=2>{  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; wprintf(L</font><font color=#a31515 size=2><font color=#a31515 size=2>&#8220;CertGetName failed. \n&#8221;</font></font><font size=2>);  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</font>

<font size=2><font color=#008000 size=2><font color=#008000 size=2>

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // Get the issuer now&#8230;  
</font></font>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font><font color=#0000ff size=2><font color=#0000ff size=2>if</font></font><font size=2>(CertGetNameString( pCertContext,  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; CERT\_NAME\_SIMPLE\_DISPLAY\_TYPE,  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; CERT\_NAME\_ISSUER_FLAG,  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; NULL,  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; pszNameString,  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 128))  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; wprintf(L</font><font color=#a31515 size=2><font color=#a31515 size=2>&#8220;Certificate issuer is %s.\n\n&#8221;</font></font><font size=2>, pszNameString);  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }  
</font><font color=#0000ff size=2><font color=#0000ff size=2>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; else  
</font></font><font size=2>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; wprintf(L</font><font color=#a31515 size=2><font color=#a31515 size=2>&#8220;CertGetName failed. \n&#8221;</font></font><font size=2>);  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }  
&nbsp;&nbsp;&nbsp; }  
}

</font><font color=#008000 size=2><font color=#008000 size=2>//important! Free the CertCtx  
</font></font><font size=2>CertFreeCertificateChain(CertCtx);  
}  
</font><font color=#0000ff size=2><font color=#0000ff size=2>else  
</font></font><font size=2>{  
&nbsp; ErrorOut (GetLastError(), TEXT(</font><font color=#a31515 size=2><font color=#a31515 size=2>&#8220;HttpQueryInfo&#8221;</font></font><font size=2>));</font>  
<font size=2>}

</font></font></div> 

The above code simply illustrates getting the CertContext.&nbsp; I will leave the actual implementation and usage of this context to all of you Crypto API types!&nbsp; Please drop me a message if you found this blog useful!<p mce_keep="true">&nbsp;