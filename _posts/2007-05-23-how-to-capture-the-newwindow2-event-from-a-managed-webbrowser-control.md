---
id: 1313
title: 'How To:  Capture the NewWindow2 Event from a Managed WebBrowser Control'
date: 2007-05-23T13:09:00-05:00
author: jsanders
layout: post
guid: http://jsandersblog.azurewebsites.net/2007/05/23/how-to-capture-the-newwindow2-event-from-a-managed-webbrowser-control/
permalink: /2007/05/23/how-to-capture-the-newwindow2-event-from-a-managed-webbrowser-control/
orig_url:
  - http://blogs.msdn.microsoft.com/b/jpsanders/archive/2007/05/23/how-to-capture-the-newwindow2-event-from-a-managed-webbrowser-control.aspx
  - http://blogs.msdn.microsoft.com/b/jpsanders/archive/2007/05/23/how-to-capture-the-newwindow2-event-from-a-managed-webbrowser-control.aspx
  - http://blogs.msdn.microsoft.com/b/jpsanders/archive/2007/05/23/how-to-capture-the-newwindow2-event-from-a-managed-webbrowser-control.aspx
  - http://blogs.msdn.microsoft.com/b/jpsanders/archive/2007/05/23/how-to-capture-the-newwindow2-event-from-a-managed-webbrowser-control.aspx
  - http://blogs.msdn.microsoft.com/b/jpsanders/archive/2007/05/23/how-to-capture-the-newwindow2-event-from-a-managed-webbrowser-control.aspx
  - http://blogs.msdn.microsoft.com/b/jpsanders/archive/2007/05/23/how-to-capture-the-newwindow2-event-from-a-managed-webbrowser-control.aspx
  - http://blogs.msdn.microsoft.com/b/jpsanders/archive/2007/05/23/how-to-capture-the-newwindow2-event-from-a-managed-webbrowser-control.aspx
  - http://blogs.msdn.microsoft.com/b/jpsanders/archive/2007/05/23/how-to-capture-the-newwindow2-event-from-a-managed-webbrowser-control.aspx
  - http://blogs.msdn.microsoft.com/b/jpsanders/archive/2007/05/23/how-to-capture-the-newwindow2-event-from-a-managed-webbrowser-control.aspx
  - http://blogs.msdn.microsoft.com/b/jpsanders/archive/2007/05/23/how-to-capture-the-newwindow2-event-from-a-managed-webbrowser-control.aspx
orig_site_id:
  - "8394"
  - "8394"
  - "8394"
  - "8394"
  - "8394"
  - "8394"
  - "8394"
  - "8394"
  - "8394"
  - "8394"
orig_post_id:
  - "2819826"
  - "2819826"
  - "2819826"
  - "2819826"
  - "2819826"
  - "2819826"
  - "2819826"
  - "2819826"
  - "2819826"
  - "2819826"
orig_parent_id:
  - "2819826"
  - "2819826"
  - "2819826"
  - "2819826"
  - "2819826"
  - "2819826"
  - "2819826"
  - "2819826"
  - "2819826"
  - "2819826"
orig_thread_id:
  - "515080"
  - "515080"
  - "515080"
  - "515080"
  - "515080"
  - "515080"
  - "515080"
  - "515080"
  - "515080"
  - "515080"
orig_application_key:
  - jpsanders
  - jpsanders
  - jpsanders
  - jpsanders
  - jpsanders
  - jpsanders
  - jpsanders
  - jpsanders
  - jpsanders
  - jpsanders
orig_post_author_id:
  - "65385"
  - "65385"
  - "65385"
  - "65385"
  - "65385"
  - "65385"
  - "65385"
  - "65385"
  - "65385"
  - "65385"
orig_post_author_username:
  - jpsanders
  - jpsanders
  - jpsanders
  - jpsanders
  - jpsanders
  - jpsanders
  - jpsanders
  - jpsanders
  - jpsanders
  - jpsanders
orig_post_author_created:
  - Jan 18 2007 01:34:53:000PM
  - Jan 18 2007 01:34:53:000PM
  - Jan 18 2007 01:34:53:000PM
  - Jan 18 2007 01:34:53:000PM
  - Jan 18 2007 01:34:53:000PM
  - Jan 18 2007 01:34:53:000PM
  - Jan 18 2007 01:34:53:000PM
  - Jan 18 2007 01:34:53:000PM
  - Jan 18 2007 01:34:53:000PM
  - Jan 18 2007 01:34:53:000PM
orig_is_approved:
  - "1"
  - "1"
  - "1"
  - "1"
  - "1"
  - "1"
  - "1"
  - "1"
  - "1"
  - "1"
orig_attachment_count:
  - "0"
  - "0"
  - "0"
  - "0"
  - "0"
  - "0"
  - "0"
  - "0"
  - "0"
  - "0"
orig_url_title:
  - http://blogs.msdn.com/b/jpsanders/archive/2007/05/23/how-to-capture-the-newwindow2-event-from-a-managed-webbrowser-control.aspx
  - http://blogs.msdn.com/b/jpsanders/archive/2007/05/23/how-to-capture-the-newwindow2-event-from-a-managed-webbrowser-control.aspx
  - http://blogs.msdn.com/b/jpsanders/archive/2007/05/23/how-to-capture-the-newwindow2-event-from-a-managed-webbrowser-control.aspx
  - http://blogs.msdn.com/b/jpsanders/archive/2007/05/23/how-to-capture-the-newwindow2-event-from-a-managed-webbrowser-control.aspx
  - http://blogs.msdn.com/b/jpsanders/archive/2007/05/23/how-to-capture-the-newwindow2-event-from-a-managed-webbrowser-control.aspx
  - http://blogs.msdn.com/b/jpsanders/archive/2007/05/23/how-to-capture-the-newwindow2-event-from-a-managed-webbrowser-control.aspx
  - http://blogs.msdn.com/b/jpsanders/archive/2007/05/23/how-to-capture-the-newwindow2-event-from-a-managed-webbrowser-control.aspx
  - http://blogs.msdn.com/b/jpsanders/archive/2007/05/23/how-to-capture-the-newwindow2-event-from-a-managed-webbrowser-control.aspx
  - http://blogs.msdn.com/b/jpsanders/archive/2007/05/23/how-to-capture-the-newwindow2-event-from-a-managed-webbrowser-control.aspx
  - http://blogs.msdn.com/b/jpsanders/archive/2007/05/23/how-to-capture-the-newwindow2-event-from-a-managed-webbrowser-control.aspx
opengraph_tags:
  - |
    <meta property="og:type" content="article" />
    <meta property="og:title" content="How To:  Capture the NewWindow2 Event from a Managed WebBrowser Control" />
    <meta property="og:url" content="https://blogs.msdn.microsoft.com/jpsanders/2007/05/23/how-to-capture-the-newwindow2-event-from-a-managed-webbrowser-control/" />
    <meta property="og:site_name" content="Http Client Protocol Issues (and other fun stuff I support)" />
    <meta property="og:description" content="The articles referenced in my post Internet Explorer WebBrowser Control loses state&#8230; discusses sinking this event by adding an unmanaged version of the WebBrowser control to your Form and using that.&nbsp; But what if you want to use the Managed version?&nbsp; The manged version of the WebBrowser control is really a wrapper around the unmanaged..." />
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="How To:  Capture the NewWindow2 Event from a Managed WebBrowser Control" />
    <meta name="twitter:url" content="https://blogs.msdn.microsoft.com/jpsanders/2007/05/23/how-to-capture-the-newwindow2-event-from-a-managed-webbrowser-control/" />
    <meta name="twitter:description" content="The articles referenced in my post Internet Explorer WebBrowser Control loses state&#8230; discusses sinking this event by adding an unmanaged version of the WebBrowser control to your Form and using that.&nbsp; But what if you want to use the Managed version?&nbsp; The manged version of the WebBrowser control is really a wrapper around the unmanaged..." />
    
  - |
    <meta property="og:type" content="article" />
    <meta property="og:title" content="How To:  Capture the NewWindow2 Event from a Managed WebBrowser Control" />
    <meta property="og:url" content="https://blogs.msdn.microsoft.com/jpsanders/2007/05/23/how-to-capture-the-newwindow2-event-from-a-managed-webbrowser-control/" />
    <meta property="og:site_name" content="Http Client Protocol Issues (and other fun stuff I support)" />
    <meta property="og:description" content="The articles referenced in my post Internet Explorer WebBrowser Control loses state&#8230; discusses sinking this event by adding an unmanaged version of the WebBrowser control to your Form and using that.&nbsp; But what if you want to use the Managed version?&nbsp; The manged version of the WebBrowser control is really a wrapper around the unmanaged..." />
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="How To:  Capture the NewWindow2 Event from a Managed WebBrowser Control" />
    <meta name="twitter:url" content="https://blogs.msdn.microsoft.com/jpsanders/2007/05/23/how-to-capture-the-newwindow2-event-from-a-managed-webbrowser-control/" />
    <meta name="twitter:description" content="The articles referenced in my post Internet Explorer WebBrowser Control loses state&#8230; discusses sinking this event by adding an unmanaged version of the WebBrowser control to your Form and using that.&nbsp; But what if you want to use the Managed version?&nbsp; The manged version of the WebBrowser control is really a wrapper around the unmanaged..." />
    
  - |
    <meta property="og:type" content="article" />
    <meta property="og:title" content="How To:  Capture the NewWindow2 Event from a Managed WebBrowser Control" />
    <meta property="og:url" content="https://blogs.msdn.microsoft.com/jpsanders/2007/05/23/how-to-capture-the-newwindow2-event-from-a-managed-webbrowser-control/" />
    <meta property="og:site_name" content="Http Client Protocol Issues (and other fun stuff I support)" />
    <meta property="og:description" content="The articles referenced in my post Internet Explorer WebBrowser Control loses state&#8230; discusses sinking this event by adding an unmanaged version of the WebBrowser control to your Form and using that.&nbsp; But what if you want to use the Managed version?&nbsp; The manged version of the WebBrowser control is really a wrapper around the unmanaged..." />
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="How To:  Capture the NewWindow2 Event from a Managed WebBrowser Control" />
    <meta name="twitter:url" content="https://blogs.msdn.microsoft.com/jpsanders/2007/05/23/how-to-capture-the-newwindow2-event-from-a-managed-webbrowser-control/" />
    <meta name="twitter:description" content="The articles referenced in my post Internet Explorer WebBrowser Control loses state&#8230; discusses sinking this event by adding an unmanaged version of the WebBrowser control to your Form and using that.&nbsp; But what if you want to use the Managed version?&nbsp; The manged version of the WebBrowser control is really a wrapper around the unmanaged..." />
    
  - |
    <meta property="og:type" content="article" />
    <meta property="og:title" content="How To:  Capture the NewWindow2 Event from a Managed WebBrowser Control" />
    <meta property="og:url" content="https://blogs.msdn.microsoft.com/jpsanders/2007/05/23/how-to-capture-the-newwindow2-event-from-a-managed-webbrowser-control/" />
    <meta property="og:site_name" content="Http Client Protocol Issues (and other fun stuff I support)" />
    <meta property="og:description" content="The articles referenced in my post Internet Explorer WebBrowser Control loses state&#8230; discusses sinking this event by adding an unmanaged version of the WebBrowser control to your Form and using that.&nbsp; But what if you want to use the Managed version?&nbsp; The manged version of the WebBrowser control is really a wrapper around the unmanaged..." />
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="How To:  Capture the NewWindow2 Event from a Managed WebBrowser Control" />
    <meta name="twitter:url" content="https://blogs.msdn.microsoft.com/jpsanders/2007/05/23/how-to-capture-the-newwindow2-event-from-a-managed-webbrowser-control/" />
    <meta name="twitter:description" content="The articles referenced in my post Internet Explorer WebBrowser Control loses state&#8230; discusses sinking this event by adding an unmanaged version of the WebBrowser control to your Form and using that.&nbsp; But what if you want to use the Managed version?&nbsp; The manged version of the WebBrowser control is really a wrapper around the unmanaged..." />
    
  - |
    <meta property="og:type" content="article" />
    <meta property="og:title" content="How To:  Capture the NewWindow2 Event from a Managed WebBrowser Control" />
    <meta property="og:url" content="https://blogs.msdn.microsoft.com/jpsanders/2007/05/23/how-to-capture-the-newwindow2-event-from-a-managed-webbrowser-control/" />
    <meta property="og:site_name" content="Http Client Protocol Issues (and other fun stuff I support)" />
    <meta property="og:description" content="The articles referenced in my post Internet Explorer WebBrowser Control loses state&#8230; discusses sinking this event by adding an unmanaged version of the WebBrowser control to your Form and using that.&nbsp; But what if you want to use the Managed version?&nbsp; The manged version of the WebBrowser control is really a wrapper around the unmanaged..." />
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="How To:  Capture the NewWindow2 Event from a Managed WebBrowser Control" />
    <meta name="twitter:url" content="https://blogs.msdn.microsoft.com/jpsanders/2007/05/23/how-to-capture-the-newwindow2-event-from-a-managed-webbrowser-control/" />
    <meta name="twitter:description" content="The articles referenced in my post Internet Explorer WebBrowser Control loses state&#8230; discusses sinking this event by adding an unmanaged version of the WebBrowser control to your Form and using that.&nbsp; But what if you want to use the Managed version?&nbsp; The manged version of the WebBrowser control is really a wrapper around the unmanaged..." />
    
  - |
    <meta property="og:type" content="article" />
    <meta property="og:title" content="How To:  Capture the NewWindow2 Event from a Managed WebBrowser Control" />
    <meta property="og:url" content="https://blogs.msdn.microsoft.com/jpsanders/2007/05/23/how-to-capture-the-newwindow2-event-from-a-managed-webbrowser-control/" />
    <meta property="og:site_name" content="Http Client Protocol Issues (and other fun stuff I support)" />
    <meta property="og:description" content="The articles referenced in my post Internet Explorer WebBrowser Control loses state&#8230; discusses sinking this event by adding an unmanaged version of the WebBrowser control to your Form and using that.&nbsp; But what if you want to use the Managed version?&nbsp; The manged version of the WebBrowser control is really a wrapper around the unmanaged..." />
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="How To:  Capture the NewWindow2 Event from a Managed WebBrowser Control" />
    <meta name="twitter:url" content="https://blogs.msdn.microsoft.com/jpsanders/2007/05/23/how-to-capture-the-newwindow2-event-from-a-managed-webbrowser-control/" />
    <meta name="twitter:description" content="The articles referenced in my post Internet Explorer WebBrowser Control loses state&#8230; discusses sinking this event by adding an unmanaged version of the WebBrowser control to your Form and using that.&nbsp; But what if you want to use the Managed version?&nbsp; The manged version of the WebBrowser control is really a wrapper around the unmanaged..." />
    
  - |
    <meta property="og:type" content="article" />
    <meta property="og:title" content="How To:  Capture the NewWindow2 Event from a Managed WebBrowser Control" />
    <meta property="og:url" content="https://blogs.msdn.microsoft.com/jpsanders/2007/05/23/how-to-capture-the-newwindow2-event-from-a-managed-webbrowser-control/" />
    <meta property="og:site_name" content="Http Client Protocol Issues (and other fun stuff I support)" />
    <meta property="og:description" content="The articles referenced in my post Internet Explorer WebBrowser Control loses state&#8230; discusses sinking this event by adding an unmanaged version of the WebBrowser control to your Form and using that.&nbsp; But what if you want to use the Managed version?&nbsp; The manged version of the WebBrowser control is really a wrapper around the unmanaged..." />
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="How To:  Capture the NewWindow2 Event from a Managed WebBrowser Control" />
    <meta name="twitter:url" content="https://blogs.msdn.microsoft.com/jpsanders/2007/05/23/how-to-capture-the-newwindow2-event-from-a-managed-webbrowser-control/" />
    <meta name="twitter:description" content="The articles referenced in my post Internet Explorer WebBrowser Control loses state&#8230; discusses sinking this event by adding an unmanaged version of the WebBrowser control to your Form and using that.&nbsp; But what if you want to use the Managed version?&nbsp; The manged version of the WebBrowser control is really a wrapper around the unmanaged..." />
    
  - |
    <meta property="og:type" content="article" />
    <meta property="og:title" content="How To:  Capture the NewWindow2 Event from a Managed WebBrowser Control" />
    <meta property="og:url" content="https://blogs.msdn.microsoft.com/jpsanders/2007/05/23/how-to-capture-the-newwindow2-event-from-a-managed-webbrowser-control/" />
    <meta property="og:site_name" content="Http Client Protocol Issues (and other fun stuff I support)" />
    <meta property="og:description" content="The articles referenced in my post Internet Explorer WebBrowser Control loses state&#8230; discusses sinking this event by adding an unmanaged version of the WebBrowser control to your Form and using that.&nbsp; But what if you want to use the Managed version?&nbsp; The manged version of the WebBrowser control is really a wrapper around the unmanaged..." />
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="How To:  Capture the NewWindow2 Event from a Managed WebBrowser Control" />
    <meta name="twitter:url" content="https://blogs.msdn.microsoft.com/jpsanders/2007/05/23/how-to-capture-the-newwindow2-event-from-a-managed-webbrowser-control/" />
    <meta name="twitter:description" content="The articles referenced in my post Internet Explorer WebBrowser Control loses state&#8230; discusses sinking this event by adding an unmanaged version of the WebBrowser control to your Form and using that.&nbsp; But what if you want to use the Managed version?&nbsp; The manged version of the WebBrowser control is really a wrapper around the unmanaged..." />
    
  - |
    <meta property="og:type" content="article" />
    <meta property="og:title" content="How To:  Capture the NewWindow2 Event from a Managed WebBrowser Control" />
    <meta property="og:url" content="https://blogs.msdn.microsoft.com/jpsanders/2007/05/23/how-to-capture-the-newwindow2-event-from-a-managed-webbrowser-control/" />
    <meta property="og:site_name" content="Http Client Protocol Issues (and other fun stuff I support)" />
    <meta property="og:description" content="The articles referenced in my post Internet Explorer WebBrowser Control loses state&#8230; discusses sinking this event by adding an unmanaged version of the WebBrowser control to your Form and using that.&nbsp; But what if you want to use the Managed version?&nbsp; The manged version of the WebBrowser control is really a wrapper around the unmanaged..." />
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="How To:  Capture the NewWindow2 Event from a Managed WebBrowser Control" />
    <meta name="twitter:url" content="https://blogs.msdn.microsoft.com/jpsanders/2007/05/23/how-to-capture-the-newwindow2-event-from-a-managed-webbrowser-control/" />
    <meta name="twitter:description" content="The articles referenced in my post Internet Explorer WebBrowser Control loses state&#8230; discusses sinking this event by adding an unmanaged version of the WebBrowser control to your Form and using that.&nbsp; But what if you want to use the Managed version?&nbsp; The manged version of the WebBrowser control is really a wrapper around the unmanaged..." />
    
  - |
    <meta property="og:type" content="article" />
    <meta property="og:title" content="How To:  Capture the NewWindow2 Event from a Managed WebBrowser Control" />
    <meta property="og:url" content="https://blogs.msdn.microsoft.com/jpsanders/2007/05/23/how-to-capture-the-newwindow2-event-from-a-managed-webbrowser-control/" />
    <meta property="og:site_name" content="Http Client Protocol Issues (and other fun stuff I support)" />
    <meta property="og:description" content="The articles referenced in my post Internet Explorer WebBrowser Control loses state&#8230; discusses sinking this event by adding an unmanaged version of the WebBrowser control to your Form and using that.&nbsp; But what if you want to use the Managed version?&nbsp; The manged version of the WebBrowser control is really a wrapper around the unmanaged..." />
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="How To:  Capture the NewWindow2 Event from a Managed WebBrowser Control" />
    <meta name="twitter:url" content="https://blogs.msdn.microsoft.com/jpsanders/2007/05/23/how-to-capture-the-newwindow2-event-from-a-managed-webbrowser-control/" />
    <meta name="twitter:description" content="The articles referenced in my post Internet Explorer WebBrowser Control loses state&#8230; discusses sinking this event by adding an unmanaged version of the WebBrowser control to your Form and using that.&nbsp; But what if you want to use the Managed version?&nbsp; The manged version of the WebBrowser control is really a wrapper around the unmanaged..." />
    
categories:
  - Uncategorized
tags:
  - Internet Explorer
  - WebBrowser Control
---
The articles referenced in my post <a class="" title="Internet Explorer WebBrowser Control loses state" href="http://blogs.msdn.com/jpsanders/archive/2007/05/04/internet-explorer-webbrowser-control-loses-state-when-jscript-performs-a-call-to-window-open.aspx" mce_href="http://blogs.msdn.com/jpsanders/archive/2007/05/04/internet-explorer-webbrowser-control-loses-state-when-jscript-performs-a-call-to-window-open.aspx">Internet Explorer WebBrowser Control loses state</a>&#8230; discusses sinking this event by adding an unmanaged version of the WebBrowser control to your Form and using that.&nbsp; But what if you want to use the Managed version?&nbsp; The manged version of the WebBrowser control is really a wrapper around the unmanaged version of the control and has some neat features like automatically docking to the form.

**High level concept:**

All you would need to do to accomplish this is access the contained unmanaged WebBrowser control and sink the Event Interface you want!&nbsp; In this particular case I want to get the _NewWindow2_ event from the control so I can pop-up any new windows in my customer WebBrowser Form.&nbsp; If you know COM this should be a simple enough concept, but the&nbsp;implementation may be same to you.

**Step By Step:**

Standard disclaimers apply here (see the top of this page) and you MUST test this solution out, add exception handling and use better named variables :-).&nbsp; This example is for Visual Studio 2005 and Visual Basic .NET.&nbsp; It assumes you have created a new Visual Basic Project.&nbsp; You should be able to figure out how to add this to your existing project if you first go through the steps of creatng a simple project following these steps.

Add the unmanaged WebBrowser control to your Form in order to get a reference to the COM Interfaces of this control:

1.&nbsp; In the design view of the form that was created, Right Click on the Toolbox and from the context menu select &#8216;Choose Items&#8230;&#8217;  
Click on the &#8216;COM Components&#8217; Tab, scroll down and select ‘Microsoft Web Browser’ (Note you may already have this in your toolbox under the &#8216;General&#8217; section of the toolbox).

2.&nbsp; Hit OK and get back to the design view of your form.

3.&nbsp; Expand the General Section of the Toolbox and drag the WebBrowser from there (IMPORTANT: NOT FROM THE COMMON CONTROLS SECTION) onto your form.&nbsp; This creates a reference to the Unmanaged WebBrowser Type information in your project.

4.&nbsp; Now remove the control from the form.&nbsp; Simply delete the control you just dragged onto the form.

Add the Managed version of the WebBrowser control to your form:

5.&nbsp; Add the .NET WebBrowser Control to your form (IMPORTANT:&nbsp; This control is located in the ‘Common Controls’ Section of the toolbox NOT THE ONE YOU ADDED TO THE General Section).&nbsp; Simply drag the control onto the form.&nbsp; You can tell this is the managed version of the control because it will autosize to the form boundaries unlike the unmanaged version of the control.

Now wire everything up:

6.&nbsp; ‘View Code’ of your form (F7).

7.&nbsp; Right under the class definition for your form add the code to implement the interface that will implement the interface that contains the NewWindow2 event sink:&nbsp;  
<font color=#0000ff size=2>Implements</font><font size=2> SHDocVw.DWebBrowserEvents2</font>

<font size=2>

</font>8.&nbsp; Hit the ‘Enter’ key at the end of the line ‘Implements SHDocVw.DWebBrowserEvents2&#8242;&nbsp; and like magic the implementation for all of these events will populate in your Form code.

9.&nbsp; Add the Variable used for the ConnectionPoint the events will Sink on:  
<font color=#0000ff size=2>Private</font><font size=2> icp </font><font color=#0000ff size=2>As</font><font size=2> System.Runtime.InteropServices.ComTypes.IConnectionPoint</font>

10.&nbsp; Finally add the Variable to Track the particular Sink you are setting up:  
<font color=#0000ff size=2>Private</font><font size=2> cookie </font><font color=#0000ff size=2>As</font><font size=2> </font><font color=#0000ff size=2>Integer</font><font size=2> = -1</font>

Now you need to wire up the Form to the Event Interface you are implementing (DWebBrowserEvents2):

11.&nbsp; In the code window select from the left drop down box the ‘(Form1 Events)’ (or whatever the name of your form is) and select the ‘Shown’ event and add this code inside that event handler (beware of the lines wrapping in this section):  
<font color=#008000 size=2>&#8216; Connection point container from the Native WebBrowser  
</font><font color=#0000ff size=2>Dim</font><font size=2> icpc </font><font color=#0000ff size=2>As</font><font size=2> System.Runtime.InteropServices.ComTypes.IConnectionPointContainer = </font><font color=#0000ff size=2>CType</font><font size=2>(</font><font color=#0000ff size=2>Me</font><font size=2>.WebBrowser1.ActiveXInstance, System.Runtime.InteropServices.ComTypes.IConnectionPointContainer)</font>

<font color=#008000 size=2>&#8216; Get the Browser events Guid  
</font><font color=#0000ff size=2>Dim</font><font size=2> g </font><font color=#0000ff size=2>As</font><font size=2> Guid = </font><font color=#0000ff size=2>GetType</font><font size=2>(SHDocVw.DWebBrowserEvents2).GUID</font>

<font color=#008000 size=2>&#8216; Find the CP  
</font><font size=2>icpc.FindConnectionPoint(g, icp)</font>

<font color=#008000 size=2>&#8216; Start getting events  
</font><font size=2>icp.Advise(</font><font color=#0000ff size=2>Me</font><font size=2>, cookie)</font>

12.&nbsp; Make sure you unregister the event sink.&nbsp; Do this in the Form1_Disposed event.&nbsp; Create this event the same way you did the &#8216;Shown&#8217; Event  
<font color=#0000ff size=2>Try  
</font><font color=#0000ff size=2>&nbsp;&nbsp;&nbsp; If</font><font size=2> cookie <> -1 </font><font color=#0000ff size=2>Then  
</font><font size=2>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; icp.Unadvise(cookie)  
</font><font color=#0000ff size=2>&nbsp;&nbsp;&nbsp; End</font><font size=2> </font><font color=#0000ff size=2>If</font>

<font color=#0000ff size=2><font color=#000000>&nbsp;&nbsp;&nbsp; cookie&nbsp;= -1 </font></font>

<font size=2>

</font><font color=#0000ff size=2>Catch</font><font size=2> ex </font><font color=#0000ff size=2>As</font><font size=2> Exception

</font><font color=#0000ff size=2>End</font><font size=2> </font><font color=#0000ff size=2>Try

</font>13.&nbsp; Now you can go down to the NewWindow2 event and add this code to pop up a Window that will be able to share cookies from the current browser session:  
<font color=#008000 size=2>&#8216;Create a new form that has a Managed WebBrowser Control</font><font size=2>

</font><font color=#0000ff size=2>Dim</font><font size=2> frmWB </font><font color=#0000ff size=2>As</font><font size=2> Form1  
frmWB = </font><font color=#0000ff size=2>New</font><font size=2> Form1()</font><font size=2>

<font color=#008000 size=2>&#8216; Show it  
</font><font size=2>frmWB.Visible = </font><font color=#0000ff size=2>True</font>

</font>

frmWB.WebBrowser1.ActiveXInstance.RegisterAsBrowser = <font color=#0000ff size=2>True</font>

<font size=2>

</font><font color=#008000 size=2>&#8216; Set the application so we share cookies with this new instance  
</font><font size=2>ppDisp = frmWB.WebBrowser1.ActiveXInstance.Application

</font><font color=#0000ff size=2>&nbsp;</font>