---
id: 1293
title: How to Send SOAP call using MSXML (replace STK)
date: 2007-06-14T15:44:00-05:00
author: jsanders
layout: post
guid: http://jsandersblog.azurewebsites.net/2007/06/14/how-to-send-soap-call-using-msxml-replace-stk/
permalink: /2007/06/14/how-to-send-soap-call-using-msxml-replace-stk/
orig_url:
  - http://blogs.msdn.microsoft.com/b/jpsanders/archive/2007/06/14/how-to-send-soap-call-using-msxml-replace-stk.aspx
  - http://blogs.msdn.microsoft.com/b/jpsanders/archive/2007/06/14/how-to-send-soap-call-using-msxml-replace-stk.aspx
  - http://blogs.msdn.microsoft.com/b/jpsanders/archive/2007/06/14/how-to-send-soap-call-using-msxml-replace-stk.aspx
  - http://blogs.msdn.microsoft.com/b/jpsanders/archive/2007/06/14/how-to-send-soap-call-using-msxml-replace-stk.aspx
  - http://blogs.msdn.microsoft.com/b/jpsanders/archive/2007/06/14/how-to-send-soap-call-using-msxml-replace-stk.aspx
  - http://blogs.msdn.microsoft.com/b/jpsanders/archive/2007/06/14/how-to-send-soap-call-using-msxml-replace-stk.aspx
  - http://blogs.msdn.microsoft.com/b/jpsanders/archive/2007/06/14/how-to-send-soap-call-using-msxml-replace-stk.aspx
  - http://blogs.msdn.microsoft.com/b/jpsanders/archive/2007/06/14/how-to-send-soap-call-using-msxml-replace-stk.aspx
  - http://blogs.msdn.microsoft.com/b/jpsanders/archive/2007/06/14/how-to-send-soap-call-using-msxml-replace-stk.aspx
  - http://blogs.msdn.microsoft.com/b/jpsanders/archive/2007/06/14/how-to-send-soap-call-using-msxml-replace-stk.aspx
orig_site_id:
  - "8394"
  - "8394"
  - "8394"
  - "8394"
  - "8394"
  - "8394"
  - "8394"
  - "8394"
  - "8394"
  - "8394"
orig_post_id:
  - "3296431"
  - "3296431"
  - "3296431"
  - "3296431"
  - "3296431"
  - "3296431"
  - "3296431"
  - "3296431"
  - "3296431"
  - "3296431"
orig_parent_id:
  - "3296431"
  - "3296431"
  - "3296431"
  - "3296431"
  - "3296431"
  - "3296431"
  - "3296431"
  - "3296431"
  - "3296431"
  - "3296431"
orig_thread_id:
  - "519557"
  - "519557"
  - "519557"
  - "519557"
  - "519557"
  - "519557"
  - "519557"
  - "519557"
  - "519557"
  - "519557"
orig_application_key:
  - jpsanders
  - jpsanders
  - jpsanders
  - jpsanders
  - jpsanders
  - jpsanders
  - jpsanders
  - jpsanders
  - jpsanders
  - jpsanders
orig_post_author_id:
  - "65385"
  - "65385"
  - "65385"
  - "65385"
  - "65385"
  - "65385"
  - "65385"
  - "65385"
  - "65385"
  - "65385"
orig_post_author_username:
  - jpsanders
  - jpsanders
  - jpsanders
  - jpsanders
  - jpsanders
  - jpsanders
  - jpsanders
  - jpsanders
  - jpsanders
  - jpsanders
orig_post_author_created:
  - Jan 18 2007 01:34:53:000PM
  - Jan 18 2007 01:34:53:000PM
  - Jan 18 2007 01:34:53:000PM
  - Jan 18 2007 01:34:53:000PM
  - Jan 18 2007 01:34:53:000PM
  - Jan 18 2007 01:34:53:000PM
  - Jan 18 2007 01:34:53:000PM
  - Jan 18 2007 01:34:53:000PM
  - Jan 18 2007 01:34:53:000PM
  - Jan 18 2007 01:34:53:000PM
orig_is_approved:
  - "1"
  - "1"
  - "1"
  - "1"
  - "1"
  - "1"
  - "1"
  - "1"
  - "1"
  - "1"
orig_attachment_count:
  - "0"
  - "0"
  - "0"
  - "0"
  - "0"
  - "0"
  - "0"
  - "0"
  - "0"
  - "0"
orig_url_title:
  - http://blogs.msdn.com/b/jpsanders/archive/2007/06/14/how-to-send-soap-call-using-msxml-replace-stk.aspx
  - http://blogs.msdn.com/b/jpsanders/archive/2007/06/14/how-to-send-soap-call-using-msxml-replace-stk.aspx
  - http://blogs.msdn.com/b/jpsanders/archive/2007/06/14/how-to-send-soap-call-using-msxml-replace-stk.aspx
  - http://blogs.msdn.com/b/jpsanders/archive/2007/06/14/how-to-send-soap-call-using-msxml-replace-stk.aspx
  - http://blogs.msdn.com/b/jpsanders/archive/2007/06/14/how-to-send-soap-call-using-msxml-replace-stk.aspx
  - http://blogs.msdn.com/b/jpsanders/archive/2007/06/14/how-to-send-soap-call-using-msxml-replace-stk.aspx
  - http://blogs.msdn.com/b/jpsanders/archive/2007/06/14/how-to-send-soap-call-using-msxml-replace-stk.aspx
  - http://blogs.msdn.com/b/jpsanders/archive/2007/06/14/how-to-send-soap-call-using-msxml-replace-stk.aspx
  - http://blogs.msdn.com/b/jpsanders/archive/2007/06/14/how-to-send-soap-call-using-msxml-replace-stk.aspx
  - http://blogs.msdn.com/b/jpsanders/archive/2007/06/14/how-to-send-soap-call-using-msxml-replace-stk.aspx
opengraph_tags:
  - |
    <meta property="og:type" content="article" />
    <meta property="og:title" content="How to Send SOAP call using MSXML (replace STK)" />
    <meta property="og:url" content="https://blogs.msdn.microsoft.com/jpsanders/2007/06/14/how-to-send-soap-call-using-msxml-replace-stk/" />
    <meta property="og:site_name" content="Http Client Protocol Issues (and other fun stuff I support)" />
    <meta property="og:description" content="I know&#8230; This is a simple thing, but there is no documentation on it so here it is: UPDATE:&nbsp; You can now use Windows Webservica API (WWSAPI) to create native code WebService calls! The SoapToolkit (STK) is out of support.&nbsp; So what if you need to make a SOAP call in VB 6 or scripting?&nbsp;..." />
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="How to Send SOAP call using MSXML (replace STK)" />
    <meta name="twitter:url" content="https://blogs.msdn.microsoft.com/jpsanders/2007/06/14/how-to-send-soap-call-using-msxml-replace-stk/" />
    <meta name="twitter:description" content="I know&#8230; This is a simple thing, but there is no documentation on it so here it is: UPDATE:&nbsp; You can now use Windows Webservica API (WWSAPI) to create native code WebService calls! The SoapToolkit (STK) is out of support.&nbsp; So what if you need to make a SOAP call in VB 6 or scripting?&nbsp;..." />
    
  - |
    <meta property="og:type" content="article" />
    <meta property="og:title" content="How to Send SOAP call using MSXML (replace STK)" />
    <meta property="og:url" content="https://blogs.msdn.microsoft.com/jpsanders/2007/06/14/how-to-send-soap-call-using-msxml-replace-stk/" />
    <meta property="og:site_name" content="Http Client Protocol Issues (and other fun stuff I support)" />
    <meta property="og:description" content="I know&#8230; This is a simple thing, but there is no documentation on it so here it is: UPDATE:&nbsp; You can now use Windows Webservica API (WWSAPI) to create native code WebService calls! The SoapToolkit (STK) is out of support.&nbsp; So what if you need to make a SOAP call in VB 6 or scripting?&nbsp;..." />
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="How to Send SOAP call using MSXML (replace STK)" />
    <meta name="twitter:url" content="https://blogs.msdn.microsoft.com/jpsanders/2007/06/14/how-to-send-soap-call-using-msxml-replace-stk/" />
    <meta name="twitter:description" content="I know&#8230; This is a simple thing, but there is no documentation on it so here it is: UPDATE:&nbsp; You can now use Windows Webservica API (WWSAPI) to create native code WebService calls! The SoapToolkit (STK) is out of support.&nbsp; So what if you need to make a SOAP call in VB 6 or scripting?&nbsp;..." />
    
  - |
    <meta property="og:type" content="article" />
    <meta property="og:title" content="How to Send SOAP call using MSXML (replace STK)" />
    <meta property="og:url" content="https://blogs.msdn.microsoft.com/jpsanders/2007/06/14/how-to-send-soap-call-using-msxml-replace-stk/" />
    <meta property="og:site_name" content="Http Client Protocol Issues (and other fun stuff I support)" />
    <meta property="og:description" content="I know&#8230; This is a simple thing, but there is no documentation on it so here it is: UPDATE:&nbsp; You can now use Windows Webservica API (WWSAPI) to create native code WebService calls! The SoapToolkit (STK) is out of support.&nbsp; So what if you need to make a SOAP call in VB 6 or scripting?&nbsp;..." />
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="How to Send SOAP call using MSXML (replace STK)" />
    <meta name="twitter:url" content="https://blogs.msdn.microsoft.com/jpsanders/2007/06/14/how-to-send-soap-call-using-msxml-replace-stk/" />
    <meta name="twitter:description" content="I know&#8230; This is a simple thing, but there is no documentation on it so here it is: UPDATE:&nbsp; You can now use Windows Webservica API (WWSAPI) to create native code WebService calls! The SoapToolkit (STK) is out of support.&nbsp; So what if you need to make a SOAP call in VB 6 or scripting?&nbsp;..." />
    
  - |
    <meta property="og:type" content="article" />
    <meta property="og:title" content="How to Send SOAP call using MSXML (replace STK)" />
    <meta property="og:url" content="https://blogs.msdn.microsoft.com/jpsanders/2007/06/14/how-to-send-soap-call-using-msxml-replace-stk/" />
    <meta property="og:site_name" content="Http Client Protocol Issues (and other fun stuff I support)" />
    <meta property="og:description" content="I know&#8230; This is a simple thing, but there is no documentation on it so here it is: UPDATE:&nbsp; You can now use Windows Webservica API (WWSAPI) to create native code WebService calls! The SoapToolkit (STK) is out of support.&nbsp; So what if you need to make a SOAP call in VB 6 or scripting?&nbsp;..." />
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="How to Send SOAP call using MSXML (replace STK)" />
    <meta name="twitter:url" content="https://blogs.msdn.microsoft.com/jpsanders/2007/06/14/how-to-send-soap-call-using-msxml-replace-stk/" />
    <meta name="twitter:description" content="I know&#8230; This is a simple thing, but there is no documentation on it so here it is: UPDATE:&nbsp; You can now use Windows Webservica API (WWSAPI) to create native code WebService calls! The SoapToolkit (STK) is out of support.&nbsp; So what if you need to make a SOAP call in VB 6 or scripting?&nbsp;..." />
    
  - |
    <meta property="og:type" content="article" />
    <meta property="og:title" content="How to Send SOAP call using MSXML (replace STK)" />
    <meta property="og:url" content="https://blogs.msdn.microsoft.com/jpsanders/2007/06/14/how-to-send-soap-call-using-msxml-replace-stk/" />
    <meta property="og:site_name" content="Http Client Protocol Issues (and other fun stuff I support)" />
    <meta property="og:description" content="I know&#8230; This is a simple thing, but there is no documentation on it so here it is: UPDATE:&nbsp; You can now use Windows Webservica API (WWSAPI) to create native code WebService calls! The SoapToolkit (STK) is out of support.&nbsp; So what if you need to make a SOAP call in VB 6 or scripting?&nbsp;..." />
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="How to Send SOAP call using MSXML (replace STK)" />
    <meta name="twitter:url" content="https://blogs.msdn.microsoft.com/jpsanders/2007/06/14/how-to-send-soap-call-using-msxml-replace-stk/" />
    <meta name="twitter:description" content="I know&#8230; This is a simple thing, but there is no documentation on it so here it is: UPDATE:&nbsp; You can now use Windows Webservica API (WWSAPI) to create native code WebService calls! The SoapToolkit (STK) is out of support.&nbsp; So what if you need to make a SOAP call in VB 6 or scripting?&nbsp;..." />
    
  - |
    <meta property="og:type" content="article" />
    <meta property="og:title" content="How to Send SOAP call using MSXML (replace STK)" />
    <meta property="og:url" content="https://blogs.msdn.microsoft.com/jpsanders/2007/06/14/how-to-send-soap-call-using-msxml-replace-stk/" />
    <meta property="og:site_name" content="Http Client Protocol Issues (and other fun stuff I support)" />
    <meta property="og:description" content="I know&#8230; This is a simple thing, but there is no documentation on it so here it is: UPDATE:&nbsp; You can now use Windows Webservica API (WWSAPI) to create native code WebService calls! The SoapToolkit (STK) is out of support.&nbsp; So what if you need to make a SOAP call in VB 6 or scripting?&nbsp;..." />
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="How to Send SOAP call using MSXML (replace STK)" />
    <meta name="twitter:url" content="https://blogs.msdn.microsoft.com/jpsanders/2007/06/14/how-to-send-soap-call-using-msxml-replace-stk/" />
    <meta name="twitter:description" content="I know&#8230; This is a simple thing, but there is no documentation on it so here it is: UPDATE:&nbsp; You can now use Windows Webservica API (WWSAPI) to create native code WebService calls! The SoapToolkit (STK) is out of support.&nbsp; So what if you need to make a SOAP call in VB 6 or scripting?&nbsp;..." />
    
  - |
    <meta property="og:type" content="article" />
    <meta property="og:title" content="How to Send SOAP call using MSXML (replace STK)" />
    <meta property="og:url" content="https://blogs.msdn.microsoft.com/jpsanders/2007/06/14/how-to-send-soap-call-using-msxml-replace-stk/" />
    <meta property="og:site_name" content="Http Client Protocol Issues (and other fun stuff I support)" />
    <meta property="og:description" content="I know&#8230; This is a simple thing, but there is no documentation on it so here it is: UPDATE:&nbsp; You can now use Windows Webservica API (WWSAPI) to create native code WebService calls! The SoapToolkit (STK) is out of support.&nbsp; So what if you need to make a SOAP call in VB 6 or scripting?&nbsp;..." />
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="How to Send SOAP call using MSXML (replace STK)" />
    <meta name="twitter:url" content="https://blogs.msdn.microsoft.com/jpsanders/2007/06/14/how-to-send-soap-call-using-msxml-replace-stk/" />
    <meta name="twitter:description" content="I know&#8230; This is a simple thing, but there is no documentation on it so here it is: UPDATE:&nbsp; You can now use Windows Webservica API (WWSAPI) to create native code WebService calls! The SoapToolkit (STK) is out of support.&nbsp; So what if you need to make a SOAP call in VB 6 or scripting?&nbsp;..." />
    
  - |
    <meta property="og:type" content="article" />
    <meta property="og:title" content="How to Send SOAP call using MSXML (replace STK)" />
    <meta property="og:url" content="https://blogs.msdn.microsoft.com/jpsanders/2007/06/14/how-to-send-soap-call-using-msxml-replace-stk/" />
    <meta property="og:site_name" content="Http Client Protocol Issues (and other fun stuff I support)" />
    <meta property="og:description" content="I know&#8230; This is a simple thing, but there is no documentation on it so here it is: UPDATE:&nbsp; You can now use Windows Webservica API (WWSAPI) to create native code WebService calls! The SoapToolkit (STK) is out of support.&nbsp; So what if you need to make a SOAP call in VB 6 or scripting?&nbsp;..." />
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="How to Send SOAP call using MSXML (replace STK)" />
    <meta name="twitter:url" content="https://blogs.msdn.microsoft.com/jpsanders/2007/06/14/how-to-send-soap-call-using-msxml-replace-stk/" />
    <meta name="twitter:description" content="I know&#8230; This is a simple thing, but there is no documentation on it so here it is: UPDATE:&nbsp; You can now use Windows Webservica API (WWSAPI) to create native code WebService calls! The SoapToolkit (STK) is out of support.&nbsp; So what if you need to make a SOAP call in VB 6 or scripting?&nbsp;..." />
    
  - |
    <meta property="og:type" content="article" />
    <meta property="og:title" content="How to Send SOAP call using MSXML (replace STK)" />
    <meta property="og:url" content="https://blogs.msdn.microsoft.com/jpsanders/2007/06/14/how-to-send-soap-call-using-msxml-replace-stk/" />
    <meta property="og:site_name" content="Http Client Protocol Issues (and other fun stuff I support)" />
    <meta property="og:description" content="I know&#8230; This is a simple thing, but there is no documentation on it so here it is: UPDATE:&nbsp; You can now use Windows Webservica API (WWSAPI) to create native code WebService calls! The SoapToolkit (STK) is out of support.&nbsp; So what if you need to make a SOAP call in VB 6 or scripting?&nbsp;..." />
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="How to Send SOAP call using MSXML (replace STK)" />
    <meta name="twitter:url" content="https://blogs.msdn.microsoft.com/jpsanders/2007/06/14/how-to-send-soap-call-using-msxml-replace-stk/" />
    <meta name="twitter:description" content="I know&#8230; This is a simple thing, but there is no documentation on it so here it is: UPDATE:&nbsp; You can now use Windows Webservica API (WWSAPI) to create native code WebService calls! The SoapToolkit (STK) is out of support.&nbsp; So what if you need to make a SOAP call in VB 6 or scripting?&nbsp;..." />
    
  - |
    <meta property="og:type" content="article" />
    <meta property="og:title" content="How to Send SOAP call using MSXML (replace STK)" />
    <meta property="og:url" content="https://blogs.msdn.microsoft.com/jpsanders/2007/06/14/how-to-send-soap-call-using-msxml-replace-stk/" />
    <meta property="og:site_name" content="Http Client Protocol Issues (and other fun stuff I support)" />
    <meta property="og:description" content="I know&#8230; This is a simple thing, but there is no documentation on it so here it is: UPDATE:&nbsp; You can now use Windows Webservica API (WWSAPI) to create native code WebService calls! The SoapToolkit (STK) is out of support.&nbsp; So what if you need to make a SOAP call in VB 6 or scripting?&nbsp;..." />
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="How to Send SOAP call using MSXML (replace STK)" />
    <meta name="twitter:url" content="https://blogs.msdn.microsoft.com/jpsanders/2007/06/14/how-to-send-soap-call-using-msxml-replace-stk/" />
    <meta name="twitter:description" content="I know&#8230; This is a simple thing, but there is no documentation on it so here it is: UPDATE:&nbsp; You can now use Windows Webservica API (WWSAPI) to create native code WebService calls! The SoapToolkit (STK) is out of support.&nbsp; So what if you need to make a SOAP call in VB 6 or scripting?&nbsp;..." />
    
categories:
  - Uncategorized
tags:
  - MSXML
  - Soap ToolKit
  - WWSAPI
---
I know&#8230; This is a simple thing, but there is no documentation on it so here it is:

**UPDATE:&nbsp; You can now use Windows Webservica API (WWSAPI) to create native code WebService calls!**

The SoapToolkit (STK) is out of support.&nbsp; So what if you need to make a SOAP call in VB 6 or scripting?&nbsp; Realizing that SOAP calls to web service are just a POST with some XML, you should be able to do this easily.&nbsp; You can get the format for this POST from a network sniffer such as Network Monitor (available from Microsoft) or from the WSDL of service definition.

Here is a simple definition of a web service that returns the length of a string:

## GetStringLength

<p class="intro">
  &nbsp;
</p>

### Test

The test form is only available for requests from the local machine.

### SOAP 1.1

The following is a sample SOAP 1.1 request and response. The <span class="value" style="color: #00008b;"><strong>placeholders</strong></span> shown need to be replaced with actual values.

<pre>POST /HelloWS/service.asmx HTTP/1.1
Host: jsandersvm2003
Content-Type: text/xml; charset=utf-8
Content-Length: <span class="value" style="color: #00008b;"><strong>length</strong></span>
SOAPAction: "http://tempuri.org/GetStringLength"
&lt;?xml version="1.0" encoding="utf-8"?&gt;
&lt;soap:Envelope xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/"&gt;
  &lt;soap:Body&gt;
    &lt;GetStringLength xmlns="http://tempuri.org/"&gt;
      &lt;theString&gt;<span class="value" style="color: #00008b;"><strong>string</strong></span>&lt;/theString&gt;
    &lt;/GetStringLength&gt;
  &lt;/soap:Body&gt;
&lt;/soap:Envelope&gt;</pre>

<pre>HTTP/1.1 200 OK
Content-Type: text/xml; charset=utf-8
Content-Length: <span class="value" style="color: #00008b;"><strong>length</strong></span>
&lt;?xml version="1.0" encoding="utf-8"?&gt;
&lt;soap:Envelope xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/"&gt;
  &lt;soap:Body&gt;
    &lt;GetStringLengthResponse xmlns="http://tempuri.org/"&gt;
      &lt;GetStringLengthResult&gt;<span class="value" style="color: #00008b;"><strong>int</strong></span>&lt;/GetStringLengthResult&gt;
    &lt;/GetStringLengthResponse&gt;
  &lt;/soap:Body&gt;
&lt;/soap:Envelope&gt;</pre>

Here is one way to make this call in a simple VB form application. Reference MSXML3.0 in your project (beware of lines wrapping in your browser if you are a cut and past programmer). 

&nbsp;

&nbsp;

&nbsp;

<span style="color: #0000ff; font-size: x-small;"><span style="color: #0000ff; font-size: x-small;"><font size="2" color="#0000ff"></p> 

<p>
  Sub
</p>

<p>
  </font></span>
</p>

<p>
  &nbsp;
</p>

<p>
  </span>
</p>

<p>
  &nbsp;
</p>

<p>
  <span style="font-size: x-small;"> Command2_Click()<br /></span><span style="color: #008000; font-size: x-small;">&nbsp;&nbsp;&nbsp; &#8216;How to send this using MSXML<br /></span><span style="color: #008000; font-size: x-small;">&nbsp;&nbsp;&nbsp; &#8216;POST /HelloWS/service.asmx HTTP/1.1<br /></span><span style="color: #008000; font-size: x-small;">&nbsp;&nbsp;&nbsp; &#8216;Host: jsandersvm2003<br /></span><span style="color: #008000; font-size: x-small;">&nbsp;&nbsp;&nbsp; &#8216;Content-Type: text/xml; charset=utf-8<br /></span><span style="color: #008000; font-size: x-small;">&nbsp;&nbsp;&nbsp; &#8216;Content -length: <<length>><br /></span>
</p>

<p>
  <span style="color: #008000; font-size: x-small;">&nbsp;&nbsp;&nbsp; &#8216;SOAPAction: &#8220;http://tempuri.org/GetStringLength&#8221;</span>
</p>

<p>
  <span style="font-size: x-small;"><span style="font-size: x-small;"><font size="2"></p> 
  
  <p>
    &nbsp;
  </p>
  
  <p>
    </font></span>
  </p>
  
  <p>
    &nbsp;
  </p>
  
  <p>
    </span>
  </p>
  
  <p>
    &nbsp;
  </p>
  
  <p>
    <span style="color: #008000; font-size: x-small;">&nbsp;&nbsp;&nbsp; &#8216;<?xml version=&#8221;1.0&#8243; encoding=&#8221;utf-8&#8243;?><br />&nbsp;&nbsp;&nbsp; </span><span style="color: #008000; font-size: x-small;">&#8216;<soap:Envelope xmlns:xsi=&#8221;http://www.w3.org/2001/XMLSchema-instance&#8221; xmlns:xsd=&#8221;http://www.w3.org/2001/XMLSchema&#8221; xmlns:soap=&#8221;http://schemas.xmlsoap.org/soap/envelope/&#8221;><br />&nbsp;&nbsp;&nbsp; </span><span style="color: #008000; font-size: x-small;">&#8216; <soap:Body><br />&nbsp;&nbsp;&nbsp; </span><span style="color: #008000; font-size: x-small;">&#8216; <GetStringLength xmlns=&#8221;http://tempuri.org/&#8221;><br />&nbsp;&nbsp;&nbsp; </span><span style="color: #008000; font-size: x-small;">&#8216; <theString><<string>></theString><br />&nbsp;&nbsp;&nbsp; </span><span style="color: #008000; font-size: x-small;">&#8216; </GetStringLength><br />&nbsp;&nbsp;&nbsp; </span><span style="color: #008000; font-size: x-small;">&#8216; </soap:Body><br />&nbsp;&nbsp;&nbsp; </span>
  </p>
  
  <p>
    <span style="color: #008000; font-size: x-small;">&#8216;</soap:Envelope></span>
  </p>
  
  <p>
    <span style="font-size: x-small;"><span style="font-size: x-small;"><font size="2"></p> 
    
    <p>
      &nbsp;
    </p>
    
    <p>
      </font></span>
    </p>
    
    <p>
      &nbsp;
    </p>
    
    <p>
      </span>
    </p>
    
    <p>
      &nbsp;
    </p>
    
    <p>
      <span style="color: #0000ff; font-size: x-small;">&nbsp;&nbsp;&nbsp; Dim</span><span style="font-size: x-small;"> myXML </span><span style="color: #0000ff; font-size: x-small;">As</span><span style="font-size: x-small;"> </span><span style="color: #0000ff; font-size: x-small;">New</span>
    </p>
    
    <p>
      <span style="font-size: x-small;"> XMLHTTP30<span style="font-size: x-small;"><font size="2"></p> 
      
      <p>
        &nbsp;
      </p>
      
      <p>
        </font></span>
      </p>
      
      <p>
        &nbsp;
      </p>
      
      <p>
        </span>
      </p>
      
      <p>
        &nbsp;
      </p>
      
      <p>
        <span style="color: #008000; font-size: x-small;">&nbsp;&nbsp;&nbsp; &#8216; False means Synchronously<br />&nbsp;&nbsp;&nbsp; </span><span style="font-size: x-small;">myXML.open(</span><span style="color: #800000; font-size: x-small;">&#8220;POST&#8221;</span><span style="font-size: x-small;">, </span><span style="color: #800000; font-size: x-small;">&#8220;http://jsandersvm2003/HelloWS/service.asmx&#8221;</span><span style="font-size: x-small;">, </span><span style="color: #0000ff; font-size: x-small;">False</span><span style="font-size: x-small;">)<br /><span style="color: #008000;">&nbsp;&nbsp;&nbsp; </span>myXML.setRequestHeader(</span><span style="color: #800000; font-size: x-small;">&#8220;Content-Type&#8221;</span><span style="font-size: x-small;">, </span><span style="color: #800000; font-size: x-small;">&#8220;text/xml; charset=utf-8&#8221;</span><span style="font-size: x-small;">)<br /><span style="color: #008000;">&nbsp;&nbsp;&nbsp; </span>myXML.setRequestHeader(</span><span style="color: #800000; font-size: x-small;">&#8220;SOAPAction:&#8221;</span><span style="font-size: x-small;">, </span><span style="color: #800000; font-size: x-small;"><a href="http://tempuri.org/GetStringLength">http://tempuri.org/GetStringLength</a></span><span style="font-size: x-small;">)</span>
      </p></p> 
      
      <p>
        <span style="color: #008000; font-size: x-small;"><br />&nbsp;&nbsp;&nbsp; &#8216; NOTE: You could do this&#8230; very brute force way to send it.<br />&nbsp;&nbsp;&nbsp; </span><span style="font-size: x-small;"></span><span style="color: #008000; font-size: x-small;">&#8216;Dim theTxt As String<br />&nbsp;&nbsp;&nbsp; </span><span style="font-size: x-small;"></span><span style="color: #008000; font-size: x-small;">&#8216;theTxt = &#8220;<?xml version=&#8221; & Chr(34) & &#8220;1.0&#8221; & Chr(34) & &#8221; encoding=&#8221; & Chr(34) & &#8220;utf-8&#8221; & Chr(34) & &#8220;?><soap:Envelope xmlns:xsi=&#8221; & Chr(34) & &#8220;http://www.w3.org/2001/XMLSchema-instance&#8221; & Chr(34) & &#8221; xmlns:xsd=&#8221; & Chr(34) & &#8220;http://www.w3.org/2001/XMLSchema&#8221; & Chr(34) & &#8221; xmlns:soap=&#8221; & Chr(34) & &#8220;http://schemas.xmlsoap.org/soap/envelope/&#8221; & Chr(34) & &#8220;><soap:Body><GetStringLength xmlns=&#8221; & Chr(34) & &#8220;http://tempuri.org/&#8221; & Chr(34) & &#8220;><theString xmlns=&#8221; & Chr(34) & &#8220;http://tempuri.org/&#8221; & Chr(34) & &#8220;>string</theString></GetStringLength></soap:Body></soap:Envelope>&#8221;</span>
      </p>
      
      <p>
        &nbsp;
      </p>
      
      <p>
        &nbsp;
      </p>
      
      <p>
        &nbsp;
      </p>
      
      <p>
        &nbsp;
      </p>
      
      <p>
        <p>
          <span style="font-size: x-small;"><span style="font-size: x-small;"><font size="2"></p> 
          
          <p>
            &nbsp;
          </p>
          
          <p>
            </font></span>
          </p>
          
          <p>
            &nbsp;
          </p>
          
          <p>
            </span>
          </p>
          
          <p>
            &nbsp;
          </p>
          
          <p>
            <span style="color: #008000; font-size: x-small;">&nbsp;&nbsp;&nbsp; &#8216;myXML.send theTxt<br />&nbsp;&nbsp;&nbsp; </span><span style="font-size: x-small;"></span>
          </p>
          
          <p>
            <span style="color: #008000; font-size: x-small;">&#8216; NOTE: This allows you to leverage the XML DOM</span>
          </p>
          
          <p>
            <span style="font-size: x-small;"><span style="font-size: x-small;"><font size="2"></p> 
            
            <p>
              &nbsp;
            </p>
            
            <p>
              </font></span>
            </p>
            
            <p>
              &nbsp;
            </p>
            
            <p>
              </span>
            </p>
            
            <p>
              &nbsp;
            </p>
            
            <p>
              <span style="color: #0000ff; font-size: x-small;">&nbsp;&nbsp;&nbsp; Dim</span><span style="font-size: x-small;"> node<br /><span style="color: #008000;">&nbsp;&nbsp;&nbsp; </span></span><span style="color: #0000ff; font-size: x-small;">Dim</span><span style="font-size: x-small;"> xmlSrcDoc </span><span style="color: #0000ff; font-size: x-small;">As</span><span style="font-size: x-small;"> </span><span style="color: #0000ff; font-size: x-small;">New</span><span style="font-size: x-small;"> MSXML2.DOMDocument30<br /><span style="color: #008000;">&nbsp;&nbsp;&nbsp;&nbsp;</span>xmlSrcDoc.async = </span><span style="color: #0000ff; font-size: x-small;">False<br />&nbsp;&nbsp;&nbsp; </span><span style="font-size: x-small;">xmlSrcDoc.validateOnParse = </span><span style="color: #0000ff; font-size: x-small;">False<br /><span style="color: #008000;">&nbsp;&nbsp;&nbsp; </span></span><span style="font-size: x-small;">xmlSrcDoc.resolveExternals = </span><span style="color: #0000ff; font-size: x-small;">False<br /><span style="color: #008000;">&nbsp;&nbsp;&nbsp; </span></span><span style="font-size: x-small;">xmlSrcDoc.preserveWhiteSpace = </span><span style="color: #0000ff; font-size: x-small;">True<br /><span style="color: #008000;">&nbsp;&nbsp;&nbsp;&nbsp;</span></span><span style="color: #008000;"><span style="font-size: x-small;">&#8216; caveat for the createProcessingInstruction. the encoding string will be missing from the XML instruction line.<br />&nbsp;&nbsp;&nbsp; </span></span><span style="font-size: x-small;"></span><span style="color: #008000; font-size: x-small;">&#8216; so you could skip the createProcessingInstruction code, instead prepend the string to the XML you generate for the rest of the body ala&nbsp;<br />&nbsp;&nbsp;&nbsp; &#8216; </span>
            </p>
            
            <p>
              <span style="color: #008000; font-size: x-small;">&#8220;myXML.send &#8220;<?xml version=&#8221; & Chr(34) & &#8220;1.0&#8221; & Chr(34) & &#8221; encoding=&#8221; & Chr(34) & &#8220;utf-8&#8243; & Chr(34) & &#8221; ?> &#8221; & xmlSrcDoc.xml</span>
            </p>
            
            <p>
              <span style="font-size: x-small;"><span style="font-size: x-small;"><font size="2"></p> 
              
              <p>
                &nbsp;
              </p>
              
              <p>
                </font></span>
              </p>
              
              <p>
                &nbsp;
              </p>
              
              <p>
                </span>
              </p>
              
              <p>
                &nbsp;
              </p>
              
              <p>
                <span style="color: #008000; font-size: x-small;"><br />&nbsp;&nbsp;&nbsp; &#8216; most servers will not care about that because the HTTP header already specifies the encoding<br />&nbsp;&nbsp;&nbsp; </span><span style="color: #008000; font-size: x-small;">&#8216; Create a processing instruction targeted for xml.</span><span style="font-size: x-small;"><br /><span style="color: #008000;">&nbsp;&nbsp;&nbsp; </span>node = xmlSrcDoc.createProcessingInstruction(</span><span style="color: #800000; font-size: x-small;">&#8220;xml&#8221;</span><span style="font-size: x-small;">, </span><span style="color: #800000; font-size: x-small;">&#8220;version=&#8217;1.0&#8242;&#8221;</span><span style="font-size: x-small;">)<br /><span style="color: #008000;">&nbsp;&nbsp;&nbsp; </span></span><span style="color: #008000; font-size: x-small;">&#8216; issue: cannot do this: node.setAttribute &#8220;encoding&#8221;, &#8220;utf-8&#8221;<br />&nbsp;&nbsp;&nbsp; </span><span style="font-size: x-small;">xmlSrcDoc.appendChild(node)<br /><span style="color: #008000;">&nbsp;&nbsp;&nbsp; </span>node = </span><span style="color: #0000ff; font-size: x-small;">Nothing<br /><span style="color: #008000;">&nbsp;&nbsp;&nbsp;&nbsp;</span></span><span style="color: #008000; font-size: x-small;">&#8216; Create the Soap Envelope<br />&nbsp;&nbsp;&nbsp; </span><span style="font-size: x-small;"></span><span style="color: #0000ff; font-size: x-small;">Dim</span><span style="font-size: x-small;"> soapEnvelope </span><span style="color: #0000ff; font-size: x-small;">As</span><span style="font-size: x-small;"> IXMLDOMElement<br /><span style="color: #008000;">&nbsp;&nbsp;&nbsp; </span>soapEnvelope = xmlSrcDoc.createElement(</span><span style="color: #800000; font-size: x-small;">&#8220;soap:Envelope&#8221;</span><span style="font-size: x-small;">)<br /><span style="color: #008000;">&nbsp;&nbsp;&nbsp; </span></span><span style="color: #008000; font-size: x-small;">&#8216; Create the attributes for it<br />&nbsp;&nbsp;&nbsp; </span><span style="font-size: x-small;">soapEnvelope.setAttribute(</span><span style="color: #800000; font-size: x-small;">&#8220;xmlns:soap&#8221;</span><span style="font-size: x-small;">, </span><span style="color: #800000; font-size: x-small;">&#8220;http://schemas.xmlsoap.org/soap/envelope/&#8221;</span><span style="font-size: x-small;">)<br /><span style="color: #008000;">&nbsp;&nbsp;&nbsp; </span>soapEnvelope.setAttribute(</span><span style="color: #800000; font-size: x-small;">&#8220;xmlns:xsi&#8221;</span><span style="font-size: x-small;">, </span><span style="color: #800000; font-size: x-small;">&#8220;http://www.w3.org/2001/XMLSchema-instance&#8221;</span><span style="font-size: x-small;">)<br /><span style="color: #008000;">&nbsp;&nbsp;&nbsp; </span>soapEnvelope.setAttribute(</span><span style="color: #800000; font-size: x-small;">&#8220;xmlns:xsd&#8221;</span><span style="font-size: x-small;">, </span><span style="color: #800000; font-size: x-small;">&#8220;http://www.w3.org/2001/XMLSchema&#8221;</span><span style="font-size: x-small;">)<br /><span style="color: #008000;">&nbsp;&nbsp;&nbsp; </span>xmlSrcDoc.appendChild(soapEnvelope)<br /><span style="color: #008000;">&nbsp;&nbsp;&nbsp; </span></span><span style="color: #008000; font-size: x-small;">&#8216; Create the Soap Body<br />&nbsp;&nbsp;&nbsp; </span><span style="font-size: x-small;"></span><span style="color: #0000ff; font-size: x-small;">Dim</span><span style="font-size: x-small;"> soapBody </span><span style="color: #0000ff; font-size: x-small;">As</span><span style="font-size: x-small;"> IXMLDOMElement<br /><span style="color: #008000;">&nbsp;&nbsp;&nbsp; </span>soapBody = xmlSrcDoc.createElement(</span><span style="color: #800000; font-size: x-small;">&#8220;soap:Body&#8221;</span><span style="font-size: x-small;">)<br /><span style="color: #008000;">&nbsp;&nbsp;&nbsp; </span>soapEnvelope.appendChild(soapBody)<br /><span style="color: #008000;">&nbsp;&nbsp;&nbsp; </span></span><span style="color: #008000; font-size: x-small;">&#8216; Create the node for the call we are making<br />&nbsp;&nbsp;&nbsp; </span><span style="font-size: x-small;"></span><span style="color: #0000ff; font-size: x-small;">Dim</span><span style="font-size: x-small;"> soapCall </span><span style="color: #0000ff; font-size: x-small;">As</span><span style="font-size: x-small;"> IXMLDOMElement<br /><span style="color: #008000;">&nbsp;&nbsp;&nbsp; </span>soapCall = xmlSrcDoc.createElement(</span><span style="color: #800000; font-size: x-small;">&#8220;GetStringLength&#8221;</span><span style="font-size: x-small;">)<br /><span style="color: #008000;">&nbsp;&nbsp;&nbsp; </span>soapCall.setAttribute(</span><span style="color: #800000; font-size: x-small;">&#8220;xmlns&#8221;</span><span style="font-size: x-small;">, </span><span style="color: #800000; font-size: x-small;">&#8220;http://tempuri.org/&#8221;</span><span style="font-size: x-small;">)<br /><span style="color: #008000;">&nbsp;&nbsp;&nbsp; </span>soapBody.appendChild(soapCall)<br /><span style="color: #008000;">&nbsp;&nbsp;&nbsp; </span></span><span style="color: #008000; font-size: x-small;">&#8216; finally add the argument(s)<br />&nbsp;&nbsp;&nbsp; </span><span style="font-size: x-small;"></span><span style="color: #0000ff; font-size: x-small;">Dim</span><span style="font-size: x-small;"> soapArgs </span><span style="color: #0000ff; font-size: x-small;">As</span><span style="font-size: x-small;"> </span><span style="color: #0000ff; font-size: x-small;">Object<br /><span style="color: #008000;">&nbsp;&nbsp;&nbsp; </span></span><span style="font-size: x-small;">soapArgs = xmlSrcDoc.createElement(</span><span style="color: #800000; font-size: x-small;">&#8220;theString&#8221;</span><span style="font-size: x-small;">)<br /><span style="color: #008000;">&nbsp;&nbsp;&nbsp; </span>soapArgs.Text = </span><span style="color: #800000; font-size: x-small;">&#8220;Jeff is cool&#8221;<br /><span style="color: #008000;">&nbsp;&nbsp;&nbsp; </span></span><span style="font-size: x-small;">soapCall.appendChild(soapArgs)<br /><span style="color: #008000;">&nbsp;&nbsp;&nbsp; </span></span><span style="color: #008000; font-size: x-small;">&#8216; let it go!<br />&nbsp;&nbsp;&nbsp; </span><span style="font-size: x-small;">myXML.send(xmlSrcDoc.xml)<br /><span style="color: #008000;">&nbsp;&nbsp;&nbsp; </span></span><span style="color: #008000; font-size: x-small;">&#8216; myXML.send &#8220;<?xml version=&#8221; & Chr(34) & &#8220;1.0&#8221; & Chr(34) & &#8221; encoding=&#8221; & Chr(34) & &#8220;utf-8&#8243; & Chr(34) & &#8221; ?> &#8221; & xmlSrcDoc.xml<br />&nbsp;&nbsp;&nbsp; </span><span style="font-size: x-small;"></span><span style="color: #0000ff; font-size: x-small;">Dim</span><span style="font-size: x-small;"> xmlDoc </span><span style="color: #0000ff; font-size: x-small;">As</span><span style="font-size: x-small;"> MSXML2.DOMDocument30<br /><span style="color: #008000;">&nbsp;&nbsp;&nbsp; </span>xmlDoc = myXML.responseXML<br /><span style="color: #008000;">&nbsp;&nbsp;&nbsp; </span></span><span style="color: #008000; font-size: x-small;">&#8216; This query will depend on what you expect back from the SOAP call<br />&nbsp;&nbsp;&nbsp; </span>
              </p>
              
              <p>
                <span style="font-size: x-small;">MsgBox(xmlDoc.Text)<span style="font-size: x-small;"><font size="2"></p> 
                
                <p>
                  &nbsp;
                </p>
                
                <p>
                  </font></span>
                </p>
                
                <p>
                  &nbsp;
                </p>
                
                <p>
                  </span>
                </p>
                
                <p>
                  &nbsp;
                </p>
                
                <p>
                  <span style="color: #008000; font-size: x-small;">&nbsp;&nbsp;&nbsp; &#8216; or this if you want to traverse the XML DOM<br />&nbsp;&nbsp;&nbsp; </span><span style="font-size: x-small;"></span><span style="color: #008000; font-size: x-small;">&#8216;Dim oNode As Object<br />&nbsp;&nbsp;&nbsp; </span><span style="font-size: x-small;"></span><span style="color: #008000; font-size: x-small;">&#8216;Set oNode = xmlDoc.documentElement.selectSingleNode(&#8220;//HelloWorldResult&#8221;)<br />&nbsp;&nbsp;&nbsp; </span><span style="font-size: x-small;"></span><span style="color: #008000; font-size: x-small;">&#8216;If oNode Is Nothing Then<br />&nbsp;&nbsp;&nbsp; </span><span style="font-size: x-small;"></span><span style="color: #008000; font-size: x-small;">&#8216;&nbsp;&nbsp;&nbsp;&nbsp; MsgBox &#8220;Requested information not found.&#8221;<br />&nbsp;&nbsp;&nbsp; </span><span style="font-size: x-small;"></span><span style="color: #008000; font-size: x-small;">&#8216;Else<br />&nbsp;&nbsp;&nbsp; </span><span style="font-size: x-small;"></span><span style="color: #008000; font-size: x-small;">&#8216;&nbsp;&nbsp;&nbsp;&nbsp; MsgBox oNode.Text<br />&nbsp;&nbsp;&nbsp; </span><span style="font-size: x-small;"></span>
                </p>
                
                <p>
                  <span style="color: #008000; font-size: x-small;">&#8216;End If</span>
                </p>
                
                <p>
                  <span style="color: #0000ff; font-size: x-small;"><span style="color: #0000ff; font-size: x-small;"><font size="2" color="#0000ff"></p> 
                  
                  <p>
                    End
                  </p>
                  
                  <p>
                    </font></span>
                  </p>
                  
                  <p>
                    &nbsp;
                  </p>
                  
                  <p>
                    </span>
                  </p>
                  
                  <p>
                    &nbsp;
                  </p>
                  
                  <p>
                    <span style="font-size: x-small;"> </span>
                  </p>
                  
                  <p>
                    <span style="color: #0000ff; font-size: x-small;">Sub</span>
                  </p></p> 
                  
                  <p>
                    &nbsp;
                  </p>